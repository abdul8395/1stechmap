"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9114],{91205:(e,t,s)=>{function a(e){return t=>void 0!==t?{type:e,payload:t,async:!0}:{type:e,async:!0}}s.d(t,{T:()=>a})},59754:(e,t,s)=>{function a(e){return t=>void 0!==t?{type:e,payload:t}:{type:e}}s.d(t,{lQ:()=>a})},97938:(e,t,s)=>{s.d(t,{V:()=>a});const a=e=>({type:"USER/UPDATE_EMAIL",payload:e,async:!0})},48699:(e,t,s)=>{s.d(t,{TE:()=>n,Vu:()=>i,W5:()=>c,in:()=>r});var a=s(59754);const r=(0,a.lQ)("ANALYTICS/PAGEVIEW"),n=(0,a.lQ)("ANALYTICS/TRACK_GOOGLE"),i=(0,a.lQ)("ANALYTICS/SET_CONSENT_GRANTED"),c=(0,a.lQ)("ANALYTICS/CHANGE_PROJECT_ID")},11776:(e,t,s)=>{s.d(t,{v:()=>r});var a=s(59754);const r=(0,a.lQ)("APP/OPEN_URL");(0,a.lQ)("APP/RELOAD")},12027:(e,t,s)=>{s.d(t,{c:()=>a.c});var a=s(17480)},35606:(e,t,s)=>{s.d(t,{I7:()=>n,it:()=>r,tc:()=>i});var a=s(91205);const r=(0,a.T)("ENTITY/FETCH_PROFILE_NO_TYPE"),n=(0,a.T)("ENTITY/FETCH_MULTIPLE"),i=(0,a.T)("ENTITY/FETCH_BY_POINT")},35058:(e,t,s)=>{s.d(t,{M:()=>a});const a=(0,s(91205).T)("REVIEW/FETCH_REVIEWS")},4080:(e,t,s)=>{s.d(t,{R:()=>a});const a=e=>({type:"ENTITY/FETCH_VIDEO_DATA",payload:e,async:!0})},37544:(e,t,s)=>{s.d(t,{Sq:()=>r,Uj:()=>d,_C:()=>n,_z:()=>c,bu:()=>u,rX:()=>i,uf:()=>o});var a=s(91205);const r=e=>({type:"FEEDBACK/SEND",payload:e,async:!0}),n=(0,a.T)("FEEDBACK/REVIEW_COMPLAINT"),i=(0,a.T)("FEEDBACK/STORY_COMPLAINT"),c=e=>({type:"FEEDBACK/PHOTO_COMPLAINT",payload:e,async:!0}),o=e=>({type:"FEEDBACK/SEND_TYPED",payload:e,async:!0}),d=e=>({type:"FEEDBACK/FETCH_USER_FEEDBACKS",payload:e,async:!0}),u=e=>({type:"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT",payload:e,async:!0})},32643:(e,t,s)=>{s.d(t,{dC:()=>a,g5:()=>n,qP:()=>r});const a=e=>({type:"HISTORY/PUSH",payload:e,history:!0}),r=()=>({type:"HISTORY/BACK",history:!0}),n=e=>({type:"HISTORY/REPLACE_STATE",payload:e,history:!0})},95083:(e,t,s)=>{s.d(t,{TI:()=>i,Xv:()=>o,c_:()=>n,wp:()=>c});var a=s(91205),r=s(59754);(0,a.T)("MARKET/FETCH_PRODUCT_BY_ID");const n=(0,a.T)("MARKET/FETCH_CATEGORIES_BY_BRANCH"),i=(0,a.T)("MARKET/FETCH_BRANCH_PRODUCTS"),c=((0,a.T)("MARKET/FETCH_OFFERS"),(0,a.T)("MARKET/FETCH_SUGGESTIONS")),o=(0,r.lQ)("MARKET/DROP_SUGGESTIONS")},91950:(e,t,s)=>{s.d(t,{W:()=>a});const a=(0,s(91205).T)("SEARCH_HISTORY/CLEAR_SEARCH_HISTORY")},25151:(e,t,s)=>{s.d(t,{Cg:()=>i,jx:()=>c,lr:()=>r,sS:()=>n});var a=s(59754);const r=e=>({type:"REGION/FETCH",payload:e,async:!0}),n=e=>({type:"REGION/DETECT",payload:e,async:!0}),i=()=>({type:"REGION/CLEAR_DETECTOR"}),c=(0,a.lQ)("REGION/SET_DETECTOR")},62154:(e,t,s)=>{s.d(t,{q:()=>a});const a=e=>({type:"SEARCH/FETCH_PROVIDERS",payload:e,async:!0})},59208:(e,t,s)=>{s.d(t,{A:()=>r,b:()=>a});const a=e=>({type:"SEARCH/FETCH_FILIALS",payload:e,async:!0}),r=e=>({type:"SEARCH/FETCH_FILIALS_FILTERS",payload:e,async:!0})},3517:(e,t,s)=>{s.d(t,{d:()=>r,r:()=>n});var a=s(91205);const r=(0,a.T)("SEARCH/BY_BUILDING_ID"),n=(0,a.T)("SEARCH/IN_BUILDING_BY_QUERY")},37895:(e,t,s)=>{s.d(t,{p:()=>a});const a=e=>({type:"SEARCH/FETCH_MAINTAINERS",payload:e,async:!0})},13204:(e,t,s)=>{s.d(t,{Wj:()=>a,cQ:()=>i,o:()=>n,vO:()=>r});const a=(0,s(91205).T)("SEARCH/FETCH_QUERY"),r=e=>({type:"SEARCH/FETCH_RUBRIC",payload:e,async:!0}),n=e=>({type:"SEARCH/FETCH_ATTRIBUTE",payload:e,async:!0}),i=e=>({type:"SEARCH/FETCH_FILTERS",payload:e,async:!0})},47310:(e,t,s)=>{s.d(t,{Xw:()=>r,Zg:()=>a});const a=(0,s(91205).T)("SEARCH/FETCH_OBJECT_SUGGESTIONS"),r=()=>({type:"SEARCH/CROP_SUGGESTION"})},42793:(e,t,s)=>{s.d(t,{v:()=>n});var a=s(91205),r=s(59754);(0,a.T)("SEO_STORE/FETCH");const n=(0,r.lQ)("SEO_STORE/CLEAR_MINI_TEXT")},89415:(e,t,s)=>{s.d(t,{$y:()=>r,LS:()=>i,Og:()=>n,Oo:()=>c});var a=s(59754);const r=e=>({type:"USER/FOLLOW_LOCATION",payload:e}),n=e=>({type:"USER/SET_LOCATION",payload:e}),i=e=>({type:"USER/SET_WINDOW_SIZE",payload:e}),c=((0,a.lQ)("USER/SET_STAT_HASH"),(0,a.lQ)("USER/SET_3D_MAP_ENABLED_STATUS"))},12690:(e,t,s)=>{s.d(t,{a6:()=>i,ib:()=>r,m8:()=>n});var a=s(59754);const r=(0,a.lQ)("TIME/SET"),n=(0,a.lQ)("TIME/SET_DELTA"),i=(0,a.lQ)("TIME/SET_TIMEZONE")},37700:(e,t,s)=>{s.d(t,{Gp:()=>l,Iq:()=>o,Jx:()=>g,Lx:()=>d,S8:()=>p,V:()=>i,Vu:()=>b,j:()=>n,lW:()=>c,pO:()=>u});var a=s(91205),r=s(59754);const n=e=>({type:"USER/CONFIRM_REGISTRATION",payload:e,async:!0}),i=e=>({type:"USER/FETCH_REVIEWS",payload:e,async:!0}),c=(0,a.T)("USER/DELETE_REVIEW"),o=(0,r.lQ)("USER/ADD_HISTORY_OBJECT"),d=(0,r.lQ)("USER/ADD_HISTORY_SEARCH"),u=(0,a.T)("USER/SAVE_HISTORY"),l=(0,a.T)("USER/LOAD_HISTORY"),g=(0,a.T)("USER/CLEAR_HISTORY"),p=(0,r.lQ)("USER/ACTIVATE_MY_GEOLOCATION"),b=(0,r.lQ)("USER/DEACTIVATE_MY_GEOLOCATION");(0,r.lQ)("USER/CLEAR_DEVICES")},88735:(e,t,s)=>{s.d(t,{bT:()=>d,o6:()=>o,pj:()=>u,zC:()=>l});var a=s(46287),r=s(1364),n=s(35350),i=(s(21959),s(46234)),c=s(12017);function o(e,t){return(0,c.Q2)((s=>{const r=(0,a.Tq)({state:s,entityId:e.entityId,searchId:e.searchId});return t(r,s)}))}function d(e,t){return(0,c.Q2)((s=>{const a=(0,r.xW)({state:s,id:e});return t(a,s)}))}function u(e,t){return(0,c.Q2)((s=>{const a=(0,n.n)({state:s,id:e});return t(a,s)}))}function l(e,t){return(0,c.Q2)((s=>{const a=(0,i.V)({state:s,statusId:e});return t(a)}))}},48914:(e,t,s)=>{s.d(t,{Hw:()=>i,Qh:()=>n,X_:()=>a,cD:()=>r});const a=e=>({type:"BSS/TRACK_SHOW",payload:e,bssV3:!0}),r=e=>({type:"BSS/TRACK_ACTION",payload:e,bssV3:!0}),n=e=>({type:"BSS/TRACK_AUDIENCE_COUNTER",payload:e,bssV3:!0}),i=e=>({type:"BSS/DEFER_EVENT_ORDINAL",payload:e,bssV3:!0})},24272:(e,t,s)=>{s.d(t,{_:()=>u});var a=s(69924),r=s(21959),n=s(40415),i=s(35023),c=s(67461),o=s(33414),d=s(15014);function u(e){const{apikey:t,commitIsoDate:s,state:u,eventParams:l,enhancedAttrs:g,deviceLocale:p,tabId:b,abTest:O,clientId:E,isMobileDevice:h,sendPrivacyData:f}=e,m=(0,r.ug)(u);return Object.assign(Object.assign({common:{formatVersion:3,appVersion:(0,c.v)(s),product:E,apikey:t,apikeyStatus:1,deviceLocale:p,user:f?u.session.userId:null,ip:f?u.session.ip:(0,i.kx)(u.session.ip),sessionId:u.config.sessionId,userAgent:u.session.userAgent,authUser:m&&m.data&&m.data.user_id,deviceType:h?"mobile":"desktop",personalDataCollectionAllowed:f,tabIsActive:!document.hidden},map:g.map,utcOffset:(0,n.t)(u.session.timezone),tabId:b||u.config.tabId,timestamp:(0,a.l)(u.session.timeDelta)},l),{abTest:O&&O.length>0?O:void 0,screenState:(0,o.M)(),userSettings:(0,d.p)(u)})}},21252:(e,t,s)=>{s.d(t,{f:()=>g});var a=s(31085),r=s(14041),n=s(48914),i=s(35023),c=s(84711),o=s(15471),d=s(12017),u=s(79594),l=s(20181);function g(e,t,s){return function(g){class p extends r.PureComponent{constructor(t){super(t),this.state={showEventOrdinal:void 0},this.wasMounted=!1,this.refEl=null,this.generateShowEventBssParams=()=>{if(!e)return;const t=(0,i.W7)(),s=e(this.props,this.context.store.getState());return s?Object.assign({showEventKey:t},s):void 0},this.enhancedDispatch=t=>{const a=this.context.store.dispatch;if(!e||s&&s.trackActionsRegardlessOfShow)return a(t);if(void 0!==this.state.showEventOrdinal)return a(t);const r=this.generateShowEventBssParams();return r?a((0,d.K2)((0,n.X_)(Object.assign(Object.assign({},r),{autoEvent:!0})),t)):(0,d.lQ)()},this.sendShowEvent=()=>{const e=this.generateShowEventBssParams();e&&this.context.store.dispatch((0,d.K2)((0,n.X_)(e),(0,d.v6)((()=>{const t=(0,l.JW)(e.showEventKey);return this.wasMounted&&this.setState({showEventOrdinal:t}),(0,d.lQ)()}))))},this.componentRef=e=>{e&&(this.refEl=e,this.initObserver(e))}}componentDidUpdate(e){const t=s&&s.forceSendShowIfPropsChanged;t&&t.some((t=>this.props[t]!==e[t]))&&this.refEl&&!this.observer&&this.initObserver(this.refEl)}componentDidMount(){this.wasMounted=!0}componentWillUnmount(){this.destroyObserver(),this.wasMounted=!1}render(){const e=Object.assign(Object.assign({},this.props),{showEventOrdinal:this.state.showEventOrdinal}),s=t?t(this.enhancedDispatch,e):void 0;return(0,a.jsx)(g,Object.assign({},e,s,{bssRef:this.componentRef,sendShowEvent:this.sendShowEvent}))}initObserver(t){if(!this.context.store||!e)return;if(s&&s.forcedIntersection)return void this.sendShowEvent();const a=s&&void 0!==s.threshold?s.threshold:0;this.observer=(0,c.Z)(t,{threshold:a},(e=>{e.some((e=>e.isIntersecting||void 0===e.isIntersecting))&&(this.sendShowEvent(),this.destroyObserver())}))}destroyObserver(){this.observer&&(this.observer.disconnect(),this.observer=void 0)}}return p.displayName=`WithBss(${g.displayName||g.name||"Unnamed"})`,p.contextType=u.ty,e=>(0,a.jsx)(o.X.Consumer,{children:t=>(0,a.jsx)(p,Object.assign({ownerFrameId:t.frameId},e))})}}},15471:(e,t,s)=>{s.d(t,{X:()=>a});const a=s(14041).createContext({frameId:""})},8365:(e,t,s)=>{s.d(t,{E:()=>g});var a=s(14041),r=s(15471),n=s(79594),i=s(35023),c=s(84711),o=s(12017),d=s(48914),u=s(20181);const l="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?a.useLayoutEffect:a.useEffect;function g(e,t){const s=(0,a.useContext)(r.X),i=(0,n.Pj)(),[g,b]=(0,a.useState)(void 0),O=(0,a.useRef)(!1),E=(0,a.useRef)(!1),h=(0,a.useRef)(),f=(0,a.useRef)(null),m=(0,a.useRef)((()=>{})),j=(0,a.useRef)(void 0);return l((()=>{m.current=t=>{if(!e&&t)return void i.dispatch(t);if(!0===E.current)return;j.current=p(e,s,i.getState());const a=j.current;a&&(E.current=!0,i.dispatch((0,o.K2)((0,d.X_)(Object.assign({autoEvent:!!t||void 0},a)),(0,o.v6)((()=>{const e=(0,u.JW)(a.showEventKey);return O.current&&b(e),(0,o.lQ)()})),t||(0,o.lQ)())))}}),[s,e]),(0,a.useEffect)((()=>(O.current=!0,()=>{O.current=!1})),[]),(0,a.useEffect)((()=>{t&&t.forceSendShowIfParamsChanged&&E.current&&(E.current=!1)}),t&&t.forceSendShowIfParamsChanged?t&&t.forceSendShowIfParamsChanged:[]),(0,a.useEffect)((()=>{if(!e||!f.current||E.current)return;if(t&&t.forcedIntersection)return void m.current();const s=t&&void 0!==t.threshold?t.threshold:0;return h.current=(0,c.Z)(f.current,{threshold:s},(e=>{var t;e.some((e=>e.isIntersecting||void 0===e.isIntersecting))&&(m.current(),null===(t=h.current)||void 0===t||t.disconnect(),h.current=void 0)})),()=>{var e;null===(e=h.current)||void 0===e||e.disconnect(),h.current=void 0}}),[e]),{showEventOrdinal:g,bssRef:f,sendShowEvent:m,useBssHandler:(t,r)=>{const n=(0,a.useRef)(r),c=(0,a.useCallback)((a=>{E.current||(j.current=p(e,s,i.getState()));const r={frameId:s.frameId,showEventParams:j.current},c=t(n.current)(r,i.getState(),a);if(!c)return;const o=(0,d.cD)(c);!E.current&&j.current?(m.current(o),h.current&&(h.current.disconnect(),h.current=void 0)):i.dispatch(o)}),[t,s.frameId]);return l((()=>{n.current=r})),c}}}function p(e,t,s){if(!e)return;const a=(0,i.W7)(),r=e(t,s);return r?Object.assign({showEventKey:a},r):void 0}},2575:(e,t,s)=>{s.d(t,{O:()=>i});var a=s(48914),r=s(12017);function n(e,t){const[s,a]=e.split("?"),r=a&&a.split("&").filter((e=>e.split("=")[0]!==t)).join("&");return r?[s,r].join("?"):s}const i=(0,r.n5)("trackInitialBssEvents",(e=>(0,r.K2)((0,a.cD)({uiElement:{name:"application"},payload:{launch:{link:n(e.link,"stat"),referrer:e.refererHost,utm:e.utm,crossTab:e.crossTab?{parentTabId:e.crossTab.parentTabId,forkEventOrdinal:e.crossTab.forkEventOrdinal,uiElement:e.crossTab.uiElement}:void 0},placeItem:e.crossTab?e.crossTab.placeItem:void 0,searchResultsList:e.crossTab?e.crossTab.searchResultsList:void 0},action:"launch"}),(0,a.Qh)({payload:{audienceCounter:{counterType:"launch",link:n(e.link,"stat"),segmentInfo:{segmentId:e.overlapRegionId,baseLocale:e.dataLocale},referrer:e.refererUrl,utm:e.utm}}}),(()=>{if(!e.searchFrameParams)return!1;const{query:t,rubricId:s}=e.searchFrameParams,r={uiElement:{name:"searchStart",ownerName:"application"},payload:{searchRequest:{text:t,entities:s?[{id:s,type:"rubric"}]:void 0}},autoEvent:!0,action:"tap"};return(0,a.cD)(r)})())))},60118:(e,t,s)=>{s.d(t,{W:()=>m});var a=s(85608),r=s(35023);var n=s(24272),i=s(20181);function c(){let e=()=>{},t=!1;return{promise:new Promise((t=>{e=t})).then((()=>{t=!0})),resolve:e,isResolved:()=>t}}var o=s(50432),d=s(2338);function u(e,t){let s=0;const{whenFrameShowTracked:u,resolveFrameShowTracked:g,isFrameShowTracked:p}=function(){const e={};return{isFrameShowTracked:t=>e[t]&&e[t].isResolved(),whenFrameShowTracked:t=>(e[t]||(e[t]=c()),e[t].promise),resolveFrameShowTracked:t=>{e[t]||(e[t]=c()),e[t].resolve()}}}();return c=>b=>O=>O.bssV3?"BSS/DEFER_EVENT_ORDINAL"===O.type?(s+=1,c.dispatch(O.payload(s-1))):(function(c,b){(0,a.sH)(this,void 0,void 0,(function*(){const a="dangerouslyForcedEventOrdinal"in b.payload?b.payload.dangerouslyForcedEventOrdinal:void 0,O=null!=a?a:s;if(c.session.isSearchBot)return;if("BSS/TRACK_ACTION"===b.type&&t.sendPrivacyData&&(0,d.S)("sessionUpdatedAt",String(Date.now())),"BSS/TRACK_ACTION"===b.type&&"frameUuid"in b.payload.uiElement){const e=b.payload.uiElement.frameUuid;p(e)||"sideIconMenu"===b.payload.uiElement.ownerName||(yield u(e))}const E=t.paramsEnhancer(c),h=function(e,t){switch(e.type){case"BSS/TRACK_ACTION":return s=Object.assign(Object.assign({},e.payload),{eventOrdinal:t}),{type:211,eventType:"action",eventId:(0,r.W7)(),actionType:s.action,eventOrdinal:s.eventOrdinal,uiElement:s.uiElement,autoEvent:s.autoEvent,payload:s.payload};case"BSS/TRACK_SHOW":return function(e){return{type:212,eventType:"view",eventId:(0,r.W7)(),eventOrdinal:e.eventOrdinal,uiElement:e.uiElement,autoEvent:e.autoEvent,payload:"payload"in e?e.payload:void 0}}(Object.assign(Object.assign({},e.payload),{eventOrdinal:t}));case"BSS/TRACK_AUDIENCE_COUNTER":return function(e){return{type:205,eventType:"audienceCounter",eventId:(0,r.W7)(),payload:"payload"in e?e.payload:void 0}}(e.payload);default:return}var s}(b,O),f=h?(0,n._)({apikey:t.apikey,commitIsoDate:t.commitIsoDate,deviceLocale:c.session.browserLocale,state:c,eventParams:h,enhancedAttrs:E,abTest:t.abTest,clientId:t.clientId,isMobileDevice:t.isMobileDevice,sendPrivacyData:t.sendPrivacyData}):void 0;if(!f)return void(0,o.vV)({message:"bssTracker error: Не удалось сформировать события для bss-экшена",level:"error",id:"fkkw3",payload:{type:"debug",subtype:"BssTrackerV3",data:JSON.stringify(b)}});const m=f.payload,j=Object.assign(Object.assign({},f),{payload:l(m)});"BSS/TRACK_SHOW"===b.type&&((0,i.jH)(b.payload.showEventKey,s),"type"in b.payload.uiElement&&"frame"===b.payload.uiElement.type&&g(b.payload.uiElement.uuid)),(0,r.kk)(j),e(j),"BSS/TRACK_AUDIENCE_COUNTER"!==b.type&&O===s&&(s+=1)}))}(c.getState(),O),b(O)):b(O)}function l(e){var t;return e&&"searchRequest"in e&&e.searchRequest&&"text"in e.searchRequest?Object.assign(Object.assign({},e),{searchRequest:Object.assign(Object.assign({},e.searchRequest),{text:null===(t=e.searchRequest.text)||void 0===t?void 0:t.substr(0,500)})}):e&&"audienceCounter"in e?Object.assign(Object.assign({},e),{audienceCounter:Object.assign(Object.assign({},e.audienceCounter),{link:e.audienceCounter.link.substr(0,2047)})}):e&&"launch"in e?Object.assign(Object.assign({},e),{launch:Object.assign(Object.assign({},e.launch),{link:e.launch.link.substr(0,2047)})}):e}function g(e){Array.isArray(e)?e.forEach((e=>{p(e,{withStyles:true})})):p(e,{withStyles:true})}function p(e,t){if("audienceCounter"!==e.eventType&&t.withStyles,"audienceCounter"===e.eventType)t.withStyles;else switch(e.eventType){case"action":if("textInput"===e.actionType){b(e,"🎹",t);break}b(e,"🎬",t);break;case"view":b(e,"👀",t);break;default:b(e,"🤔",t)}!function(e){const t=JSON.parse(JSON.stringify(e));delete t.type,delete t.timestamp,delete t.utcOffset}(e)}function b(e,t,s){e.uiElement&&e.uiElement.name,e.actionType&&e.actionType,function(e,t){switch(e){case"action":return"textInput"===t?"185,182,73":"41,148,0";case"view":return"0,114,206";default:;}}(e.eventType,e.actionType);s.withStyles}function O(e){const t=window;t.testHandles=t.testHandles||{},t.testHandles.bssRawLog=t.testHandles.bssRawLog||{},t.testHandles.bssRawLog.request=t.testHandles.bssRawLog.request||[],t.testHandles.bssRawLog.clear=()=>{t.testHandles.bssRawLog.request=[]},t.testHandles.bssRawLog.request.push(e)}var E=s(91171),h=s(2487);class f{constructor(e,t){this.queue=[],this.canRetry=!0,this.isOffline=!1,this.baseUrl=t.analyticsBssUrl,this.noDelay=t.noDelay,this.url=this.getRegEventUrl(),this.request=e,this.delayTime=250,this.clientTimeout=3e4,this.bssDbgMode=t.bssDbgMode,t.enableTestHandles&&(this.testHandles=function(){if("undefined"==typeof window)return;const e=window;return e.testHandles=e.testHandles||{},e.testHandles.bssErrors=e.testHandles.bssErrors||[],e.testHandles.bssLog=new h.j,e.testHandles.setQueueState=t=>e.testHandles.isQueueEmpty=t,e.testHandles.setBssValidationError=t=>{e.testHandles.bssErrors.push(...t.map((e=>({message:JSON.stringify(e.message,void 0,2),validation_error:JSON.stringify(e.validation_error,void 0,2)}))))},e.testHandles}())}changeOnlineStatus(e){this.isOffline=e,e||this.startQueue()}track(e){this.url&&this.addToQueue(this.url,e)}getEvents(){return[]}addToQueue(e,t){this.queue.push({url:e,params:{data:t}}),this.startQueue(),this.testHandles&&this.testHandles.setQueueState(!1)}startQueue(){this.currentRequestData||this.isOffline||(this.currentRequestData=this.queue.shift(),this.currentRequestData&&this.doRequest(this.currentRequestData))}doRequest(e){const t={timeout:this.clientTimeout,method:"post",data:e.params.data};return this.request(e.url,t).then((e=>{if(202===e.status&&e.data){const s=e.data.checks.filter((e=>!e.valid));this.testHandles&&this.testHandles.setBssValidationError(s),this.bssDbgMode&&(t=s,t.forEach(((e,t)=>{})))}var t;this.successHandler()})).catch((t=>{if(this.isOffline)return this.queue.unshift(this.currentRequestData),void(this.currentRequestData=void 0);let s;s=t instanceof E.pe?t.details.message:t.message||"Unknown error",this.errorHandler(e,s)}))}successHandler(){this.canRetry=!0,this.logRequest(),this.currentRequestData=this.queue.shift(),this.currentRequestData?this.delayRequest(this.currentRequestData):this.testHandles&&this.testHandles.setQueueState(!0)}errorHandler(e,t){if("0"!==t&&this.canRetry)return this.canRetry=!1,void this.delayRequest(e);(0,o.vV)({message:`apiTracker error: ${t}`,level:"warn",id:"aibu0",payload:{type:"network",subtype:"BssTrackerV3",request_url:this.url,request_params:JSON.stringify(e)}}),this.successHandler()}delayRequest(e){this.noDelay?this.doRequest(e):setTimeout((()=>{this.doRequest(e)}),this.delayTime)}getRegEventUrl(){return this.baseUrl}logRequest(){this.testHandles&&this.testHandles.bssLog.setRequest(this.currentRequestData)}}function m(e,t){if("none"===e.bssSendingMode)return e=>t=>s=>s.bssV3?"BSS/DEFER_EVENT_ORDINAL"===s.type?e.dispatch(s.payload(0)):void 0:t(s);const s=(0,E.WL)(e,{GDPRAllowedServiceHosts:[e.bssV3Url]});return u(function(e,t){let s=[],a=!1;const n=function(e){const t=window,s=void 0!==t.bssV3Extention?t.bssV3Extention():r.lQ,a=e.bssdbgmd?g:r.lQ,n=e.analyticsBssEnableTestHandles?O:r.lQ;return e=>{s(e),n(e),a(e)}}(t);return t=>{n(t);const r="audienceCounter"===t.eventType,i="action"===t.eventType&&"launch"===t.actionType;r||i?e.track([t]):(s.push(t),a||(a=!0,setTimeout((()=>{e.track(s),s=[],a=!1}),2e3)))}}(new f(s,{analyticsBssUrl:e.bssV3Url,enableTestHandles:e.analyticsBssEnableTestHandles,bssDbgMode:e.bssdbgmd}),e),{apikey:e.webApiKey,commitIsoDate:e.commitIsoDate,paramsEnhancer:t,abTest:e.experiments,clientId:Number(e.clientId),isMobileDevice:e.isMobileDevice,sendPrivacyData:"full"===e.bssSendingMode})}},20181:(e,t,s)=>{s.d(t,{JW:()=>n,jH:()=>r});let a={};function r(e,t){a[e]=t}function n(e){return a[e]}setInterval((function(){a={}}),18e5)},59954:(e,t,s)=>{s.d(t,{$C:()=>l,Jr:()=>c,K0:()=>o,Ml:()=>r,T_:()=>d,i$:()=>p,j4:()=>i,lO:()=>u,qt:()=>g,sl:()=>a,t0:()=>n});const a=["__empty","undefined"],r=[],n={},i="DEFAULT_SEARCH_ID",c={ru:"ru",kz:"kz",ae:"ae",cy:"com.cy",cz:"cz",it:"it",cl:"cl",kg:"kg",uz:"uz",az:"az",sa:"com",iq:"com",om:"com",qa:"qa",bh:"bh",eg:"com",kw:"com",by:"by",ma:"ma",am:"am",ge:"ge"},o="__empty",d="65536",u="porch",l="transport",g=["bus","trolleybus","tram","shuttle_bus","metro","suburban_train","funicular_railway","monorail","river_transport","cable_car","light_rail","premetro","light_metro","aeroexpress","pedestrian","mcc","mcd"],p="default"},92854:(e,t,s)=>{s.d(t,{o:()=>i});var a=s(16654),r=s(59954),n=s(78535);const i=e=>{const t=n.U[e],s=a.get(t.name);if(s&&!r.sl.includes(s))return s}},68122:(e,t,s)=>{s(59954),s(78535)},78535:(e,t,s)=>{s.d(t,{U:()=>n});const a=7665,r=void 0,n={lang:{name:"dg5_lang",expires:a},pos:{name:"dg5_pos",expires:a},userId:{name:"_2gis_webapi_user",expires:a,shared:!0},sessionId:{name:"_2gis_webapi_session",expires:r,shared:!0},sessionUpdatedAt:{name:"_2gis_webapi_session_lut",expires:r,shared:!0},is3dDisabled:{name:"is3dDisabled",expires:a},bssDebugMode:{name:"dg5_bssdbgmd",expires:a},searchDebugMode:{name:"dg5_srchdbgmd",expires:a},mapDebugMode:{name:"dg5_mapdbgmd",expires:a},_searchbot:{name:"_searchbot",expires:a},overrideConfig:{name:"dg5_override_config",expires:r},jurisdiction:{name:"dg5_jur",expires:a},museumAccept:{name:"dg5_museum_accept",expires:a},project:{name:"project",expires:a},flags:{name:"dg5_flags",expires:a},monlineFlags:{name:"flags",expires:a},isFriendsClicked:{name:"dg5_is_friends_clicked",expires:a},bannerClose_desktopFriendsPromo:{name:"dg5_bnrcls_dskfrdprm",expires:a}}},2338:(e,t,s)=>{s.d(t,{S:()=>i});var a=s(16654),r=s(78535);function n(e){const[t,s,a]=e.split(".").reverse();return s?"cy"===t&&"com"===s?`.${a}.${s}.${t}`:`.${s}.${t}`:e}const i=(e,t,s)=>{const i=r.U[e],c={expires:i.expires?i.expires:void 0,domain:i.shared?n(window.location.hostname):void 0};if(t)return a.set(i.name,t,c),s?s(i.name,t,c):void 0;a.remove(i.name,c)}},92290:(e,t,s)=>{s.d(t,{D:()=>a,b:()=>r});const a=["new","in_progress","ready_for_delivery","delivery"],r=["sent_to_company","canceled","returned","done"]},37397:(e,t,s)=>{s.d(t,{$:()=>a});const a=["656x340","328x170","232x232","176x176","116x116","88x88"]},70249:(e,t,s)=>{s.d(t,{p4:()=>i});var a=s(35023),r=s(12954),n=s(23253);(0,n.r)(),(0,r.u)();const i={id:(0,n.r)(),url:"https://image.jpeg",real_object_type:"branch",height:0,width:0,preview_urls:(0,r.u)(),copyright:{type:"image",value:"https://2gis.ru",url:"https://2gis.ru",code:"2gis_owner",icon:"http://iconUrl.svg",title:"Фотография от владельца"},owner:{id:(0,a.W7)(),name:"Владелец",avatar:"http://iconUrl.svg"},modification_time:"2017-09-05T11:36:47+07:00",creation_time:"2017-09-05T11:36:47+07:00"}},75370:(e,t,s)=>{var a;s.d(t,{ED:()=>r,XS:()=>n,bI:()=>i}),function(e){e.active="active",e.blocked="blocked",e.hidden="hidden"}(a||(a={}));const r=e=>e&&"real_object_type"in e&&!("media_type"in e),n=e=>e&&!("real_object_type"in e)&&!("media_type"in e),i=e=>"preview_urls"in e&&"320x"in e.preview_urls},41882:(e,t,s)=>{s.d(t,{Ok:()=>r});var a=s(96508);(0,a.u)(),(0,a.u)(),(0,a.u)();const r={id:"review-id",provider:"2gis",text:(0,a.u)("fewWords"),likes_count:0,rating:3,date_created:"2019-12-02T13:09:03.495139+07:00",object:{id:"11111111551",type:"branch",address:"Новосибирск, Карла Маркса площадь, 7",logo_urls:{"112x112":"https://www.placecage.com/c/112x112","128x128":"https://www.placecage.com/c/128x128","132x132":"https://www.placecage.com/c/132x132","144x144":"https://www.placecage.com/c/144x144","168x168":"https://www.placecage.com/c/168x168","48x48":"https://www.placecage.com/c/48x48","56x56":"https://www.placecage.com/c/56x56","64x64":"https://www.placecage.com/c/64x64","72x72":"https://www.placecage.com/c/72x72","96x96":"https://www.placecage.com/c/96x96",url:"https://www.placecage.com/c/500/500"},name:"2ГИС, городской информационный сервис",is_deleted:!1},user:{id:"78952164551454",reviews_count:1,first_name:"Джей Ди",name:"Джей Ди",provider:"2gis",photo_preview_urls:{"64x64":""}},comments_count:0,is_hidden:!1,is_rated:!0,additional_data:{pin_status:"none",is_liked:null},provider_data:{caption:"Flamp",icon_url:"https://cachizer1.2gis.com/reviews-logos/984693dc-de95-4acc-8d1b-35d906b17374.png?h={height}&w={width}"}}},19400:(e,t,s)=>{s.d(t,{XS:()=>r.XS,ED:()=>r.ED,bI:()=>r.bI,Dg:()=>a.D});var a=s(92290),r=s(75370);s(475)},83487:(e,t,s)=>{var a,r;s.d(t,{E:()=>r,n:()=>a}),function(e){e.Award2Gis="awards2gis",e.AwardsGreatList="awardGreatList"}(a||(a={})),function(e){e.Award2Gis="awards2023",e.AwardsGreatList="awardGreatList"}(r||(r={}))},82995:(e,t,s)=>{s.d(t,{g:()=>r});var a=s(85608);const r=(0,s(75750).E)("fetchUserAchievements",(({locale:e})=>({achievesApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return t.getUserAchievements({locale:e,accessToken:a})}))))},46512:(e,t,s)=>{s.d(t,{r:()=>o});var a=s(85608),r=s(75750),n=s(56624),i=s(40194);const c="default",o=(0,r.E)("fetchUserActivity",(()=>({userActivityApi:e,credentialsApi:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(!s)throw new Error("accessToken is missing");return e.getUserActivity({accessToken:s})}))),(0,n.I)("user",{start:e=>Object.assign(Object.assign({},e),{activities:{[c]:Object.assign(Object.assign({},e.activities[c]),{meta:i._V})}}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{activities:{[c]:{data:null==t?void 0:t.activities,meta:i.rv}}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{activities:{[c]:Object.assign(Object.assign({},e.activities[c]),{meta:(0,i._3)(t)})}})}))},65621:(e,t,s)=>{s.d(t,{a:()=>o,k:()=>d});var a=s(85608),r=s(75750),n=s(22934),i=s(66003);const c="default",o=(0,r.E)("fetchUserFriendsActivity",(e=>({userActivityApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{maxFriendsPerObject:a,objectsIds:r}=e,n=yield s.getToken();if(!n)throw new Error("accessToken is missing");return t.getUserFriendsActivityByObjects({accessToken:n,maxFriendsPerObject:a,objectsIds:r})})))),d=(0,i.yG)("fetchUserFriendsActivity",{start:e=>(0,n.vL)(e,c),success(e,{params:t,result:s}){var a,r;const i=t.objectsIds.reduce(((e,t)=>(e[t]=void 0,e)),{}),o=s.activities.reduce(((e,t)=>(e[t.object_id]=t,e)),{}),d=Object.assign(Object.assign(Object.assign({},i),null===(r=null===(a=e[c])||void 0===a?void 0:a.data)||void 0===r?void 0:r.items),o);return(0,n.h$)(e,c,{items:d})},error:(e,{error:t})=>(0,n.i5)(e,c,t)})},25788:(e,t,s)=>{s.d(t,{i:()=>r});var a=s(85608);const r=(0,s(75750).E)("fetchApartments",(e=>({webApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("There is no access token in fetchApartments");return t.fetchApartments({id:e.id,locale:e.locale,accessToken:a})}))))},47960:(e,t,s)=>{s.d(t,{B:()=>a,Z:()=>r});const a="default",r="cart2gis"},35897:(e,t,s)=>{s.d(t,{jV:()=>l,sI:()=>d,zA:()=>u});var a=s(85608),r=s(75750),n=s(66003),i=s(22934),c=s(4340),o=s(47960);const d={orders:[],showCartButton:!1,customer:{}},u=(0,r.E)("createCart",(()=>()=>(0,a.sH)(void 0,void 0,void 0,(function*(){const e=JSON.parse(c.IG.local.getItem(o.Z));return e&&e.orders?e:d})))),l=(0,n.uI)("createCart","cart",{start:e=>(0,i.vL)(e,o.B),success:(e,{result:t})=>(0,i.h$)(e,o.B,t),error:(e,{error:t})=>(0,i.i5)(e,o.B,t)})},78205:(e,t,s)=>{s.d(t,{L:()=>d,v:()=>u});var a=s(85608),r=s(75750),n=s(66003),i=s(22934),c=s(4340),o=s(47960);const d=(0,r.E)("removeCart",(e=>()=>(0,a.sH)(void 0,void 0,void 0,(function*(){const t=c.IG.local.getItem(o.Z),s=JSON.parse(t),a=Object.assign(Object.assign({},s),{orders:s.orders.filter((t=>t.orgId!==e.orgId))});return c.IG.local.setItem(o.Z,JSON.stringify(a)),a})))),u=(0,n.uI)("removeCart","cart",{start:e=>(0,i.vL)(e,o.B),success:(e,{result:t})=>(0,i.h$)(e,o.B,t),error:(e,{error:t})=>(0,i.i5)(e,o.B,t)})},27797:(e,t,s)=>{s.d(t,{b:()=>d,v:()=>u});var a=s(85608),r=s(75750),n=s(66003),i=s(22934),c=s(4340),o=s(47960);const d=(0,r.E)("replaceCart",(e=>()=>(0,a.sH)(void 0,void 0,void 0,(function*(){return{cart:e}})))),u=(0,n.uI)("replaceCart","cart",{success(e,{result:t}){const s=t.cart;return c.IG.local.setItem(o.Z,JSON.stringify(s)),(0,i.h$)(e,o.B,s)}})},19376:(e,t,s)=>{s.d(t,{o:()=>d});var a=s(85608),r=s(75750),n=s(66003),i=s(22934),c=s(4340),o=s(47960);const d=(0,r.E)("saveCart",(e=>()=>(0,a.sH)(void 0,void 0,void 0,(function*(){var t;return{cart:null===(t=e.cartState[e.cartId])||void 0===t?void 0:t.data}}))));(0,n.uI)("saveCart","cart",{success(e,{result:t}){const s=t.cart;return s?(c.IG.local.setItem(o.Z,JSON.stringify(s)),(0,i.h$)(e,o.B,s)):e}})},78351:(e,t,s)=>{s.d(t,{i:()=>b,e:()=>O});var a=s(85608),r=s(75750),n=s(66003),i=s(22934),c=s(4340),o=s(47960),d=s(49629),u=s(24855);function l(e,t){if(0===e.length)return[t];const[,s]=(0,d.B)(e,t);return-1===s?0===t.qty?e:[...e,t]:(0,u.H)(e,t,s)}var g=s(35897),p=s(52973);const b=(0,r.E)("updateCart",(e=>()=>(0,a.sH)(void 0,void 0,void 0,(function*(){return{item:e.item}})))),O=(0,n.uI)("updateCart","cart",{start:e=>(0,i.vL)(e,o.B),success(e,{result:t}){var s;const a=(null===(s=e[o.B])||void 0===s?void 0:s.data)||g.sI,r=t.item.orgId,n=(0,p.p)(Object.assign(Object.assign({},a),{showCartButton:!0}),r,(e=>Object.assign(Object.assign({},e),{items:l(e.items,t.item)})));return c.IG.local.setItem(o.Z,JSON.stringify(n)),(0,i.h$)(e,o.B,n)},error:(e,{error:t})=>(0,i.i5)(e,o.B,t)})},49629:(e,t,s)=>{s.d(t,{B:()=>n,T:()=>r});var a=s(28356);function r(e,t){const s=(0,a.K)(e.orders,t.orgId);return n((null==s?void 0:s.items)||[],t)}function n(e,t){const s=e.findIndex((e=>e.orgId===t.orgId&&e.productId===t.productId));return-1===s?[void 0,s]:[e[s],s]}},87276:(e,t,s)=>{s.d(t,{u:()=>o});var a=s(85608),r=s(75750),n=s(56624),i=s(40194);const c="default",o=(0,r.E)("fetchUserChronologyPlaces",(()=>({chronologyPlacesApi:e,credentialsApi:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();return e.getUserChronologyPlaces({accessToken:s})}))),(0,n.I)("user",{start:e=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:i._V})}}),success(e,{result:t}){var s;if(!(null===(s=t.results)||void 0===s?void 0:s.length))return Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:(0,i.Sw)()})}});const a=t.results.map((e=>e.id));return Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:{data:{items:t.items.reduce(((e,t)=>(e[t.id]=t,e)),{}),resultsIds:a,total:a.length},meta:i.rv}}})},error:(e,{error:t})=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces),{meta:(0,i._3)(t)})}})}))},16890:(e,t,s)=>{s.d(t,{i:()=>o});var a=s(85608),r=s(75750),n=s(56624),i=s(40194);const c="default",o=(0,r.E)("fetchUserChronologyPlacesByObject",(e=>({chronologyPlacesApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return t.getUserChronologyPlacesByObjects({ids:e.ids,accessToken:a})}))),(0,n.I)("user",{start:e=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:i._V})}}),success(e,{result:t}){var s,a;const r=t.items.reduce(((e,t)=>(e[t.id]=t,e)),{}),n=e.chronologyPlaces[c];return(null==n?void 0:n.data)?Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:{data:Object.assign(Object.assign({},n.data),{items:Object.assign(Object.assign({},null===(a=null===(s=e.chronologyPlaces[c])||void 0===s?void 0:s.data)||void 0===a?void 0:a.items),r)}),meta:i.rv}}}):e},error:(e,{error:t})=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:(0,i._3)(t)})}})}))},7090:(e,t,s)=>{s.d(t,{A:()=>o,g:()=>c});var a=s(85608),r=s(75750),n=s(66003),i=s(22934);const c=(0,r.E)("fetchUserContestStatusByContestId",(({contestId:e})=>({contestApi:t,contextApi:s,credentialsApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){var a;const n=yield r.getToken(),i=null!==(a=yield s.get("locale"))&&void 0!==a?a:"ru_RU";return t.getUserContestStatus({locale:i,accessToken:n,contestId:e})})))),o=(0,n.uI)("fetchUserContestStatusByContestId","contests",{start:(e,{params:t})=>(0,i.vL)(e,t.contestId),success:(e,{result:t,params:s})=>(0,i.h$)(e,s.contestId,t),error:(e,{error:t,params:s})=>(0,i.i5)(e,s.contestId,t)})},62205:(e,t,s)=>{s.d(t,{p:()=>o,x:()=>c});var a=s(85608),r=s(75750),n=s(66003),i=s(22934);const c=(0,r.E)("joinUserInContest",(({locale:e,contestId:t})=>({contestApi:s,credentialsApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield r.getToken();return s.joinUser({locale:e,accessToken:a,contestId:t})})))),o=(0,n.uI)("joinUserInContest","contests",{start:(e,{params:t})=>(0,i.vL)(e,t.contestId),success:(e,{result:t,params:s})=>(0,i.h$)(e,s.contestId,t),error:(e,{error:t,params:s})=>(0,i.i5)(e,s.contestId,t)})},46303:(e,t,s)=>{s.d(t,{Y:()=>r});var a=s(85608);const r=(0,s(75750).E)("deleteCookie",(e=>({cookieApi:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{name:s}=e;yield t.setStrict(s,void 0)}))))},7044:(e,t,s)=>{s.d(t,{T:()=>r});var a=s(85608);const r=(0,s(75750).E)("setCookie",(e=>({cookieApi:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{name:s,value:a}=e;yield t.setStrict(s,a)}))))},95983:(e,t,s)=>{s.d(t,{a:()=>c});var a=s(75750),r=s(66698),n=s(56624),i=s(40194);const c=(0,a.E)("pedestrian",(({locale:e,projectCode:t,points:s,viewpoint:a,zoom:n})=>({directionsApi:i})=>{if(s.length<r.vl){const e={name:"ParamsError",code:400,message:`Недостаточно точек для построения пешего маршрута. Нужно по крайней мере ${r.vl}`};return Promise.reject(e)}if(!t){const e={name:"ParamsError",code:404,message:"Для поиска пеших маршрутов необходим код проекта"};return Promise.reject(e)}return i.pedestrian({projectCode:t,points:s,locale:e,viewpoint:a,zoom:n})}),(0,n.I)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:i._V}}),success:(e,{params:t,result:s})=>s.items.length&&t.projectCode?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"pedestrian",items:s.items,total:s.total,projectCode:t.projectCode},meta:i.rv}}):Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i.Sw)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i._3)(s)})})}))},31823:(e,t,s)=>{s.d(t,{s:()=>c});var a=s(75750),r=s(66698),n=s(56624),i=s(40194);const c=(0,a.E)("ppna",(({locale:e,points:t,viewpoint:s,zoom:a})=>({directionsApi:n})=>{if(t.length<r.vl){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${r.vl}`};return Promise.reject(e)}return n.ppna({points:t,locale:e,viewpoint:s,zoom:a})}),(0,n.I)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:i._V}}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"ppna",items:s.items,total:s.total},meta:i.rv}}):Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i.Sw)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i._3)(s)})})}))},1021:(e,t,s)=>{s.d(t,{s:()=>d});var a=s(85608),r=s(75750),n=s(66698),i=s(40194),c=s(56624),o=s(22934);const d=(0,r.E)("ppng",(({locale:e,points:t,viewpoint:s,zoom:r,filterValues:c})=>({directionsApi:o})=>(0,a.sH)(void 0,void 0,void 0,(function*(){if(t.length<n.vl){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${n.vl}`};return Promise.reject(e)}const a=yield o.ppng({points:t,locale:e,viewpoint:s,zoom:r,filterValues:c});if(0===a.items.length)throw i.vY;const d=a.items.filter((e=>{var t;return"no"!==(null===(t=e.features)||void 0===t?void 0:t.truck)}));if(d.length!==a.items.length){if(0===d.length)throw Object.assign(Object.assign({},i.vY),{name:"PpngNotFoundButPpnaFound"});return Object.assign(Object.assign({},a),{items:d,total:d.length})}return a}))),(0,c.I)("directions",{start:(e,{params:t})=>(0,o.vL)(e,t.searchId),success:(e,{params:t,result:{items:s,total:a}})=>(0,o.h$)(e,t.searchId,{type:"ppng",items:s,total:a}),error:(e,{params:t,error:s})=>(0,o.i5)(e,t.searchId,s)}))},3119:(e,t,s)=>{s.d(t,{i:()=>c});var a=s(75750),r=s(66698),n=s(56624),i=s(40194);const c=(0,a.E)("ppnot",(({locale:e,projectCode:t,points:s,viewpoint:a,zoom:n,filterValues:i})=>({directionsApi:c})=>{if(s.length<r.vl){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${r.vl}`};return Promise.reject(e)}if(!t){const e={name:"ParamsError",code:404,message:"Для ППНОТ необходим код проекта"};return Promise.reject(e)}return c.ppnot({projectCode:t,points:s,locale:e,viewpoint:a,zoom:n,filterValues:i})}),(0,n.I)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:i._V}}),success:(e,{params:t,result:s})=>s.items.length&&t.projectCode?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"ppnot",items:s.items,total:s.total,projectCode:t.projectCode},meta:i.rv}}):Object.assign(Object.assign({},e),{[t.searchId]:{data:t.projectCode?{type:"ppnot",items:[],total:0,projectCode:t.projectCode}:void 0,meta:(0,i.Sw)()}}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i._3)(s)})})}))},53896:(e,t,s)=>{s.d(t,{V:()=>i});var a=s(75750),r=s(56624),n=s(40194);const i=(0,a.E)("ppnotTypes",(({projectCode:e})=>({directionsApi:t})=>{if(!e){const e={name:"ParamsError",code:400,message:"Для получения ППНОТ типов необходим код проекта"};return Promise.reject(e)}return t.ppnotTypes({projectCode:e})}),(0,r.I)("directionsPpnotTypes",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.projectCode]:{meta:n._V}}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.projectCode]:{data:s.items,meta:n.rv}}):Object.assign(Object.assign({},e),{[t.projectCode]:Object.assign(Object.assign({},e[t.projectCode]),{meta:(0,n.Sw)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.projectCode]:Object.assign(Object.assign({},e[t.projectCode]),{meta:(0,n._3)(s)})})}))},17480:(e,t,s)=>{s.d(t,{A:()=>c,c:()=>i});var a=s(75750),r=s(66003),n=s(40194);const i=(0,a.E)("fetchEntityDiscounts",(e=>({discountsApi:t})=>t.getDiscounts({id:e.id}))),c=(0,r.yG)("fetchEntityDiscounts",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:n._V})}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.id]:{data:{items:s.items,total:s.total},meta:n.rv}}):Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:(0,n.Sw)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:(0,n._3)(s)})})})},18909:(e,t,s)=>{s.d(t,{Rt:()=>d,WA:()=>l,fO:()=>u,v$:()=>g});var a=s(75750),r=s(66003),n=s(24302),i=s(56190),c=s(35023),o=s(30345);const d=(0,a.E)("fetchEntityByEntrance",(e=>({webApi:t})=>t.getItemByEntrance({id:e.id}))),u=(0,r.Dp)("fetchEntityByEntrance",{},{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.id]:{data:void 0,meta:n._V}}),success:(e,{params:t,result:s})=>200!==s.code?e:Object.assign(Object.assign({},e),{[t.id]:{data:{id:s.items[0].id},meta:n.rv}}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.id]:{data:void 0,meta:(0,n._3)(s)}})}),l=(0,r.yG)("fetchEntityByEntrance",{success(e,{result:t}){if(200!==t.code)return e;const s=t.items[0];if(!("id"in s))return e;const a=e[s.id],r=(0,c.O9)(a)&&(0,c.O9)(a.data)?a.data:{};return Object.assign(Object.assign({},e),{[s.id]:{data:Object.assign(Object.assign({},r),(0,o.Rn)(s)),meta:n.rv}})}}),g=e=>t=>t.data.entity.entrance[e]||i.d},18797:(e,t,s)=>{s.d(t,{Wm:()=>u});var a=s(85608),r=s(75750),n=s(35023),i=s(32065),c=s(8163),o=s(30062),d=s(37295);const u=(0,r.E)("syncPublicFavorites",(e=>({favoritesApi:t,favoritesStorage:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{projectId:a,sync:r}=e,u=yield s.getPublic(),l=yield t.syncPublicFavorites({filter:{attribute_name:"project_id",values:{[a]:u.sync.lastSyncAttr.project_id[a]||null}}}),g=(0,o.y)(u,l,{projectId:a});if(yield s.setPublic(g),!(0,c.y)(r,u.sync)||!(0,n.Im)(l.id_changes))return{sync:g.sync,objects:(0,d.si)(g.objects),replace:!0};const p=Object.keys(l.objects),b=(0,n.LG)((0,i.Up)(g.objects,p),d.xT);return{sync:g.sync,objects:b,replace:!1}}))));s(3479),s(16392),s(22670),s(64519)},16392:(e,t,s)=>{s.d(t,{y:()=>d});var a=s(85608),r=s(75750),n=s(23134),i=s(35023),c=s(8163),o=s(37295);const d=(0,r.E)("modifyPersonalFavorites",(e=>({favoritesStorage:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const s=yield t.getPersonal(),a=(0,n.M)({stored:s,modification:e.objects,time:String(Date.now())});return yield t.setPersonal(a),(0,c.y)(e.sync,s.sync)?{replace:!1,sync:a.sync,objects:e.objects}:{replace:!0,sync:a.sync,objects:(0,i.LG)(a.objects,o.Qc)}}))))},64519:(e,t,s)=>{s.d(t,{T:()=>d});var a=s(85608),r=s(75750),n=s(23134),i=s(35023),c=s(8163),o=s(37295);const d=(0,r.E)("modifyPlaces",(e=>({favoritesStorage:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const s=yield t.getPlaces(),a=(0,n.M)({stored:s,modification:e.objects,time:String(Date.now())});return yield t.setPlaces(a),(0,c.y)(e.sync,s.sync)?{replace:!1,sync:a.sync,objects:e.objects}:{replace:!0,sync:a.sync,objects:(0,i.LG)(a.objects,o.ge)}}))))},3479:(e,t,s)=>{s.d(t,{v:()=>u});var a=s(85608),r=s(75750),n=s(35023),i=s(32065),c=s(8163),o=s(30062),d=s(37295);s(16392);const u=(0,r.E)("syncPersonalFavorites",(e=>({favoritesApi:t,favoritesStorage:s,credentialsApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getPersonal(),u=yield r.getToken();if(!u)throw new Error("There is no access_token");const l=yield t.syncPersonalFavorites({last_sync:a.sync.lastSync,objects:a.changes,access_token:u}),g=(0,o.y)(a,l);if(yield s.setPersonal(g),!(0,c.y)(e.sync,a.sync)||!(0,n.Im)(l.id_changes))return{sync:g.sync,objects:(0,n.LG)(g.objects,d.Qc),replace:!0};const p=Object.keys(l.objects),b=(0,n.LG)((0,i.Up)(g.objects,p),d.Qc);return{sync:g.sync,objects:b,replace:!1}}))))},22670:(e,t,s)=>{s.d(t,{_:()=>u});var a=s(85608),r=s(75750),n=s(35023),i=s(32065),c=s(8163),o=s(30062),d=s(37295);const u=(0,r.E)("syncPlaces",(e=>({favoritesApi:t,favoritesStorage:s,credentialsApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getPlaces(),u=yield r.getToken();if(!u)throw new Error("There is no access_token");const l=yield t.syncPlaces({last_sync:a.sync.lastSync,objects:a.changes,access_token:u}),g=(0,o.y)(a,l);if(yield s.setPlaces(g),!(0,c.y)(e.sync,a.sync)||!(0,n.Im)(l.id_changes))return{sync:g.sync,objects:(0,n.LG)(g.objects,d.ge),replace:!0};const p=Object.keys(l.objects),b=(0,n.LG)((0,i.Up)(g.objects,p),d.ge);return{sync:g.sync,objects:b,replace:!1}}))))},30062:(e,t,s)=>{s.d(t,{y:()=>n});var a=s(35023);function r(e,t){if(0===Object.keys(t).length)return e;const s=(0,a.LG)(t,((t,s)=>{if(!t||!t.system_is_deleted||"true"!==t.system_is_deleted[0])return Object.assign(Object.assign({},e[s]),t)}));return Object.assign(Object.assign({},e),s)}function n(e,t,s){const n=(i=e.objects,!(c=t.id_changes)||(0,a.Im)(c)?i:Object.keys(i).reduce(((e,t)=>{const s=c[t]?c[t]:t;return Object.assign(Object.assign({},e),{[s]:i[t]})}),{}));var i,c;return{sync:{lastSync:t.curr_sync,lastSyncAttr:s?{project_id:Object.assign(Object.assign({},e.sync.lastSyncAttr.project_id),{[s.projectId]:t.curr_sync})}:e.sync.lastSyncAttr},objects:r(n,t.objects),changes:{}}}},23134:(e,t,s)=>{s.d(t,{M:()=>o});var a=s(35023),r=s(19263),n=s(85512),i=s(18310),c=s(11449);function o(e){const{stored:t,modification:s,time:i}=e,c=(0,a.LG)(s,(e=>function(e){if(!e||!Object.keys(e).length)return;const t=(0,a.LG)(e,((e,t)=>{if(null!=e){if(Array.isArray(e))return e.map((e=>String(e)));if((0,n.F)(e))return[(0,r.bY)(e)];if((0,a.Gv)(e))try{return[JSON.stringify(e)]}catch(e){throw new Error(`invalid ${t}. Can't make json from object`)}return[String(e)]}}));return delete t.id,t}(e)));return Object.assign(Object.assign({},t),{objects:Object.assign(Object.assign({},t.objects),c),changes:d(t.objects,t.changes,c,i)})}function d(e,t,s,r){const n=(0,i.O)((0,a.LG)(s,((t,s)=>{const a=e[s];if(void 0===t){if(void 0===a)return;return{system_is_deleted:{time:r,value:["true"]}}}return function(e,t,s){const a=(0,i.O)((0,c.h)(e,t,((e,t)=>{if(e||t){if(!e)return{time:s,value:t||null};if(!l(e,t))return{time:s,value:t||null}}})));if(0!==Object.keys(a).length)return a}(void 0===a?{}:a,t,r)})));return(0,c.h)(t,n,((e,t)=>e&&t?function(e,t){if(u(t))return t;if(u(e))return t;const s=Object.assign({},e);for(const a in t)if(t.hasOwnProperty(a)){const r=e[a],n=t[a];if(!n)continue;if(!r){s[a]=t[a];continue}l(r.value,n.value)||(s[a]=t[a])}return 0!==Object.keys(s).length?s:void 0}(e,t):t||e))}function u(e){return!(!e.system_is_deleted||!e.system_is_deleted.value||"true"!==e.system_is_deleted.value[0])}function l(e,t){if(!e||!t)return!e==!t;if(e.length!==t.length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}},37295:(e,t,s)=>{s.d(t,{Qc:()=>g,ge:()=>d,si:()=>u,xT:()=>l});var a=s(21132),r=s(35023),n=s(19263),i=s(59050);function c(e,t){if(!e||!e.type||!e.type.length)return;const s=(0,r.LG)(e,((e,t)=>{let s=e&&e[0];if(null==e)s=void 0;else if((0,i.C)(a.gP,t))switch(a.gP[t]){case"boolean":s="true"===e[0].toLowerCase();break;case"number":s=Number(e[0]);break;case"lonlat":s=(0,n.iL)(e[0]);break;case"array":s=[...e];break;case"object":try{s=JSON.parse(e[0])}catch(e){s=void 0}}return s}));return s.id=t,s}const o=["interesting","guidebook","awards2019","shared_collections"];function d(e,t){const s=c(e,t);return s&&"place"===s.type?s:void 0}function u(e){const t={},s={},a=s=>{const a=l(e[s],s);a&&(t[s]=a)};for(const r in e){const n=e[r];if(n)switch(n.type&&n.type[0]){case"theme":n.code&&o.includes(n.code[0])&&(a(r),n.collections&&n.collections.forEach((e=>{a(e);const t=s[e];t&&t.forEach((e=>{a(e)}))})));break;case"favorite":{const e=n.collection_id&&n.collection_id[0];e&&(t[e]?a(r):(s[e]||(s[e]=[])).push(r));break}}}return t}function l(e,t){const s=c(e,t);if(s&&("favorite"===s.type||"collection"===s.type||"theme"===s.type))return"favorite"===s.type&&delete s.source_data,s}function g(e,t){const s=c(e,t);if(s&&("favorite"===s.type||"collection"===s.type))return s}},61165:(e,t,s)=>{s.d(t,{K:()=>i});var a=s(85512),r=s(35023),n=s(21132);function i(e,t){const s="point"===t.object_type&&void 0===e.object_id||e.object_id===t.object_id;if("point"===t.object_type&&!(0,a.F)(t.point))return!1;if(!s||!n.Im.includes(t.object_type))return s;const i=e.point||e.source_point;return(0,a.F)(i)||(0,a.F)(t.point)?!(!(0,a.F)(i)||!(0,a.F)(t.point))&&(0,r.lx)(i.lon,t.point.lon)&&(0,r.lx)(i.lat,t.point.lat):s}},8163:(e,t,s)=>{function a(e,t){if(e.lastSync!==t.lastSync)return!1;if(Object.keys(e.lastSyncAttr.project_id).length!==Object.keys(t.lastSyncAttr.project_id).length)return!1;for(const s in e.lastSyncAttr.project_id)if(e.lastSyncAttr.project_id[s]!==t.lastSyncAttr.project_id[s])return!1;return!0}s.d(t,{y:()=>a})},61696:(e,t,s)=>{s.d(t,{a:()=>c});var a=s(85608),r=s(24302),n=s(74006),i=s(56624);const c=(0,s(75750).E)("fetchUserHistory",(({userId:e,authId:t})=>({webApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){return s.getProfile({userId:e,authId:t})}))),(0,i.I)("profile",{start:e=>Object.assign(Object.assign({},e),{meta:r._V}),success(e,{result:t}){if(!t||200!==t.code)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{suggestLastObjects:[]}),meta:r.rv});const{last_objects:s,history_objects:a,home_work_objects:n}=t;return{data:{historyObjects:a,homeWorkObjects:n,suggestLastObjects:s},meta:r.rv}},error:(e,{error:t})=>Object.assign(Object.assign({},e),{meta:(0,r._3)(t)})}),(0,i.I)("history",{start:e=>Object.assign(Object.assign({},e),{meta:r._V}),success(e,{result:t}){if(!t||200!==t.code)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{suggestLastObjects:[]}),meta:r.rv});const s=(0,n.IJ)(t),a=(0,n.H$)(e.data,s);return{data:{searches:a.searches,suggestLastObjects:a.suggestLastObjects},meta:r.rv}},error:(e,{error:t})=>Object.assign(Object.assign({},e),{meta:(0,r._3)(t)})}))},75750:(e,t,s)=>{s.d(t,{E:()=>r});var a=s(66003);function r(e,t,...s){return(0,a.EH)(e,t,...s)}},46954:(e,t,s)=>{s.d(t,{l:()=>d});var a=s(85608),r=s(75750),n=s(35023);const i=";",c=e=>{if(!e)return{};const t=(0,n.oE)(e.split(i)),s={};for(const e of t)e&&(s[e]=!0);return s};var o=s(4340);const d=(0,r.E)("setFlag",(e=>({cookieApi:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{name:s,value:a}=e,r=t.getStrict("flags"),d=o.IG.local.getItem("flags"),u=d||r;if(r&&!d&&(o.IG.local.setItem("flags",r),t.delete("dg5_flags")),!s)return c(u);const l=((e,t,s)=>{if(!e)return!1===s?void 0:t;const a=(0,n.oE)(e.split(i));if(!s){const e=a.filter((e=>e!==t));if(!e.length)return;return e.join(i)}return a.includes(t)?a.join(i):[...a,t].join(i)})(u,s,a);return yield o.IG.local.setItem("flags",l),c(l)}))))},20368:(e,t,s)=>{s.d(t,{n:()=>o,r:()=>c});var a=s(85608),r=s(75750),n=s(66003),i=s(40194);const c=(0,r.E)("fetchClusteredMarkers",(e=>({webApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return t.clusteredMarkersQuery(Object.assign(Object.assign({},e),{accessToken:a}))})))),o=(0,n.yG)("fetchClusteredMarkers",{start(e,{params:t}){const{searchId:s}=t,a=e[s];return{[s]:{data:a&&a.data,meta:i._V}}},success(e,{params:t,result:s}){const a=t.searchId;return e[a]&&s?200!==s.code?{[a]:{data:void 0,meta:(0,i.IR)(s.code)}}:Object.assign(Object.assign({},e),{[a]:{data:s,meta:i.rv}}):e},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:{data:void 0,meta:(0,i._3)(s)}})})},74351:(e,t,s)=>{s.d(t,{y:()=>r});var a=s(75750);const r=(0,a.E)("fetchProductOffersGroupedByOrg",(e=>({marketApi:t})=>t.getOffersGroupedByOrg(e)));(0,a.E)("fetchProjecMarketCategories",(e=>({marketApi:t})=>t.getProjectCategories(e)))},48648:(e,t,s)=>{s.d(t,{l:()=>o,x:()=>c});var a=s(75750),r=s(66003),n=s(22934),i=s(6494);const c=(0,a.E)("fetchProductOffersWithItems",(e=>({marketApi:t,contextApi:s})=>t.getProductOfferWithItems(Object.assign(Object.assign({},e),{locale:s.get("locale")})))),o=(0,r.uI)("fetchProductOffersWithItems","market",{start(e,{params:t}){const{branchId:s,productIds:a}=t;let r={},c={};return a.forEach((t=>{const a=e.products[t];(null==a?void 0:a.data)||(r=(0,n.vL)(r,t));const o=(0,i.a)(t,s),d=e.offers[o];(null==d?void 0:d.data)||(c=(0,n.vL)(c,o))})),Object.keys(r).length||Object.keys(c).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(r).length&&{products:Object.assign(Object.assign({},e.products),r)}),Object.keys(c).length&&{offers:Object.assign(Object.assign({},e.offers),c)}):e},success(e,{params:t,result:s}){const{branchId:a,productIds:r}=t;let c={},o={};const{items:d,dicts:u}=s;return r.forEach((t=>{var s,r;const l=(0,i.a)(t,a),g=null===(s=e.offers[l])||void 0===s?void 0:s.data,p=null===(r=e.products[t])||void 0===r?void 0:r.data,b=d.find((e=>e.product.id===t));if(!b)return p||(c[t]=void 0),void(g||(o=(0,n.i5)(o,l,{code:404,name:"NotFound",message:"offer not found"})));const{product:O,offer:E}=b;if(p||(c=(0,n.h$)(c,t,{product:O,dicts:u})),!g){const e={productId:t,branchId:a,price:E.price,price_value:E.price_value,currency:E.currency,buttons:null==E?void 0:E.buttons,market_item_actions:E.market_item_actions};o=(0,n.h$)(o,l,e)}})),Object.keys(c).length||Object.keys(o).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(c).length&&{products:Object.assign(Object.assign({},e.products),c)}),Object.keys(o).length&&{offers:Object.assign(Object.assign({},e.offers),o)}):e},error(e,{params:t,error:s}){const{branchId:a,productIds:r}=t;let c={},o={};return r.forEach((t=>{const r=e.products[t];(null==r?void 0:r.data)||(c=(0,n.i5)(c,t,s));const d=(0,i.a)(t,a),u=e.offers[d];(null==u?void 0:u.data)||(o=(0,n.i5)(o,d,s))})),Object.keys(c).length||Object.keys(o).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(c).length&&{products:Object.assign(Object.assign({},e.products),c)}),Object.keys(o).length&&{offers:Object.assign(Object.assign({},e.offers),o)}):e}})},17332:(e,t,s)=>{s.d(t,{N:()=>i,n:()=>c});var a=s(85608),r=s(75750),n=s(5512);const i=(0,r.E)("cancelOrder",(e=>({paymentsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{orderId:a}=e,n=yield s.getToken();if(!n)throw new Error("There is no access_token");return yield t.cancelOrder({locale:r.get("locale"),orderId:a,accessToken:n})})))),c=(0,n.u)("cancelOrder","ordersHistory",{success(e,{params:t}){var s;if(!e.default)return e;const a=((null===(s=e.default.data)||void 0===s?void 0:s.orders)||[]).map((e=>e.id===t.orderId?Object.assign(Object.assign({},e),{status:Object.assign(Object.assign({},e.status),{type:"canceled",flags:{canBeCanceled:!1}})}):e));return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},e.default),{data:{total:a.length,orders:a}})})}})},53544:(e,t,s)=>{s.d(t,{R:()=>o,l:()=>c});var a=s(85608),r=s(22934),n=s(75750),i=s(66003);const c=(0,n.E)("checkoutDelivery",(e=>({paymentsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("There is no access_token");return yield t.checkoutDelivery(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")}))})))),o=(0,i.uI)("checkoutDelivery","deliveryOrder",{start:(e,{params:t})=>(0,r.vL)(e,t.idempotencyKey),success:(e,{params:t,result:s})=>(0,r.h$)(e,t.idempotencyKey,s.result),error:(e,{params:t,error:s})=>(0,r.i5)(e,t.idempotencyKey,s)})},47681:(e,t,s)=>{s.d(t,{C:()=>u,I:()=>d});var a=s(85608),r=s(75750),n=s(66003),i=s(47960),c=s(52973),o=s(24302);const d=(0,r.E)("fetchDeliveryCalculation",(e=>({paymentsApi:t,contextApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){return yield t.getDeliveryCalculation(Object.assign(Object.assign({},e),{locale:s.get("locale")}))})))),u=(0,n.uI)("fetchDeliveryCalculation","cart",{start:(e,{params:t})=>l(e,t,{meta:o._V}),success:(e,{params:t,result:s})=>l(e,t,{data:s,meta:o.rv}),error:(e,{params:t,error:s})=>l(e,t,{meta:(0,o._3)(s)})}),l=(e,t,s)=>{const a=e[i.B];return(null==a?void 0:a.data)?Object.assign(Object.assign({},e),{[i.B]:Object.assign(Object.assign({},a),{data:(0,c.p)(a.data,t.orgId,(e=>Object.assign(Object.assign({},e),{deliveryTimestamp:+new Date,deliveryBuildingId:t.delivery.address.buildingId,delivery:s})))})}):e}},76603:(e,t,s)=>{s.d(t,{M:()=>c,q:()=>d});var a=s(85608),r=s(75750),n=s(66003),i=s(22934);const c=(0,r.E)("fetchOrdersHistory",(()=>({paymentsApi:e,credentialsApi:t,contextApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("There is no access_token");return yield e.getOrders({accessToken:a,locale:s.get("locale")})})))),o="default",d=(0,n.uI)("fetchOrdersHistory","ordersHistory",{start:e=>(0,i.vL)(e,o),success:(e,{result:t})=>(0,i.h$)(e,o,t),error:(e,{error:t})=>(0,i.i5)(e,o,t)})},92533:(e,t,s)=>{s.d(t,{Y:()=>c,e:()=>o});var a=s(85608),r=s(75750),n=s(66003),i=s(24302);const c=(0,r.E)("fetchOrdersShort",(()=>({paymentsApi:e,credentialsApi:t,contextApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("There is no access_token");return yield e.getOrdersShort({accessToken:a,locale:s.get("locale"),type:"active"})})))),o=(0,n.uI)("fetchOrdersShort","user",{start:e=>Object.assign(Object.assign({},e),{shortOrders:Object.assign(Object.assign({},e.shortOrders),{meta:i._V})}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{shortOrders:{data:t.orders,meta:i.rv}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{shortOrders:Object.assign(Object.assign({},e.shortOrders),{meta:(0,i._3)(t)})})})},18290:(e,t,s)=>{s.d(t,{$:()=>o,h:()=>c});var a=s(85608),r=s(75750),n=s(66003),i=s(22934);const c=(0,r.E)("checkoutOrder",(e=>({paymentsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return yield t.checkoutOrder(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")}))})))),o=(0,n.uI)("checkoutOrder","order",{start:(e,{params:t})=>(0,i.vL)(e,t.idempotencyKey),success:(e,{params:t,result:s})=>(0,i.h$)(e,t.idempotencyKey,s.items[0]),error:(e,{params:t,error:s})=>(0,i.i5)(e,t.idempotencyKey,s)})},82036:(e,t,s)=>{s.d(t,{k:()=>i});var a=s(83878),r=s(45317),n=s(19400);const i=(0,a.Mz)([e=>e.data.user.shortOrders.data,(e,t)=>t.orgId],((e,t)=>(0,r.s)({orders:e||[],filterByStatus:n.Dg}).filter((e=>e.firm.orgId===t))))},45317:(e,t,s)=>{function a(e){const{orders:t,filterByStatus:s=[]}=e;return t.length?s.length?t.filter((e=>s.includes(e.status.type))):t:[]}s.d(t,{s:()=>a})},97673:(e,t,s)=>{s.d(t,{_:()=>c,r:()=>o});var a=s(85608),r=s(56624),n=s(75750),i=s(40194);const c="confirm_phone",o=(0,n.E)("confirmPhone",(e=>({credentialsApi:t,authApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("User is not authorized");return s.confirmPhone(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")}))}))),(0,r.I)("user",{start:e=>Object.assign(Object.assign({},e),{phone:{[c]:i._V}}),success:e=>Object.assign(Object.assign({},e),{phone:{[c]:i.rv}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{phone:{[c]:(0,i._3)(t)}})}))},48065:(e,t,s)=>{s.d(t,{C:()=>r.C,r:()=>a.r});var a=s(97673),r=s(43984)},43984:(e,t,s)=>{s.d(t,{C:()=>o,_:()=>c});var a=s(85608),r=s(56624),n=s(75750),i=s(24302);const c="request_code",o=(0,n.E)("requestConfirmationCode",(e=>({credentialsApi:t,authApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("User is not authorized");return s.getPhoneConfirmationCode(Object.assign(Object.assign({},e),{segmentId:e.segmentId||"65573",action:"phone_update",accessToken:a,locale:r.get("locale")}))}))),(0,r.I)("user",{start:e=>Object.assign(Object.assign({},e),{phone:{[c]:i._V}}),success:e=>Object.assign(Object.assign({},e),{phone:{[c]:i.rv}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{phone:{[c]:(0,i._3)(t)}})}))},50978:(e,t,s)=>{s.d(t,{t:()=>i});var a=s(85608),r=s(56624),n=s(40194);const i=(0,s(75750).E)("ENTITY/DELETE_PHOTO",(e=>({photoApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{entityId:a,entityType:r,photoId:n}=e,i=yield s.getToken();if(!i)throw new Error("User is not authorized");return t.deletePhoto({objectId:a,objectType:r,photoId:n,accessToken:i})}))),(0,r.I)("photo",{start(e,{params:t}){if(!e[t.photoId])return e;const s=e[t.photoId];if(!s)return e;const a={data:s.data,meta:Object.assign(Object.assign({},s.meta),{crud:"deleting"})};return Object.assign(Object.assign({},e),{[t.photoId]:a})},success(e,{params:t}){if(!e[t.photoId])return e;const s={};for(const a in e)a!==t.photoId&&(s[a]=e[a]);return s},error(e,{params:t}){if(!e[t.photoId])return e;const s=e[t.photoId];if(!s)return e;const a={data:s.data,meta:n.rv};return Object.assign(Object.assign({},e),{[t.photoId]:a})}}),(0,r.I)("entity",{success(e,{params:t,result:s}){if(200!==s.items[0].code)return e;const a=e.photos[t.entityId];if(!a||!a.data)return e;const r=a.data.items;return r.length?Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.entityId]:{meta:a.meta,data:Object.assign(Object.assign({},a.data),{total:a.data.total-1,items:r.filter((e=>e!==t.photoId))})}})}):e}}),(0,r.I)("entity",{success(e,{params:t,result:s}){if(200!==s.items[0].code||!t.userId)return e;const a=e.photos[t.userId];if(!a||!a.data)return e;const r=a.data.items;return r.length?Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.userId]:{meta:a.meta,data:Object.assign(Object.assign({},a.data),{total:a.data.total-1,items:r.filter((e=>e!==t.photoId))})}})}):e}}))},34540:(e,t,s)=>{s.d(t,{z:()=>d});var a=s(85608),r=s(56624),n=s(40194),i=s(75750),c=s(22934);const o={start:(e,{params:t})=>Object.assign(Object.assign({},e),{photos:(0,c.vL)(e.photos,t.id)}),success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{photos:(0,c.h$)(e.photos,t.id,{items:s.items.map((e=>e.id)),pagesLoaded:t.page||1,total:s.total})}),error(e,{params:t,error:s}){var a;return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.id]:{data:null===(a=e.photos[t.id])||void 0===a?void 0:a.data,meta:(0,n._3)(s)}})})}},d=(0,i.E)("ENTITY/FETCH_PHOTOS",(e=>({photoApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{id:a,type:n,page:i,pageSize:c}=e,o=yield s.getToken(),d=r.get("locale")||"ru",u="branch"===n?"branch":"geo";return yield t.getPhotos({objectId:a,objectType:u,page:i,locale:d,pageSize:c,accessToken:o})}))),(0,r.I)("entity",o),(0,r.I)("photo",{success(e,{params:t,result:s}){if(!s.items.length)return e;const a=s.items.reduce(((s,a)=>{var r;const n=null===(r=e[a.id])||void 0===r?void 0:r.data,i=a.views_count||n&&"views_count"in n&&n.views_count||void 0,o=!a.is_visible&&n&&"status"in n&&n.status?n.status:a.status;return(0,c.h$)(s,a.id,Object.assign(Object.assign({},a),{views_count:i,status:o,object:{id:t.id,type:t.type}}))}),{});return Object.assign(Object.assign({},e),a)}}))},72232:(e,t,s)=>{s.d(t,{v:()=>i});var a=s(85608),r=s(56624),n=s(40194);const i=(0,s(75750).E)("fetchUserPhotos",(e=>({photoApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("No access token");return t.getUserPhotos(Object.assign(Object.assign({},e),{accessToken:a}))}))),(0,r.I)("photo",{success(e,{params:t,result:s}){if(!s.items.length)return e;const a=s.items.reduce(((e,s)=>{const a=Object.assign(Object.assign({},s),{owner:{id:t.userId}});return e[s.id]={data:Object.assign(Object.assign({},a),{object:a.object?{id:a.object.id_str,type:a.object.type}:void 0}),meta:n.rv},e}),{});return Object.assign(Object.assign({},e),a)}}),(0,r.I)("user",{success(e,{params:t,result:s}){const a=t.userId,r=e.photos[a],i=s.items.reduce(((e,t)=>(e.includes(t.id)||e.push(t.id),e)),[]),c=(null==r?void 0:r.data)?r.data.items:[],o=i.filter((e=>-1===c.indexOf(e))),d=1===t.page?[...o,...c]:[...c,...o];return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[a]:{data:{items:d,total:s.total,pagesLoaded:t.page},meta:n.rv}})})},error(e,{params:t,error:s}){const a=t.userId,r=e.photos[a];return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[a]:{data:r&&r.data,meta:(0,n._3)(s)}})})}}))},14524:(e,t,s)=>{s.d(t,{t:()=>d});var a=s(85608),r=s(56624),n=s(6465),i=s(40194),c=s(75750),o=s(22934);const d=(0,c.E)("ENTITY/UPLOAD_PHOTO",(e=>({photoApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{objectId:a,objectType:r,temporaryId:n,file:i,locale:c,regionId:o,albumCode:d,isReplaced:u,isMenuPhoto:l}=e,g=yield s.getToken();if(!g)throw new Error("User is not authorized");const p=(yield t.addPhoto({uid:n,objectId:a,objectType:r,albumCode:d,locale:c,regionId:o,accessToken:g,isReplaced:u,isMenuPhoto:l})).items[0];if(!p.hash||!p.id||p.error)throw{name:p.error&&p.error.type,message:p.error&&p.error.message};return t.uploadPhoto({id:p.id,hash:p.hash,file:i,accessToken:g,objectType:r})}))),(0,r.I)("photo",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.temporaryId]:{data:{uid:t.temporaryId,file:t.file,temporary:!0},meta:i._V}}),success(e,{params:t,result:s}){const a=s.items[0];if(200!==a.code){const s=a.error;return Object.assign(Object.assign({},e),{[t.temporaryId]:Object.assign(Object.assign({},e[t.temporaryId]),{meta:(0,i._3)({name:s.type,message:s.message})})})}return Object.assign(Object.assign({},e),{[t.temporaryId]:{data:Object.assign(Object.assign({},a),{tempId:t.temporaryId}),meta:i.rv},[a.id]:{data:Object.assign(Object.assign({},a),{object:{id:t.objectId,type:t.objectType}}),meta:i.rv}})},error:(e,{params:t,error:s})=>(0,o.i5)(e,t.temporaryId,s)}),(0,r.I)("entity",{success(e,{params:t,result:s}){const a=s.items[0];if(200!==a.code||"profile"===t.objectType)return e;const r=e.photos[t.objectId];if(!r||!r.data)return Object.assign(Object.assign({},e),{photos:(0,o.h$)(e.photos,t.objectId,{items:[a.id],total:1,pagesLoaded:0})});const n=r.data.items;return Object.assign(Object.assign({},e),{photos:(0,o.h$)(e.photos,t.objectId,Object.assign(Object.assign({},r.data),{total:r.data.total+1,items:[a.id,...n]}))})}}),(0,r.I)("photo",{success(e,{params:t,result:s}){const a=s.items[0];if(200!==a.code||"profile"===t.objectType)return e;const r=(0,n.B)(a,{objectType:t.objectType,user:t.user});return t.onSubmitSuccessCallback&&r&&t.onSubmitSuccessCallback({photo:r}),e}}))},39684:(e,t,s)=>{s.d(t,{U:()=>n,Y:()=>i});var a=s(85608),r=s(75750);const n=(0,r.E)("fetchDevices",(()=>({pusherApi:e,credentialsApi:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(!s)throw new Error("There is no access_token");return e.fetchDevices({authToken:s})})))),i=(0,r.E)("pushNotification",(e=>({pusherApi:t,credentialsApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken(),{deviceId:r,title:n,body:i,url:c}=e;if(!a)throw new Error("There is no access_token");const o={authToken:a,deviceId:r,title:n,body:i,url:c};return t.messageMe(o)}))))},50891:(e,t,s)=>{s.d(t,{W:()=>o});var a=s(56624),r=s(75750),n=s(32065),i=s(22934);const c={supermarket:["12127","101979","611","350","373","544","558","363"],education:["683","21044","15287","684","21040","245","15761","687"],kindergarten:["237","110405"],hospital:["201","224","225","203","229","25075","4521","23765","18410","56893","661","12211","4517","16863","226","222","20857","4537","4529","16870"],pharmacy:["207"],sport:["261","267","268","51256","110498"],culture:["193","189","199","200","190","11647","13787","168","51001","10887","51207"],bar:["159"]},o=(0,r.E)("fetchInfrastructure",(e=>({webApi:t,contextApi:s})=>{const{center:a}=e,r=[...c.supermarket,...c.education,...c.kindergarten,...c.hospital,...c.pharmacy,...c.sport,...c.culture,...c.bar];return t.getInfrastructure({center:a,locale:s.get("locale")||"ru_RU",radius:750,rubrIds:r,screen:screen})}),(0,a.I)("realty",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{infrastructure:(0,i.vL)(e.infrastructure,t.buildingId)}),success(e,{params:t,result:s}){const a=("items"in s&&s.items||[]).reduce(((e,t)=>{const s=(0,n.YD)(c).find((e=>!!t.rubr&&c[e].includes(t.rubr)));return s&&e[s].push(t),e}),{supermarket:[],education:[],kindergarten:[],hospital:[],pharmacy:[],sport:[],culture:[],bar:[]});return Object.assign(Object.assign({},e),{infrastructure:(0,i.h$)(e.infrastructure,t.buildingId,a)})},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{infrastructure:(0,i.i5)(e.infrastructure,t.buildingId,s)})}))},19323:(e,t,s)=>{s.d(t,{L:()=>o});var a=s(75750),r=s(56624),n=s(22934),i=s(40194);function c(e){const t=Object.assign({},e);return t.on_map&&delete t.on_map,t}const o=(0,a.E)("fetchRealtyMarkers",(e=>({marketApi:t,contextApi:s})=>{const{categoryId:a,viewpoint:r,filters:n,entityId:i}=e;return t.getRealtyMarkers({category_ids:a,viewpoint:r,locale:s.get("locale")||"ru_RU",filters:c(n),geo_id:i})}),(0,r.I)("realty",{start:(e,{uuid:t})=>Object.assign(Object.assign({},e),{markers:(0,n.vL)(e.markers,"default",t),hashmap:(0,n.vL)(e.hashmap,"default",t)}),success(e,{result:t,uuid:s}){if(!t)return e;if(200!==t.code)return 404===t.code?Object.assign(Object.assign({},e),{markers:(0,n.h$)(e.markers,"default",[],s),hashmap:(0,n.h$)(e.hashmap,"default",{},s)}):Object.assign(Object.assign({},e),{markers:(0,n.i5)(e.markers,"default",new Error(`Api have responded with ${t.code}`),s),hashmap:(0,n.i5)(e.hashmap,"default",new Error(`Api have responded with ${t.code}`),s)});const a=t.items.reduce(((e,t,s)=>(e[t.building_id]=s,e)),{});return Object.assign(Object.assign({},e),{markers:(0,n.h$)(e.markers,"default",t.items,s),hashmap:(0,n.h$)(e.hashmap,"default",a,s)})},error(e,{error:t,uuid:s}){const a={default:{data:[],meta:(0,i._3)(t)}},r={default:{data:{},meta:(0,i._3)(t)}};return Object.assign(Object.assign({},e),{markers:(0,n.i5)(a,"default",t,s),hashmap:(0,n.i5)(r,"default",t,s)})}}))},23102:(e,t,s)=>{s.d(t,{P:()=>i});var a=s(75750),r=s(56624),n=s(22934);const i=(0,a.E)("fetchWalkDistance",(e=>({diskApi:t})=>t.getWalkDistanceData({regionId:e.regionId})),(0,r.I)("walkDistance",{start:(e,{params:t})=>(0,n.vL)(e,t.regionId),success:(e,{result:t,params:s})=>(0,n.h$)(e,s.regionId,t.features),error:(e,{params:t,error:s})=>(0,n.i5)(e,t.regionId,s)}))},11989:(e,t,s)=>{s.d(t,{Bs:()=>n,ir:()=>c,m7:()=>i});var a=s(85608),r=s(75750);const n=(0,r.E)("fetchReviewComments",(e=>({reviewsApi:t,contextApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){return t.getReviewComments(Object.assign(Object.assign({},e),{locale:s.get("locale")||""}))})))),i=(0,r.E)("sendReviewCommentAnswer",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("No access token");return t.sendReviewCommentAnswer(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")||""}))})))),c=(0,r.E)("removeReviewComment",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("No access token");return t.deleteComment(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")||""}))}))))},61582:(e,t,s)=>{s.d(t,{J:()=>a});const a=(0,s(75750).E)("fetchReviewsFacts",(e=>({reviewsApi:t,contextApi:s})=>t.getFacts(Object.assign(Object.assign({},e),{locale:s.get("locale")||""}))))},68494:(e,t,s)=>{s.d(t,{b:()=>c});var a=s(85608),r=s(24302),n=s(19297),i=s(56624);const c=(0,s(75750).E)("CreateReview",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{entityId:a,entityType:i,rating:c,text:o,reviewSourceId:d,photos:u,skipValidation:l}=e,g=yield s.getToken();if(!g)throw new Error("There is no access_token");if(o.length>0&&!l){const{bad_words_warning:e}=yield t.validateReview({text:o,locale:r.get("locale")||""});if(e)throw(0,n.UL)("Отзыв содержит оскорбления или слова, употребление которых может грозить автору ответственностью",e)}return t.createReview({id:a,type:"branch"===i?"branch":"geo",rating:c,text:o,accessToken:g,sourceId:d,photos:u,locale:r.get("locale")||""})}))),(0,i.I)("review",{start(e,{params:t}){const{temporaryId:s,rating:a,text:n}=t,i={data:{id:s,text:n,rating:a,temporary:!0},meta:r._V};return Object.assign(Object.assign({},e),{[s]:i})},success(e,{params:t,result:s}){const{temporaryId:a}=t,n=s.items[0];return n?Object.assign(Object.assign({},e),{[a]:{data:n,meta:r.rv},[n.id]:{data:n,meta:r.rv}}):e},error(e,{params:t,error:s}){const{temporaryId:a}=t,n=e[a];return n&&n.data?Object.assign(Object.assign({},e),{[a]:{data:n.data,meta:(0,r._3)(s)}}):e}}),(0,i.I)("reviewSearch",{success(e,{params:t,result:s}){const{reviewSearchId:a}=t;if(!a)return e;const r=a,n=e[a],i=s.items[0]&&s.items[0].id;if(!n)return e;const c=n.data;if(!c)return e;const o=n.data&&n.data.items||[];return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},n),{data:Object.assign(Object.assign({},c),{items:[i].concat(o),total:c.total+1})})})}}))},36954:(e,t,s)=>{s.d(t,{B:()=>c});var a=s(85608),r=s(19297),n=s(22934),i=s(56624);const c=(0,s(75750).E)("EditReview",(e=>({reviewsApi:t,credentialsApi:s,contextApi:n})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{text:a,skipValidation:i}=e,c=yield s.getToken();if(!c)throw new Error("There is no access_token");if(a.length>0&&!i){const{bad_words_warning:e}=yield t.validateReview({text:a,locale:n.get("locale")||""});if(e)throw(0,r.UL)("Отзыв содержит оскорбления или слова, употребление которых может грозить автору ответственностью",e)}return t.editReview(Object.assign(Object.assign({},e),{accessToken:c,locale:n.get("locale")||""}))}))),(0,i.I)("review",{start:(e,{params:t})=>(0,n.vL)(e,t.id),success(e,{result:t,params:s}){var a;const r=t.items[0],i=(null===(a=e[s.id])||void 0===a?void 0:a.data)||r;return(0,n.h$)(e,s.id,Object.assign(Object.assign({},r),{object:i.object}))},error:(e,{error:t,params:s})=>(0,n.i5)(e,s.id,t)}))},32380:(e,t,s)=>{s.d(t,{u:()=>r});var a=s(85608);const r=(0,s(75750).E)("setReviewLike",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const{id:a,value:n}=e,i=yield s.getToken();if(!i)throw new Error("There is no access_token");return!0===n?t.likeReview({id:a,accessToken:i,locale:r.get("locale")||""}):t.unlikeReview({id:a,accessToken:i,locale:r.get("locale")||""})}))))},64912:(e,t,s)=>{s.d(t,{f:()=>o});var a=s(75750),r=s(56624),n=s(58037),i=s(22934);const c={items:[(0,n.P)("Поесть","eat","110539"),(0,n.P)("АЗС","gasoline_station","18547"),(0,n.P)("Аптеки","pharmacies","207"),(0,n.P)("Гостиницы","hotels","269")],code:200},o=(0,a.E)("fetchDashboard",(e=>({webApi:t})=>"0"===e.regionId?Promise.resolve(c):t.getDashboard(e)),(0,r.I)("rubric",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{dashboard:(0,i.vL)(e.dashboard,t.dashboardId)}),success:(e,{params:t,result:s})=>200===s.code&&s.items&&s.items.length?Object.assign(Object.assign({},e),{dashboard:(0,i.h$)(e.dashboard,t.dashboardId,s.items.filter((e=>e.icon_url&&"112786"!==e.id)))}):e,error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{dashboard:(0,i.i5)(e.dashboard,t.dashboardId,s)})}))},99031:(e,t,s)=>{s.d(t,{G:()=>i});var a=s(75750),r=s(56624);const n=e=>"pseudorubric"===e.type?e.id||e.owner_id:e.id,i=(0,a.E)("fetchRubric",(e=>({webApi:t})=>t.getRubric(e)),(0,r.I)("rubricator",{success(e,{result:t}){if(!t||!t.items)return e;const s=t.items.reduce(((e,t)=>Object.assign(Object.assign({},e),{[n(t)]:t})),{});return Object.assign(Object.assign({},e),{items:Object.assign(Object.assign({},e.items),s)})}}))},44902:(e,t,s)=>{s.d(t,{G:()=>o});var a=s(75750),r=s(56624),n=s(40194),i=s(22934);const c=e=>"pseudorubric"===e.type?e.id||e.owner_id:e.id,o=(0,a.E)("fetchRubricator",(e=>({webApi:t})=>t.getRubricatorList(e)),(0,r.I)("rubricator",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{lists:(0,i.vL)(e.lists,t.key)}),success(e,{params:t,result:s}){if(!s||!s.items)return Object.assign(Object.assign({},e),{lists:Object.assign(Object.assign({},e.lists),{[t.key]:{meta:(0,n.Sw)()}})});const a=s.items.map(c),r=s.items.reduce(((e,t)=>Object.assign(Object.assign({},e),{[c(t)]:t})),{});return Object.assign(Object.assign({},e),{lists:(0,i.h$)(e.lists,t.key,a),items:Object.assign(Object.assign({},e.items),r)})},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{lists:(0,i.i5)(e.lists,t.key,s)})}))},25056:(e,t,s)=>{s.d(t,{Qe:()=>i,wy:()=>c,zP:()=>n});var a=s(35023),r=s(83878);const n=()=>(0,r.Mz)([({key:e})=>e,({state:e})=>e.data.rubricator.lists,({state:e})=>e.data.rubricator.items],((e,t,s)=>{const r=t[e];if(r&&r.data)return(0,a.oE)(r.data.map((e=>s[e])))})),i=e=>t=>t.data.rubricator.items[e],c=e=>t=>t.data.rubricator.lists[e]},35080:(e,t,s)=>{s.d(t,{r:()=>r});var a=s(35023);const r=(e,t,s)=>(0,a.oE)([e,s,t]).join("_")},7246:(e,t,s)=>{s.d(t,{f:()=>n});var a=s(56624),r=s(24302);const n=(0,s(75750).E)("createShortLink",(e=>({shortonizerApi:t})=>t.createShortLink(e.url)),(0,a.I)("shortonizer",{start(e,{params:t}){const s={data:void 0,meta:r._V};return Object.assign(Object.assign({},e),{[t.url]:s})},success(e,{params:t,result:s}){const a={data:s,meta:r.rv};return Object.assign(Object.assign({},e),{[t.url]:a})},error(e,{params:t}){const s=t.url,a=Object.assign({},e);return delete a[s],a}}))},92716:(e,t,s)=>{s.d(t,{m:()=>a});const a=(0,s(75750).E)("fetchTrafficScore",(e=>({trafficApi:t})=>t.trafficScore(e)))},11990:(e,t,s)=>{s.d(t,{q:()=>a});const a=e=>t=>t.data.traffic[e]},82384:(e,t,s)=>{s.d(t,{K:()=>o,y:()=>c});var a=s(85608),r=s(75750),n=s(66003),i=s(24302);const c=(0,r.E)("actualizeUserInfo",(()=>({authApi:e,credentialsApi:t})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(s)return e.getUserInfo({accessToken:s});throw new Error("There is no access token")})))),o=(0,n.yG)("actualizeUserInfo",{success:(e,{result:t})=>({default:{data:Object.assign(Object.assign({},t.data),{access_token:t.access_token}),meta:i.rv}}),error:(e,{error:t})=>({default:{data:void 0,meta:(0,i._3)(t)}})})},7878:(e,t,s)=>{s.d(t,{E:()=>d});var a=s(85608),r=s(9481),n=s(75750),i=s(4340),c=s(47960),o=s(16884);const d=(0,n.E)("clearPersonalData",(e=>({favoritesStorage:t,profileApi:s})=>(0,a.sH)(void 0,void 0,void 0,(function*(){yield Promise.all([t.clearPersonal(),t.clearPlaces(),i.IG.local.removeItem(c.Z),e.doNotClearHistoryInProfileApi?void 0:s.clearSearchHistory(),r.R.removeStore("history","history"),(0,o.O)()])}))))},89781:(e,t,s)=>{s.d(t,{W:()=>n});var a=s(85608),r=s(56624);const n=(0,s(75750).E)("deleteUserProfile",(e=>({authApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken(),n=yield r.get("locale");if(!a)throw new Error("No access token");return t.deleteProfile(Object.assign(Object.assign({},e),{locale:n,accessToken:a}))}))),(0,r.I)("user",{success:e=>Object.assign(Object.assign({},e),{info:{default:void 0}})}),(0,r.I)("photo",{success:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.userId]:void 0})}))},11484:(e,t,s)=>{s.d(t,{B:()=>u,L:()=>o});var a=s(85608),r=s(75750),n=s(66003),i=s(22934),c=s(40194);const o=(0,r.E)("fetchUserReviewsByObject",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("There is no access token in fetchUserReviewsByObject");return t.getUserReviewsByObject(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")||""}))})))),d=(0,n.uI)("fetchUserReviewsByObject","review",{success(e,{result:t}){if(!t.items.length)return e;const s=t.items.reduce(((e,t)=>(e[t.id]={data:t,meta:c.rv},e)),{});return Object.assign(Object.assign({},e),s)}}),u=[(0,n.uI)("fetchUserReviewsByObject","user",{start:(e,{params:{entityId:t}})=>Object.assign(Object.assign({},e),{pinnedReviews:(0,i.vL)(e.pinnedReviews,t)}),error:(e,{params:{entityId:t},error:s})=>Object.assign(Object.assign({},e),{pinnedReviews:(0,i.i5)(e.pinnedReviews,t,s)}),success(e,{params:{entityId:t},result:s}){var a;const r=(null===(a=s.items[0])||void 0===a?void 0:a.id)?[s.items[0].id]:[],n=s.total?c.rv:(0,c.Sw)();return Object.assign(Object.assign({},e),{pinnedReviews:Object.assign(Object.assign({},e.pinnedReviews),{[t]:{data:{items:r,total:s.total},meta:n}})})}}),d]},8483:(e,t,s)=>{s.d(t,{b:()=>o});var a=s(85608),r=s(75750),n=s(56624),i=s(40194);const c="default",o=(0,r.E)("updateUserInfo",(e=>({authApi:t,credentialsApi:s,contextApi:r})=>(0,a.sH)(void 0,void 0,void 0,(function*(){var a,n;const i=yield s.getToken();if(i)return t.updateUserInfo(Object.assign(Object.assign({accessToken:i,locale:r.get("locale")},e),{userInfo:Object.assign(Object.assign({},e.userInfo),{public_identity_accepted:null===(n=null===(a=e.userInfo)||void 0===a?void 0:a.public_identity_accepted)||void 0===n?void 0:n.toString()})}));throw new Error("There is no access token")}))),(0,n.I)("user",{success:(e,{result:t})=>Object.assign(Object.assign({},e),{info:{[c]:{data:t,meta:i.rv}}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{info:{[c]:{data:void 0,meta:(0,i._3)(t)}}})}))},94521:(e,t,s)=>{var a;s.d(t,{f:()=>a}),function(e){e.jpeg="jpeg",e.jpg="jpg",e.png="png",e.bmp="bmp",e.webp="webp",e.gif="gif"}(a||(a={}))},10866:(e,t,s)=>{s.d(t,{PR:()=>d});var a=s(85608),r=s(31085),n=s(14041),i=s(24645),c=s(41929);const o=n.createContext({});function d(){const e=o;return{withFormatter:(t=e,function(e,s=g){return function(n){return i=>{const{render:c}=i,o=(0,a.Tt)(i,["render"]),[d,u]=l(e,o,t);if(void 0===u&&void 0===d)return null;const g=u?s(u):(0,r.jsx)(n,Object.assign({},o,d));return c?c(g):g}}}),FormatterProvider:e.Provider,useFormatter:u(e),FormatterContextConsumer:e.Consumer};var t}function u(e){return function(t,s){const a=l(t,s,e);return a[1]&&p(a[1]),a[0]}}function l(e,t,s){const a=n.useContext(s);return(0,c.Y)((()=>{try{return[e(t,a),void 0]}catch(e){return e instanceof class{constructor(e){this.self=e}}?[void 0,e.self]:[void 0,{status:"error",error:e instanceof Error?e:new Error(`Unknown formatter error ${(0,i.u)(e)}`)}]}}),[t])}const g=e=>{p(e)};new Error("Formatter failed");function p(e){if("loading"===e.status)throw new Error("Unexpected loading placeholder");throw e.error}},50432:(e,t,s)=>{s.d(t,{vV:()=>o,s2:()=>d});var a=s(35023),r=s(9639);function n(e){const{message:t,level:s,id:a,payload:r,ip:n,sessionId:i,userId:c,userAgent:o,requestId:d,namespace:u,url:l,noCropValues:g}=e;return Object.assign({message:t,level:s,log_id:a,remote_addr:n,user_id:c,session_id:i,request_id:d,http_user_agent:o,request_uri:l,noCropValues:g},function(e,t){const s=Object.keys(e),a={};for(const r of s)a[`${t}.${r}`]=e[r];return a}(r,u))}function i(e){const t=n(e),s=(0,a.cJ)(t,["user_id","remote_addr","http_user_agent","session_id"]);(0,r.I)(Object.assign(Object.assign({},s),{environment:"client"}))}function c(e){const t=n(e);(0,r.a)(Object.assign(Object.assign({},t),{environment:"server"}))}function o(e){return"undefined"==typeof window?c(Object.assign(Object.assign({},e),{namespace:"error"})):i(Object.assign(Object.assign({},e),{namespace:"error"}))}function d(e){return"undefined"==typeof window?c(Object.assign(Object.assign({},e),{namespace:"perf"})):i(Object.assign(Object.assign({},e),{namespace:"perf"}))}},24302:(e,t,s)=>{s.d(t,{_3:()=>a._3,_V:()=>a._V,rv:()=>a.rv});var a=s(40194)},37215:(e,t,s)=>{function a(e){if(e&&4===e.length)return e.map((e=>({lat:e.latitude,lon:e.longitude})))}s.d(t,{oR:()=>a}),s(59954),s(35023),s(54375)},54375:(e,t,s)=>{function a({hash:e,entityId:t}){return[e,t].join("_")}s.d(t,{D:()=>a}),s(50432)},76428:(e,t,s)=>{function a(){return{emitEvent:e=>({type:"EVENT/EMIT",payload:e,event:!0}),addEventListener:e=>({type:"EVENT/ADD_LISTENER",payload:e,event:!0}),removeEventListener:e=>({type:"EVENT/REMOVE_LISTENER",payload:e,event:!0})}}s.d(t,{m:()=>a})},69985:(e,t,s)=>{s.d(t,{E:()=>r,Z:()=>n});var a=s(12017);const r=0;function n(){let e=[];return t=>s=>n=>{if(n){if(!n.event)return s(n);if("EVENT/EMIT"===n.type){const s=[];for(const a of e){if(a.type!==n.payload.type)continue;const e=a.handler(n.payload.event,t.getState());if(e&&(s.push(e),a.stopIfHandled))break}return t.dispatch((0,a._7)(...s))}"EVENT/ADD_LISTENER"!==n.type?"EVENT/REMOVE_LISTENER"===n.type&&(e=e.filter((e=>e.id!==n.payload.id))):e=function(e,t,s){const a=function(e,t){for(let s=0;s<e.length;s++)if(t>=(e[s].priority||-1/0))return s;return e.length}(e,t.priority||s);return[...e.slice(0,a),t,...e.slice(a)]}(e,n.payload,r)}}}},89979:(e,t,s)=>{s.d(t,{P:()=>i});var a=s(35023);let r="",n=!1;const i=(e,t)=>({windowApi:s,analyticsApi:i})=>c=>{const o=e(c.getState());s.historyReplace(o.historyState,o.url||"");let d=c.getState();const u=(0,a.sg)((t=>{var a;const{historyState:c,url:o}=e(t,d);if(o&&(s.historyReplace(c,o),n)){const e=null===(a=s.location)||void 0===a?void 0:a.pathname;e&&r!==e&&(i.trackPageview(),r=e)}d=t}),333);return e=>a=>{var i;return"turnAutoPageViewOn"===a.type?(n=t.analyticsAutoTrackPageview,void(r=(null===(i=s.location)||void 0===i?void 0:i.pathname)||"")):"object"!=typeof a?e(a):(e(a),void u(c.getState()))}}},30345:(e,t,s)=>{s.d(t,{K2:()=>n,Ns:()=>r,Rn:()=>i});var a=s(35023);function r(e,t){return e&&e.data?{data:Object.assign(Object.assign({},e.data),t.data),meta:t.meta}:t}function n(e,t){return e?Object.assign(Object.assign({},e),t):t}function i(e){return"branch"!==e.type?e:(0,a.cJ)(e,["ads","context","hash","stat"])}},74006:(e,t,s)=>{s.d(t,{Ay:()=>o,Dc:()=>n,H$:()=>p,IJ:()=>d});var a=s(85608),r=s(76127);const n=20,i=["branch","building","station","adm_div","attraction"],c={data:{searches:[],suggestLastObjects:[]}};function o(e=c,t){switch(t.type){case"USER/LOAD_HISTORY_SUCCESS":return function({payload:e}){return{data:e}}(t);case"USER/ADD_HISTORY_OBJECT":return function(e,{payload:t}){const{entity:s,timestamp:a,text:r}=t,i={type:"history",entity:s,text:r,timestamp:a};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{searches:O(e.data.searches,[i],n)})})}(e,t);case"USER/ADD_HISTORY_SEARCH":return function(e,{payload:t}){const{query:s,timestamp:a}=t,r={type:"history",text:s,timestamp:a};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{searches:O(e.data.searches,[r],n)})})}(e,t);case"USER/CLEAR_HISTORY":return c;default:return e}}function d(e){const{searches:t,suggester_picked_objects:s,last_objects:a}=e,n=(0,r.h)(a,(e=>e.id));return{searches:[...t.map(u),...s.map(l)],suggestLastObjects:n.filter((e=>i.includes(e.type))).map(g)}}function u(e){const{text:t,timestamp:s}=e;return{type:"history",text:t,timestamp:s}}function l(e){const{timestamp:t}=e;return{type:"history",entity:(0,a.Tt)(e,["timestamp"]),timestamp:t}}function g(e){const{timestamp:t}=e;return{type:"history",entity:(0,a.Tt)(e,["timestamp"]),timestamp:t}}function p(e,t){return{searches:O(e.searches,t.searches,n),suggestLastObjects:O([],t.suggestLastObjects,100)}}function b(e){return(e.entity?e.entity.id:e.text&&e.text.toLowerCase())||""}function O(e,t,s){const a={};e.forEach((e=>{const t=b(e);t&&(a[t]=e)}));let r=!1;if(t.forEach((e=>{const t=b(e);t&&(a[t]?e.timestamp>a[t].timestamp&&(a[t]=e,r=!0):(a[t]=e,r=!0))})),!r)return e;const n=Object.keys(a).map((e=>a[e]));return n.sort(((e,t)=>e.timestamp<t.timestamp?1:-1)),n.slice(0,s)}},70716:(e,t,s)=>{s.d(t,{h:()=>a});const a=e=>{return t=(null==e?void 0:e.user_id)||"",e=>e.data.user.achievements[t];var t}},394:(e,t,s)=>{s.d(t,{q:()=>r});var a=s(47960);const r=e=>{var t;return null===(t=e.data.cart[a.B])||void 0===t?void 0:t.data}},45302:(e,t,s)=>{s.d(t,{W4:()=>n,cy:()=>i,l4:()=>r});var a=s(56190);const r=({state:e,searchId:t})=>e.data.directions[t],n=e=>t=>t.data.directionsPpnotTypes[e]||a.d,i=({searchId:e,directionId:t})=>s=>{const a=r({state:s,searchId:e});if(a&&a.data)switch(a.data.type){case"pedestrian":case"ppna":case"ppng":case"ppnot":return a.data.items.find((e=>e.id===t));default:return}}},46287:(e,t,s)=>{s.d(t,{DE:()=>l,Dg:()=>O,H$:()=>E,JC:()=>b,SK:()=>g,Sf:()=>v,Sk:()=>o,Tq:()=>u,YH:()=>f,eJ:()=>d,g7:()=>h,pT:()=>m,t6:()=>y,tx:()=>_});var a=s(66333),r=s(56190),n=s(35023),i=s(56803),c=s(59954);const o=({state:e,entityId:t,searchId:s})=>{const a=y({id:t,searchId:s});return e.data.searchContext[a]},d=()=>(0,a.Mz)([({state:e,entityId:t})=>e.data.entity.profile[t],o],((e,t)=>e?e.data&&t?{data:Object.assign(Object.assign({},e.data),t),meta:e.meta}:e:r.d)),u=d(),l=({state:e,entityId:t})=>e.data.entity.profile[t]||r.d,g=(0,a.Mz)([({state:e,entityId:t})=>l({state:e,entityId:t})],(e=>{var t;return null===(t=e.meta)||void 0===t?void 0:t.status})),p=()=>(0,a.Mz)([({state:e,entityId:t})=>e.data.entity.photos[t]],(e=>e||r.d)),b=p(),O=()=>(0,a.Mz)([p(),({state:e})=>e.data.photo],((e,t)=>e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.t2)})}):{data:void 0,meta:e.meta})),E=O(),h=(0,a.Mz)([({state:e,entityId:t})=>e.data.entity.video?e.data.entity.video[t]:void 0],(e=>e||r.d)),f=({state:e,searchId:t})=>e.data.reviewSearch[t]||r.d,m=()=>(0,a.Mz)([f,({state:e})=>e.data.review],j);function j(e,t){return e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.t2)})}):{data:void 0,meta:e.meta}}const v=(0,a.Mz)([({state:e,entityId:t})=>e.data.entity.discounts[t]],(e=>e||r.d));function y(e){return e.searchId?`${e.searchId}_${e.id}`:e.id}function _({state:e,searchId:t,entityId:s}){let a=s;if(!a){const s=(0,i.mF)({state:e,searchId:t,page:1});a=s&&s.data&&s.data[0]}return a&&a!==c.K0?l({state:e,entityId:a}):r.d}},84082:(e,t,s)=>{s.d(t,{NJ:()=>h,OZ:()=>E,TH:()=>v,Wu:()=>O,ai:()=>y,b1:()=>l,cB:()=>g,cE:()=>j,nq:()=>p,xM:()=>b});var a=s(83878),r=s(32065),n=s(21788),i=s(61165),c=s(85512),o=s(10522),d=s(15401),u=s(73766);const l=e=>e.data.favoritesPersonal.objects,g=(0,a.Mz)(l,(e=>{const t={};return(0,r.sm)(e).forEach((e=>{e&&"favorite"===e.type&&e.collection_id&&(t[e.collection_id]=t[e.collection_id]||[]).push(e)})),t})),p=e=>t=>{const s=l(t)[e];return b(s)?s:void 0};function b(e){return!!e&&"collection"===e.type}const O=e=>t=>{const s=l(t)[e];return E(s)?s:void 0};function E(e){return!!e&&"favorite"===e.type}function h(e){return"0"!==e.data.favoritesPersonal.sync.lastSync}function f(e,t){return e||(0,c.F)(t)&&(0,n.R)(t)}const m=(0,a.Mz)(l,(e=>{const t={};return(0,r.sm)(e).forEach((e=>{if(e&&"favorite"===e.type&&e.collection_id){const s=e.point||e.source_point,a=f(e.object_id,s);a&&(t[a]||(t[a]=[])).push(e)}})),t})),j=e=>t=>{const s=f("point"===e.object_type?void 0:e.object_id,e.point);return!!s&&(m(t)[s]||[]).some((t=>(0,i.K)(t,e)))},v=e=>(0,a.Mz)([o.cd,o.cU],((t,s)=>!(!e.point||!(0,d.b)(e.point,null==t?void 0:t.point)&&!(0,d.b)(e.point,null==s?void 0:s.point))||e.object_id===(null==t?void 0:t.object_id)||e.object_id===(null==s?void 0:s.object_id))),y=(0,a.Mz)(l,(e=>Object.values(e).reduce(((e,t)=>{if("collection"===(null==t?void 0:t.type)&&t.collection_id){const s=(0,u.si)(t.collection_id,t.color);e.push(s)}return e}),[])))},10522:(e,t,s)=>{s.d(t,{cU:()=>c,cd:()=>i,to:()=>n});var a=s(66333),r=s(32065);const n=e=>e.data.favoritesPlaces.objects,i=(0,a.Mz)([n],(e=>(0,r.sm)(e).find((e=>"home"===(null==e?void 0:e.place_type))))),c=(0,a.Mz)([n],(e=>(0,r.sm)(e).find((e=>"work"===(null==e?void 0:e.place_type)))))},96863:(e,t,s)=>{s.d(t,{Bv:()=>l,YG:()=>g,Zk:()=>p,g7:()=>E,iP:()=>u,uN:()=>O,vu:()=>d});var a=s(83878),r=s(32065),n=s(59954),i=s(96891),c=s(82393);const o=e=>e.data.favoritesPublic.objects,d=(0,a.Mz)(o,(e=>{const t={};return(0,r.sm)(e).forEach((e=>{e&&"favorite"===e.type&&e.collection_id&&(t[e.collection_id]=t[e.collection_id]||[]).push(e)})),t})),u=e=>(0,a.Mz)((t=>d(t)[e]),(e=>e?(0,i.q)(e):n.Ml)),l=(0,a.Mz)(o,(e=>{const t=(0,r.sm)(e),s=[],a=[],i=[];t.forEach((e=>b("interesting",e)?s.push(e):b("guidebook",e)?a.push(e):b("awards2019",e)?i.push(e):void 0));const c=(t,s)=>{const a=s&&s.collections?s.collections.reduce(((t,s)=>{const a=e[s];return t.push(a),t}),[]):n.Ml;return t.push(...a),t};return{interestingList:s.reduce(c,[]),guidebookList:a.reduce(c,[]),awards2019:i.reduce(c,[])}})),g=e=>t=>{const s=o(t)[e];return(a=s)&&"collection"===a.type?s:void 0;var a},p=e=>t=>{const s=o(t)[e];return(a=s)&&"favorite"===a.type?s:void 0;var a},b=(e,t)=>!!t&&"theme"===t.type&&t.code===e;function O(e){return"0"!==e.data.favoritesPublic.sync.lastSync}const E=e=>(0,a.Mz)([e=>e.data.favoritesPublic.objects,c.MJ],((t,s)=>(0,r.sm)(t).find((t=>!(!t||"theme"!==t.type||t.code!==e||!s&&t.project_id||s&&t.project_id&&!t.project_id.includes(s))))))},26289:(e,t,s)=>{s.d(t,{F:()=>r,o:()=>a});const a=({state:e,filtersId:t})=>e.data.filters[t],r=e=>t=>{const s=t.data.filters[e];return s&&s.filters&&s.filters.attributes}},4592:(e,t,s)=>{s.d(t,{F:()=>a});const a=({state:e,gtaId:t})=>e.data.gta[t]},56762:(e,t,s)=>{s.d(t,{q:()=>r});var a=s(56190);const r=e=>e.data.history||a.d},97980:(e,t,s)=>{s.d(t,{EM:()=>O,HH:()=>E,LW:()=>d,LY:()=>h,S2:()=>l,a2:()=>g,dD:()=>o,gt:()=>b,i7:()=>u,o5:()=>p,z5:()=>c});var a=s(66333),r=s(56190),n=s(16106),i=s(6494);const c=({state:e,productId:t})=>e.data.market.products[t]||r.d,o=({state:e,id:t})=>e.data.market.categories[t]||r.d,d=({state:e,searchId:t})=>e.data.market.offersSearch.profile[t]||r.d,u=({state:e,searchId:t})=>e.data.market.offersSearch.pagination[t],l=(0,a.Mz)([d,u],((e,t)=>e?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,n.l)(t)})}):r.d)),g=({state:e,productId:t,branchId:s})=>e.data.market.offers[(0,i.a)(t,s)]||r.d,p=({state:e,filtersId:t})=>e.data.market.filters[t]||r.d,b=({state:e,searchId:t})=>e.data.market.suggestions[t]||r.d,O=({state:e,searchId:t})=>e.data.market.offersByOrgSearch.profile[t],E=(0,a.Mz)([O,({state:e,searchId:t})=>e.data.market.offersByOrgSearch.pagination[t]],((e,t)=>{if(e)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,n.l)(t)})})}));function h(e){return`project${e}`}},56190:(e,t,s)=>{s.d(t,{d:()=>a});const a={data:void 0,meta:void 0}},35350:(e,t,s)=>{s.d(t,{n:()=>n});var a=s(66333),r=s(56190);const n=(0,a.Mz)([({state:e,id:t})=>e.data.photo[t]],(e=>e||r.d))},34179:(e,t,s)=>{s.d(t,{H:()=>r,v:()=>a});const a=e=>t=>{var s;return e&&(null===(s=t.data.realty.infrastructure[e])||void 0===s?void 0:s.data)||void 0},r=e=>e.data.walkDistance||void 0},52160:(e,t,s)=>{s.d(t,{Zh:()=>c,b7:()=>i,kB:()=>d});var a=s(32065),r=s(66333),n=s(18310);const i=({state:e,id:t})=>e.data.region.profile[t],c=({state:e,id:t})=>e.data.region.detector[t],o=e=>c({state:e,id:"default"}),d=((0,r.Mz)([e=>{var t;return null===(t=e.data.settlements.default)||void 0===t?void 0:t.data}],(e=>e?(0,a.sm)((0,n.O)(e)):void 0)),e=>{var t,s,a,r,n;return(null===(t=(e=>{var t,s,a;return(a=(null===(s=null===(t=o(e))||void 0===t?void 0:t.data)||void 0===s?void 0:s.id)||"",e=>{var t,s;return null===(s=null===(t=e.data.settlements.default)||void 0===t?void 0:t.data)||void 0===s?void 0:s[a]})(e)})(e))||void 0===t?void 0:t.alias)||(null===(n=null===(r=i({state:e,id:(null===(a=null===(s=o(e))||void 0===s?void 0:s.data)||void 0===a?void 0:a.regionId)||""}))||void 0===r?void 0:r.data)||void 0===n?void 0:n.uri_code)||""})},1364:(e,t,s)=>{s.d(t,{Ly:()=>i,X0:()=>n,xW:()=>r});var a=s(56190);const r=({state:e,id:t})=>e.data.review[t]||a.d,n=(e,t)=>e.data.reviewComments[t]||a.d,i=e=>t=>t.data.factsFilters[e]||a.d},75433:(e,t,s)=>{s.d(t,{l:()=>n});var a=s(66333),r=s(56190);const n=({state:e,dashboardId:t})=>e.data.rubric.dashboard[t]||r.d;(0,a.Mz)([({state:e,rubricatorId:t})=>e.data.rubric.rubricator[t]],(e=>e||r.d))},5096:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(66333),r=s(56190),n=s(16106);const i=(0,a.Mz)([({state:e,searchId:t})=>e.data.search.profile[t],({state:e,searchId:t})=>e.data.search.pagination[t]],((e,t)=>e?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,n.l)(t)})}):r.d))},56803:(e,t,s)=>{s.d(t,{Fs:()=>n,Iv:()=>c,dV:()=>d,mF:()=>i,nJ:()=>u,s8:()=>o});var a=s(66333),r=s(56190);const n=({state:e,searchId:t})=>t&&e.data.search.pagination[t]||void 0,i=({state:e,searchId:t,page:s})=>{const a=n({state:e,searchId:t});return a&&a[s]},c=({state:e,searchId:t})=>t&&e.data.search.markers[t]||void 0,o=({state:e,searchId:t})=>t&&e.data.search.profile[t]||r.d,d=(0,a.Mz)([({state:e,searchId:t})=>n({state:e,searchId:t})],(e=>{const t=e&&e[1];if(t)return t.data[0]})),u=({state:e,searchId:t})=>{const s=i({state:e,searchId:t,page:1});return s&&s.data[0]}},65454:(e,t,s)=>{s.d(t,{F:()=>r});var a=s(56190);const r=e=>e.data.history||a.d},56765:(e,t,s)=>{s.d(t,{Y:()=>n});var a=s(66333),r=s(56190);const n=(0,a.Mz)([({state:e,url:t})=>e.data.shortonizer[t]],(e=>e||r.d))},46234:(e,t,s)=>{s.d(t,{V:()=>a});const a=(0,s(66333).Mz)([({state:e,statusId:t})=>e.status[t]],(e=>e))},12762:(e,t,s)=>{s.d(t,{J:()=>o,p:()=>g});var a=s(83878),r=s(84082),n=s(32065),i=s(56190),c=s(10522);const o=({state:e,searchId:t})=>e.data.objectSuggestions[t]||i.d;function d(e){if(!e)return;const{object_type:t,object_id:s}=e;return s&&t?{type:"place_type"in e?e.place_type:e.type,record:{id:s,type:t}}:void 0}function u(e){const{id:t,type:s,count:a,objectType:r,timestamp:n}=e;return{type:s,count:a,last_used:n,record:{id:t,type:r}}}const l=(0,a.Mz)(r.b1,(e=>(0,n.sm)(e).filter(r.OZ).reduce(((e,t)=>{const s=d(t);return s?[...e,s]:e}),[]))),g=(0,a.Mz)([e=>(e=>e.data.profile||i.d)(e),e=>(0,c.cd)(e),e=>(0,c.cU)(e),e=>l(e)],((e,t,s,a)=>{const{historyObjects:r,homeWorkObjects:n,suggestLastObjects:i}=e.data,c=i.map((e=>{const{id:t,timestamp:s}=e;return{type:"personal_poi",last_used:s,record:{id:t,type:"subtype"in e?`${e.type}.${e.subtype}`:e.type}}})),o=[...r,...n].reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.type]:[...e[t.type]||[],u(t)]})),{}),{history:l=[],supposed_home:g=[],supposed_other:p=[],supposed_work:b=[]}=o,O=d(t),E=d(s);return[...l,...O?[O]:[],...c,...a,...p,...E?[E]:[],...g,...b].slice(0,200)}))},21959:(e,t,s)=>{s.d(t,{Bj:()=>v,LE:()=>f,Us:()=>h,VO:()=>I,Wc:()=>T,ZE:()=>u,Z_:()=>d,hq:()=>o,kR:()=>j,oG:()=>m,rN:()=>_,sX:()=>E,ug:()=>b,uk:()=>p,vY:()=>S,x3:()=>O,yx:()=>y,zL:()=>l});var a=s(66333),r=s(56190),n=s(35023),i=s(35383),c=s(96690);(0,a.Mz)([({state:e,userId:t})=>e.data.user.info[t]],(e=>e||r.d));const o=(0,a.Mz)([({state:e,userId:t})=>e.data.user.photos[t]],(e=>e||r.d)),d=(0,a.Mz)([o,({state:e})=>e.data.photo],((e,t)=>e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.t2)})}):{meta:e.meta})),u=(0,a.Mz)([({state:e,userId:t})=>e.data.user.reviews[t]],(e=>e||r.d)),l=(0,a.Mz)([u,({state:e})=>e.data.review],(function(e,t){return e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.t2)})}):{data:void 0,meta:e.meta}}));(0,a.Mz)([({state:e})=>e.data.user.anonymousUser.feedbacksCount],(e=>e||0));const g=(0,a.Mz)([({state:e,userId:t})=>e.data.user.feedbacks[t]],(e=>e||r.d)),p=(0,a.Mz)([g,({state:e})=>e.data.feedback],(function(e,t){return e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items?e.data.items.map((e=>t[e])).filter(n.t2):[]})}):{data:void 0,meta:e.meta}})),b=e=>e.data.user.info.default||r.d,O=e=>(0,i.o)(b(e)),E=e=>(0,c.b)(b(e)),h=e=>!O(e)&&!E(e),f=e=>{const t=b(e);return t&&t.data&&t.data.user_id},m=e=>e.data.user.devices,j=e=>t=>t.data.user.pinnedReviews[e]||r.d,v=e=>t=>{var s,a;return null===(a=null===(s=t.data.user.pinnedReviews[e])||void 0===s?void 0:s.data)||void 0===a?void 0:a.items[0]},y=e=>t=>{const s=v(e)(t);if(s)return t.data.review[s]},_=e=>e.data.user.friendsActivities.default||r.d,S=e=>{var t,s;const a=b(e);return!(!(null===(t=a.data)||void 0===t?void 0:t.phone_number)||!(null===(s=a.data)||void 0===s?void 0:s.phone_number_confirmed))},I=e=>{const t=e.data.user.activities.default||r.d;return null==t?void 0:t.data},T=e=>e.data.user.chronologyPlaces.default||r.d},89697:(e,t,s)=>{s.d(t,{y:()=>a});const a=(e,t)=>{var s,a;const r=null===(a=null===(s=e.data.user.info.default)||void 0===s?void 0:s.data)||void 0===a?void 0:a.public_identity_accepted,n=t?r:void 0;return!0===n||void 0===n?"agreed":null===n?"idle":"declined"}},19878:(e,t,s)=>{function a(e){return!!e&&!!e.meta&&"error"===e.meta.status}function r(e,t){return!(!e||!a(e))&&e.meta.code===t}s.d(t,{b:()=>a,u:()=>r})},16106:(e,t,s)=>{function a(e){return e?Object.keys(e).sort(((e,t)=>+e-+t)).reduce(((t,s)=>{const a=e[s];return a&&a.data?[...t,...a.data]:t}),[]):[]}s.d(t,{l:()=>a})},96690:(e,t,s)=>{function a(e){return!!e&&!!e.meta&&"error"===e.meta.status}s.d(t,{b:()=>a})},63e3:(e,t,s)=>{function a(e){return!e||!e.data}s.d(t,{b:()=>a})},95280:(e,t,s)=>{s.d(t,{P:()=>n});var a=s(63e3),r=s(10232);function n(e){return(0,a.b)(e)&&!(0,r.VP)(e)}},14908:(e,t,s)=>{function a(e){return!e||!e.data&&!e.meta}s.d(t,{$:()=>a})},35383:(e,t,s)=>{s.d(t,{o:()=>r});var a=s(14908);function r(e){return!(0,a.$)(e)&&!!e.meta&&"success"===e.meta.status}},10232:(e,t,s)=>{s.d(t,{Nm:()=>n,Qp:()=>i,VP:()=>r});var a=s(63e3);function r(e){return!!e&&!!e.meta&&"loading"===e.meta.status}function n(e){return(0,a.b)(e)&&r(e)}function i(e){return!(0,a.b)(e)&&r(e)}},96891:(e,t,s)=>{s.d(t,{q:()=>r});var a=s(35023);function r(e,t){return e.slice().sort(((e,s)=>{if(t){if(e.project_id&&e.project_id.includes(t)&&(!s.project_id||!s.project_id.includes(t)))return-1;if(s.project_id&&s.project_id.includes(t)&&(!e.project_id||!e.project_id.includes(t)))return 1}return(0,a.O9)(s.order)&&(0,a.O9)(e.order)?s.order-e.order:0}))}},68520:(e,t,s)=>{s.d(t,{$:()=>Qt});var a=s(14848),r=s(54375),n=s(35023);const i={searchEvent:{},event:{},serverEvents:[]};function c(e=i,t){switch(t.type){case"_BSS_SAVE_EVENT_ATTRS":return function(e,t){const s=(0,r.D)({entityId:t.entityId,hash:t.chainId});return Object.assign(Object.assign({},e),{event:Object.assign(Object.assign({},e.event),{[s]:t.eventAttrs})})}(e,t.payload);case"_BSS_SAVE_SEARCH_EVENT_ATTRS":return function(e,t){return Object.assign(Object.assign({},e),{searchEvent:Object.assign(Object.assign({},e.searchEvent),{[t.chainId]:t.eventAttrs})})}(e,t.payload);case"_BSS_SET_SERVER_EVENTS":return function(e,t){return Object.assign(Object.assign({},e),{serverEvents:t.events})}(e,t.payload);case"BSS/REPLACE_CHAIN_ID":return function(e,t){const s={};(0,n.jJ)(e.searchEvent,(e=>{const a=t[e.chainId]||e.chainId;s[a]=Object.assign(Object.assign({},e),{chainId:a})}));const a=e.serverEvents.map((e=>{if(!e.add.hash||!t[e.add.hash])return e;const s=t[e.add.hash];return Object.assign(Object.assign({},e),{add:Object.assign(Object.assign({},e.add),{hash:s})})}));return Object.assign(Object.assign({},e),{searchEvent:s,serverEvents:a})}(e,t.payload);default:return e}}var o=s(47458),d=s(40194);const u={unclassified:0,recovery:1,discovery:2,geo:3,transport:7,orgExtension:9,discovery_without_rubric:9,fictive:19};var l,g;!function(e){e[e.Bc=1]="Bc",e[e.Imp=2]="Imp",e[e.Search=3]="Search",e[e.Launch=5]="Launch",e[e.Video=9]="Video",e[e.Commercial=14]="Commercial"}(l||(l={})),function(e){e.Start="start",e.Replay="replay",e.Finish="finish",e.Close="close"}(g||(g={}));const p={};function b(e){switch(e){case"branch":return u.recovery;case"station":case"station_platform":case"station_entrance":case"route":return u.transport;default:return u.geo}}const O={};function E(e){return e.map((e=>e.id))}var h=s(20368);const f=(0,a.HY)({profile:function(e=p,t){switch(t.type){case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_PROVIDERS":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":case"SEARCH/BY_BUILDING_ID":case"SEARCH/IN_BUILDING_BY_QUERY":case"SEARCH/FETCH_MAINTAINERS":case"ENTITY/FETCH_BY_POINT":case"SEARCH/FETCH_PARKINGS_AROUND":case"ENTITY/FETCH_PROFILE_NO_TYPE":return function(e,t,s){const a=t.searchId;if(!a)return e;const r=e[a],n=t;return n.more&&r?Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{meta:d._V})}):r?e:Object.assign(Object.assign({},e),{[a]:{data:{query:n.query,rubrId:n.rubrId,buildingId:n.buildingId,filters:n.filters,orgId:n.orgId,searchSourceType:s,sender:n.sender},meta:d._V}})}(e,t.payload,{"SEARCH/FETCH_QUERY":"query","SEARCH/FETCH_FILIALS":"filial","SEARCH/BY_BUILDING_ID":"firmsInBuilding","SEARCH/IN_BUILDING_BY_QUERY":"firmsInBuilding","SEARCH/FETCH_MAINTAINERS":"maintainers","SEARCH/FETCH_PROVIDERS":"providers","SEARCH/FETCH_RUBRIC":"rubric","SEARCH/FETCH_ATTRIBUTE":"attribute","ENTITY/FETCH_BY_POINT":"searchByPoint","ENTITY/FETCH_PROFILE_NO_TYPE":"fetchProfile","SEARCH/FETCH_PARKINGS_AROUND":"parking"}[t.type]);case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t){const{meta:s,payload:a}=t,r=s.searchId;if(!r)return e;const n=e[r];if(!n||n.data&&n.data.searchType)return e;if(!a||200!==a.code)return Object.assign(Object.assign({},e),{[r]:{data:Object.assign({},n.data),meta:(0,d.Sw)()}});const i=a.items[0];return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},n.data),{searchType:b(i.type),hasPagesToLoad:!1,pages:1,total:1,searchSourceType:"branch"===i.type&&"fromPoi"in a&&a.fromPoi?"searchByPoi":n.data.searchSourceType}),meta:d.rv}})}(e,t);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t,s){const a=s.searchId,r=e[a];if(!r)return e;if(!t||200!==t.code)return s.more?e:Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},r.data),meta:(0,d.Sw)()}});if(r.data&&r.data.currentPage===s.page)return Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},r.data),meta:d.rv}});const i=(0,n.kk)({hasPagesToLoad:t.pages>s.page,pages:t.pages,total:t.total,ads:t.ads&&t.ads.map((e=>e.id)),searchType:t.searchType,searchAttributes:t.search_attributes,contextRubrics:t.context_rubrics,currentPage:s.page});return Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},r.data),i),meta:d.rv}})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_ERROR":case"SEARCH/FETCH_FILIALS_ERROR":case"SEARCH/FETCH_PROVIDERS_ERROR":case"SEARCH/FETCH_RUBRIC_ERROR":case"SEARCH/FETCH_ATTRIBUTE_ERROR":case"SEARCH/BY_BUILDING_ID_ERROR":case"SEARCH/IN_BUILDING_BY_QUERY_ERROR":case"SEARCH/FETCH_MAINTAINERS_ERROR":case"ENTITY/FETCH_BY_POINT_ERROR":return function(e,t,s){const a=s.searchId,r=e[a];return r?s.more?e:Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},r.data),meta:(0,d._3)(t)}}):e}(e,t.payload,t.meta);default:return e}},pagination:function(e=O,t){switch(t.type){case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_PROVIDERS":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":case"SEARCH/BY_BUILDING_ID":case"SEARCH/IN_BUILDING_BY_QUERY":case"SEARCH/FETCH_MAINTAINERS":case"SEARCH/FETCH_PARKINGS_AROUND":return function(e,t){const s=t.searchId;if(!s)return e;const a=t.page,r=e[s];return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},r),{[a]:{data:[],meta:d._V}})})}(e,t.payload);case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){const a=s.searchId;if(!a)return e;const r=e[a]||{};if(r[1])return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:{1:{data:[],meta:(0,d.IR)(t.code)}}});const n=E(t.items);return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{1:{data:n,meta:d.rv}})})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t,s){const a=s.searchId,r=e[a]||{};if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[s.page]:Object.assign(Object.assign({},r[s.page]),{meta:(0,d.IR)(t.code)})})});const n=E(t.items);return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[s.page]:{data:n,meta:d.rv}})})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_ERROR":case"SEARCH/FETCH_FILIALS_ERROR":case"SEARCH/FETCH_PROVIDERS_ERROR":case"SEARCH/FETCH_RUBRIC_ERROR":case"SEARCH/FETCH_ATTRIBUTE_ERROR":case"SEARCH/BY_BUILDING_ID_ERROR":case"SEARCH/IN_BUILDING_BY_QUERY_ERROR":case"SEARCH/FETCH_MAINTAINERS_ERROR":return function(e,t,s){const a=s.searchId,r=e[a]||{},n=(0,d._3)(t);return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[s.page]:Object.assign(Object.assign({},r[s.page]),{meta:n})})})}(e,t.payload,t.meta);default:return e}},markers:function(e={},t){return(0,h.n)(e,t)}});var m=s(30345),j=s(22934),v=s(32065);function y(e,t){return e?e.reduce(((e,s)=>{const a=t[s.id],r={data:(0,m.Rn)(s),meta:d.rv};return e[s.id]=a?(0,m.Ns)(a,r):r,e}),{}):{}}var _=s(17480),S=s(66003);const I=(0,S.Dp)("fetchApartments",{},{start:(e,{params:t})=>(0,j.vL)(e,t.id),success(e,{params:t,result:s}){const a=200===s.code?s.items[0]:void 0;return a?(0,j.h$)(e,t.id,a):e},error:(e,{params:t,error:s})=>(0,j.i5)(e,t.id,s)});var T=s(18909),C=s(96077);const R=(0,a.HY)({profile:(0,o.o)([function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t){const s=t&&200===t.code?y(t.items.concat(t.ads||[]),e):{};return Object.keys(s).length?Object.assign(Object.assign({},e),s):e}(e,t.payload);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,t){if(!t||200!==t.code)return{};const s=y(t.items.map((e=>e.branch)),e);return Object.keys(s).length?Object.assign(Object.assign({},e),s):e}(e,t.payload);case"ENTITY/FETCH_PROFILE_NO_TYPE":return function(e,t){const s=(0,n.ox)(t.id),a=e[s];return Object.assign(Object.assign({},e),{[s]:{data:a&&a.data,meta:d._V}})}(e,t.payload);case"ENTITY/FETCH_BY_POINT_SUCCESS":return function(e,t){var s;const a=t.items[0];return a?Object.assign(Object.assign({},e),{[a.id]:{data:Object.assign(Object.assign({},null===(s=e[a.id])||void 0===s?void 0:s.data),(0,m.Rn)(a)),meta:d.rv}}):e}(e,t.payload);case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){var a;const r=(0,n.ox)(s.id),i=t.items[0];if(!i){const t=e[r];return Object.assign(Object.assign({},e),{[r]:{data:t&&t.data,meta:(0,d.Sw)()}})}return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},null===(a=e[r])||void 0===a?void 0:a.data),(0,m.Rn)(i)),meta:d.rv}})}(e,t.payload,t.meta);case"ENTITY/FETCH_PROFILE_NO_TYPE_ERROR":return function(e,t,s){const a=(0,n.ox)(s.id),r=e[a];return Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d._3)(t)}})}(e,t.payload,t.meta);case"ENTITY/FETCH_MULTIPLE":return function(e,t){if(0===t.ids.length)return e;const s=(0,v.Up)(e,t.ids),a=t.ids.reduce(((e,t)=>(0,j.vL)(e,t)),s);return Object.assign(Object.assign({},e),a)}(e,t.payload);case"ENTITY/FETCH_MULTIPLE_SUCCESS":return function(e,t){if(0===t.items.length)return e;const s=t.items.reduce(((t,s)=>{const a=e[s.id],r=(0,m.Rn)(s),n=(0,m.K2)(a&&a.data,r);return(0,j.h$)(t,s.id,n)}),{});return Object.assign(Object.assign({},e),s)}(e,t.payload);case"ENTITY/FETCH_MULTIPLE_ERROR":return function(e,t,s){if(0===s.ids.length)return e;const a=(0,v.Up)(e,s.ids),r=s.ids.reduce(((e,s)=>(0,j.i5)(e,s,t)),a);return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);default:return e}},T.WA],{}),photos:C.J,discounts:function(e={},t){return(0,_.A)(e,t)},video:function(e={},t){switch(t.type){case"ENTITY/FETCH_VIDEO_DATA":return function(e,t){const s=e[t.id],a={data:s?s.data:void 0,meta:d._V};return Object.assign(Object.assign({},e),{[t.id]:a})}(e,t.payload);case"ENTITY/FETCH_VIDEO_DATA_SUCCESS":return function(e,t,s){const a={data:t,meta:d.rv};return Object.assign(Object.assign({},e),{[s.id]:a})}(e,t.payload,t.meta);case"ENTITY/FETCH_VIDEO_DATA_ERROR":return function(e,t,s){const a=e[s.id],r={data:a?a.data:void 0,meta:(0,d._3)(t)};return Object.assign(Object.assign({},e),{[s.id]:r})}(e,t.payload,t.meta);default:return e}},apartments:I,entrance:T.fO}),A={},w=(0,a.HY)({profile:function(e={},t){switch(t.type){case"REGION/FETCH":return function(e,t){return Object.assign(Object.assign({},e),{[t.id]:{meta:d._V}})}(e,t.payload);case"REGION/FETCH_SUCCESS":return function(e,t,s){return Object.assign(Object.assign({},e),{[s.id]:{data:t.result,meta:d.rv}})}(e,t.payload,t.meta);case"REGION/FETCH_LIST_SUCCESS":return function(e,t){return Object.assign(Object.assign({},e),t.result.items.reduce(((e,t)=>(e[t.id]={data:t,meta:d.rv},e)),{}))}(e,t.payload);case"REGION/CROP_LIST":return function(e,t){if(!t.ids.length)return e;const s={};return t.ids.forEach((t=>{s[t]=e[t]})),s}(e,t.payload);default:return e}},search:function(e={},t){switch(t.type){case"REGION/FETCH_LIST":return function(e,t){return Object.assign(Object.assign({},e),{[t]:{meta:d._V}})}(e,t.payload.searchId);case"REGION/FETCH_LIST_SUCCESS":return function(e,t,s){return Object.assign(Object.assign({},e),{[s.searchId]:{data:t.result.items.map((e=>e.id)),meta:d.rv}})}(e,t.payload,t.meta);case"REGION/CROP_LIST":return{};default:return e}},detector:function(e={},t){switch(t.type){case"REGION/DETECT":{const s=t.payload.searchId,a=e[s];return Object.assign(Object.assign({},e),{[s]:{data:a&&a.data,meta:d._V}})}case"REGION/DETECT_SUCCESS":{const a=t.meta.searchId,r=200===t.payload.code&&t.payload.items[0];if(!r)return Object.assign(Object.assign({},e),{[a]:{data:void 0,meta:(0,d.Sw)()}});const n=e[a];return n&&n.data&&n.data.id===r.id?e:Object.assign(Object.assign({},e),{[a]:{data:{regionId:(s=r,s.region_id&&"0"!==s.region_id?s.region_id:s.overlap_region_id&&"0"!==s.overlap_region_id?s.overlap_region_id:void 0),name:r.name,type:r.type,id:r.id,segmentId:r.segment_id,overlapRegionId:r.overlap_region_id,countryCode:r.country_code,allowChangeDomain:r.allow_change_domain,baseOverlapRegionId:t.payload.overlap_region_id,admDiv:r.adm_div},meta:d.rv}})}case"REGION/DETECT_ERROR":{const s=t.meta.searchId;return Object.assign(Object.assign({},e),{[s]:{data:void 0,meta:(0,d._3)(t.payload)}})}case"REGION/CLEAR_DETECTOR":return{};case"REGION/SET_DETECTOR":return Object.assign(Object.assign({},e),{default:{data:t.payload,meta:d.rv}});default:return e}var s}});var H=s(46287);function U(e){const{items:t,searchId:s}=e,a={};for(const e of t){const{id:t,ads:r,context:i,stat:c,hash:o}=e;a[(0,H.t6)({id:t,searchId:s})]=(0,n.kk)({ads:r,context:i,stat:c,hash:o})}return a}function F(e){const{currentContext:t,profile:s,markerStat:a}=e,{context:r,stat:n,hash:i}=s;let c={ads:s.ads,context:r,stat:n,hash:i};return t&&(c=Object.assign(Object.assign({},c),{stat:t.stat,hash:t.hash,context:t.context})),a&&(c.stat=Object.assign(Object.assign({},a),c.stat)),c}var k=s(6494);const N=(0,a.HY)({profile:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS":case"MARKET/FETCH_CATEGORIES_BY_BRANCH":case"MARKET/FETCH_BRANCH_PRODUCTS":return function(e,{payload:t}){return(0,j.vL)(e,t.offersSearchId)}(e,t);case"MARKET/FETCH_OFFERS_SUCCESS":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a];if(!r)return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:{data:r.data,meta:(0,d.Sw)()}});const n="branchId"in s&&"pinned_items"in t&&t.pinned_items?t.pinned_items.map((e=>(0,k.a)(e.product.id,s.branchId))):void 0,{total:i,pages:c,bss:o}=t,u={list_info:"list_info"in t?t.list_info:void 0,total:i,pages:c,bss:o,pinned_items:n};return Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},u),meta:d.rv}})}(e,t);case"MARKET/FETCH_OFFERS_ERROR":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_ERROR":case"MARKET/FETCH_BRANCH_PRODUCTS_ERROR":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a];return r?Object.assign(Object.assign({},e),{[a]:{data:r.data,meta:(0,d._3)(t)}}):e}(e,t);default:return e}},pagination:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS":return function(e,{payload:t}){return Object.assign(Object.assign({},e),{[t.offersSearchId]:Object.assign(Object.assign({},e[t.offersSearchId]),{[t.page]:{meta:d._V,data:[]}})})}(e,t);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.productId,r=s.offersSearchId,n=e[r]||{};if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},n),{[s.page]:Object.assign(Object.assign({},n[s.page]),{meta:(0,d.IR)(t.code)})})});const i=t.items.map((e=>(0,k.a)(a,e.branch.id)));return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},n),{[s.page]:{data:i,meta:d.rv}})})}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a]||{};if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{1:Object.assign(Object.assign({},r[1]),{meta:(0,d.IR)(t.code)})})});const n=t.items.map((({product:e})=>(0,k.a)(e.id,s.branchId)));return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{1:{data:n,meta:d.rv}})})}(e,t);case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a]||{},n=s.page;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{meta:(0,d.IR)(t.code)})})});const i=t.items.map((({product:e})=>(0,k.a)(e.id,s.branchId)));return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:{data:i,meta:d.rv}})})}(e,t);case"MARKET/FETCH_OFFERS_ERROR":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_ERROR":case"MARKET/FETCH_BRANCH_PRODUCTS_ERROR":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a]||{},n="page"in s?s.page:1;return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{meta:(0,d._3)(t)})})})}(e,t);default:return e}}}),P={};function B(e){return{type:"market",subtype:e.hint.type,id:e.hint.id,name:e.hint.text,search_attributes:{suggested_text:e.hint.text,suggest_parts:e.hint.highlighted_text.map((e=>({text:e.text,is_suggested:"highlighted"!==e.style})))}}}var D=s(24302);const L={entity:{profile:{},apartments:{},photos:{},discounts:{},entrance:{},video:{}},search:{profile:{},pagination:{},markers:{}},searchContext:{},market:{products:{},offers:{},offersSearch:{profile:{},pagination:{}},offersByOrgSearch:{profile:{},pagination:{}},categories:{},filters:{},suggestions:{}},region:{profile:{},search:{},detector:{}},settlements:{},filters:{},factsFilters:{},factsInReview:{},review:{},photo:{},feedback:{},suggestion:{},objectSuggestions:{},user:{info:{},anonymousUser:{},devices:{},achievements:{},feedbacks:{},photos:{},reviews:{},chronologyPlaces:{},activities:{},friendsActivities:{},pinnedReviews:{},shortOrders:s(56190).d,phone:{}},shortonizer:{},seoStore:{meta:D.rv},reviewSearch:{},gta:{},history:{data:{searches:[],suggestLastObjects:[]}},profile:{data:{historyObjects:[],homeWorkObjects:[],suggestLastObjects:[]}},favoritesPublic:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},favoritesPersonal:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},favoritesPlaces:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},directions:{},directionsPpnotTypes:{},traffic:{},rubricator:{lists:{},items:{}},rubric:{dashboard:{},rubricator:{}},reviewComments:{},order:{},deliveryOrder:{},ordersHistory:{},cart:{},contests:{},walkDistance:{},roadAccident:{},realty:{search:{profile:{},pagination:{}},items:{},markers:{},hashmap:{},infrastructure:{}}},M=(0,a.HY)({products:function(e={},t){switch(t.type){case"MARKET/FETCH_PRODUCT_BY_ID_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.productId,r=e[a],n="items"in t&&t.items?t.items[0]:void 0;return n?Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},n),{dicts:t.dicts}),meta:d.rv}}):Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d.Sw)(a.length<13?410:404)}})}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t}){if(!t||200!==t.code)return e;const{items:s,pinned_items:a,dicts:r}=t,n=[...s,...a||[]],i={};return n.forEach((({product:t})=>{const s=e[t.id];i[t.id]={data:s?s.data:{product:t,dicts:r},meta:d.rv}})),Object.assign(Object.assign({},e),i)}(e,t);default:return e}},offersSearch:N,offers:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,{payload:t,meta:s}){if(!t||200!==t.code)return e;const a=s.productId,r={};return t.items.forEach((e=>{const t=(0,k.a)(a,e.branch.id),s={productId:a,branchId:e.branch.id,price:e.price,price_value:e.price_value,currency:e.currency,market_item_actions:e.market_item_actions,amount:e.amount};r[t]={data:s,meta:d.rv}})),Object.assign(Object.assign({},e),r)}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){if(!t||200!==t.code)return e;const a={};return[...t.items,...t.pinned_items||[]].forEach((({product:e,offer:t,branch:r})=>{const n=(0,k.a)(e.id,s.branchId),i={productId:e.id,branchId:s.branchId,price:t.price,price_value:t.price_value,currency:t.currency,buttons:t.buttons,sellerInfo:r&&r.name,orgId:r&&r.org.id,market_item_actions:t.market_item_actions,amount:t.amount};a[n]={data:i,meta:d.rv}})),Object.assign(Object.assign({},e),a)}(e,t);default:return e}},categories:function(e={},t){switch(t.type){case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":return function(e,{meta:t,payload:s}){if(!s||200!==s.code)return e;const a=t.offersSearchId,r=s.categories;if(!r||!r.children.length){const t=e[a];return Object.assign(Object.assign({},e),{[a]:{data:t&&t.data,meta:(0,d.Sw)()}})}return Object.assign(Object.assign({},e),{[a]:{data:r,meta:d.rv}})}(e,t);case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t},s){if(e[s])return e;if(!t||200!==t.code)return e;const{categories:a}=t;return a&&a.children.length?Object.assign(Object.assign({},e),{[s]:{data:a,meta:d.rv}}):e}(e,t,t.meta.offersSearchId);default:return e}},filters:function(e=P,t){switch(t.type){case"MARKET/FETCH_OFFERS":case"MARKET/FETCH_BRANCH_PRODUCTS":return function(e,t){const{filtersId:s}=t,a=e[s];return a&&"success"===a.meta.status?e:Object.assign(Object.assign({},e),{[s]:{data:void 0,meta:d._V}})}(e,t.payload);case"MARKET/FETCH_OFFERS_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,t,s){if(!t)return e;const{filtersId:a}=s,r=e[a];if(!r||r&&"loading"!==r.meta.status)return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:{data:void 0,meta:(0,d.IR)(t.code)}});const{filters:n}=t;return Object.assign(Object.assign({},e),{[a]:{data:{filters:n},meta:d.rv}})}(e,t.payload,t.meta);default:return e}},suggestions:function(e={},t){switch(t.type){case"MARKET/FETCH_SUGGESTIONS":return function(e,{payload:t}){const{searchId:s,query:a}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:a},meta:d._V}})}(e,t);case"MARKET/FETCH_SUGGESTIONS_SUCCESS":return function(e,{payload:t,meta:s}){const{searchId:a}=s,{code:r,items:n,bss:i}=t,c=e[a];return c?200===r&&n&&n.length?Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},c.data),{items:n.map(B),bss:i}),meta:d.rv}}):Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},c),{meta:(0,d.Sw)()})}):e}(e,t);case"MARKET/FETCH_SUGGESTIONS_ERROR":return function(e,{payload:t,meta:s}){const{searchId:a}=s,r=e[s.searchId];return r?Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d._3)(t)}}):e}(e,t);case"MARKET/DROP_SUGGESTIONS":return{};default:return e}},offersByOrgSearch:(0,C.R)(L.market.offersByOrgSearch)});var x=s(85608);function Y(e){return"user_query"===e.type?{type:"object",search_attributes:e.search_attributes}:function(e){const{search_attributes:t}=e,s=(0,x.Tt)(e,["search_attributes"]);if(s.id){const e=(0,n.ox)(s.id),a=(0,n.OV)(s.id);return{type:"object",search_attributes:t,entity:Object.assign(Object.assign({},s),{id:e,hash:a})}}return{type:"object",search_attributes:t,entity:s}}(e)}var G=s(82384);const V=(0,S.yG)("fetchUserAchievements",{start:(e,{params:t})=>({[t.userId]:Object.assign(Object.assign({},e),{meta:d._V})}),success:(e,{result:t,params:s})=>t.items&&t.items.length?Object.assign(Object.assign({},e),{[s.userId]:{data:{groups:t.groups,items:t.items,total:t.meta.total,completed:t.meta.completed,contest_progress_weeks:t.meta.contest_progress_weeks},meta:d.rv}}):Object.assign(Object.assign({},e),{[s.userId]:{meta:(0,d.Sw)()}}),error:(e,{error:t,params:s})=>({[s.userId]:Object.assign(Object.assign({},e),{meta:(0,d._3)(t)})})});var K=s(65621);const W=(0,a.HY)({info:function(e={},t){switch(t.type){case"USER/UPDATE_UNSAVED_INFO":{const s=e.default;if(!s||!s.data)return e;const a=s.data,r=Object.assign(Object.assign({},a.unsaved),t.payload.unsaved),i=Object.assign(Object.assign({},a),{unsaved:null===a.public_identity_accepted&&!1===r.public_identity_accepted?(0,n.cJ)(r,["public_identity_accepted"]):r});return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},s),{data:i})})}case"USER/UPDATE_EMAIL":{const t=e.default;if(!t||!t.data)return e;const s=Object.assign(Object.assign({},t.meta),{crud:"updating"});return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},t),{meta:s})})}case"USER/UPDATE_EMAIL_SUCCESS":{const s=e.default;return s&&s.data?Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},s),{data:Object.assign(Object.assign({},s.data),{new_email:t.payload.new_email||void 0,unsaved:Object.assign(Object.assign({},s.data.unsaved),{email:void 0})}),meta:Object.assign(Object.assign({},s.meta),{crud:void 0})})}):e}case"USER/UPDATE_EMAIL_ERROR":{const t=e.default;return t&&t.data?Object.assign(Object.assign({},e),{default:{data:Object.assign(Object.assign({},t.data),{unsaved:Object.assign(Object.assign({},t.data.unsaved),{email:void 0})}),meta:Object.assign(Object.assign({},t.meta),{crud:void 0})}}):e}default:return(0,G.K)(e,t)}},photos:(0,C.R)(L.user.photos),reviews:function(e={},t){switch(t.type){case"USER/FETCH_REVIEWS":return function(e,t){const s=e[t.userId];return Object.assign(Object.assign({},e),{[t.userId]:{data:s&&s.data,meta:d._V}})}(e,t.payload);case"USER/FETCH_REVIEWS_SUCCESS":return function(e,t,s){const a=e[s.userId];if(!t.items.length)return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d.Sw)()}});const r=a&&a.data&&a.data.items||[],n=t.items.map((e=>e.id)),i=s.offset?[...r,...n]:n,c=t.items[t.items.length-1];return Object.assign(Object.assign({},e),{[s.userId]:{data:{items:i,total:t.total,offset:c.date_edited||c.date_created},meta:d.rv}})}(e,t.payload,t.meta);case"USER/FETCH_REVIEWS_ERROR":return function(e,t,s){const a=e[s.userId];return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d._3)(t)}})}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t,s){const a=e[s.userId];if(!a||!a.data)return e;const r=a.data.items.filter((e=>e!==s.id));return Object.assign(Object.assign({},e),{[s.userId]:{data:Object.assign(Object.assign({},a.data),{items:r,total:a.data.total-1}),meta:a.meta}})}(e,t.payload,t.meta);default:return e}},feedbacks:function(e={},t){switch(t.type){case"FEEDBACK/FETCH_USER_FEEDBACKS":return function(e,t){const s=e[t.userId];return Object.assign(Object.assign({},e),{[t.userId]:{data:s&&s.data,meta:d._V}})}(e,t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS_SUCCESS":return function(e,t,s){const a=e[s.userId];if(!t.items||!t.items.length)return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d.Sw)()}});const r=a&&a.data&&a.data.items||[],n=t.items.map((e=>e.id)),i=s.offset>0?[...r,...n]:n;return Object.assign(Object.assign({},e),{[s.userId]:{data:Object.assign(Object.assign({},a&&a.data),{items:i,offset:i.length}),meta:d.rv}})}(e,t.payload,t.meta);case"FEEDBACK/FETCH_USER_FEEDBACKS_ERROR":return function(e,t,s){const a=e[s.userId];return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d._3)(t)}})}(e,t.payload,t.meta);case"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT_SUCCESS":return function(e,t,s){const a=e[s.userId],r=a&&a.data;return Object.assign(Object.assign({},e),{[s.userId]:Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},r),{items:r&&r.items||[],total:t.total}),meta:a?a.meta:d.rv})})}(e,t.payload,t.meta);default:return e}},anonymousUser:function(e={},t){switch(t.type){case"FEEDBACK/GET_ANOMYMOUS_FEEDBACKS_COUNT_SUCCESS":return function(e,t){return Object.assign(Object.assign({},e),{feedbacksCount:t?parseInt(t,10):0})}(e,t.payload);case"FEEDBACK/SET_ANOMYMOUS_FEEDBACKS_COUNT":return function(e,t){return Object.assign(Object.assign({},e),{feedbacksCount:t.feedbacksCount})}(e,t.payload);default:return e}},achievements:function(e={},t){return t.type,V(e,t)},devices:function(e={},t){return"USER/CLEAR_DEVICES"===t.type?{}:e},pinnedReviews:function(e={},t){return"USER/DELETE_REVIEW_SUCCESS"===t.type&&t.meta.entityId?Object.assign(Object.assign({},e),{[t.meta.entityId]:void 0}):e},shortOrders:(0,C.R)(L.user.shortOrders),activities:(0,C.R)(L.user.activities),friendsActivities:function(e={},t){return(0,K.k)(e,t)},phone:(0,C.R)(L.user.phone),chronologyPlaces:(0,C.R)(L.user.chronologyPlaces)});var z=s(74006);function $(e,{sync:t,objects:s,replace:a}){return a?{sync:t,objects:s}:(0,n.Im)(s)?{sync:t,objects:e.objects}:{sync:t,objects:Object.assign(Object.assign({},e.objects),s)}}const Q=(0,S.uI)("syncPublicFavorites","favoritesPublic",{success:(e,{result:t})=>$(e,t)}),q=(0,S.uI)("syncPlaces","favoritesPlaces",{success:(e,{result:t})=>$(e,t)}),J=(0,S.uI)("modifyPlaces","favoritesPlaces",{success:(e,{result:t})=>$(e,t)}),Z=(0,S.uI)("modifyPersonalFavorites","favoritesPersonal",{success:(e,{result:t})=>$(e,t)}),X=(0,S.uI)("syncPersonalFavorites","favoritesPersonal",{success:(e,{result:t})=>$(e,t)}),ee=(0,S.uI)("fetchTrafficScore","traffic",{start(e,{params:t}){const s=e[t.regionCode];return Object.assign(Object.assign({},e),{[t.regionCode]:{data:s&&s.data,meta:D._V}})},success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{[t.regionCode]:{data:{score:s},meta:D.rv}}),error(e,{params:t,error:s}){const a=e[t.regionCode];return Object.assign(Object.assign({},e),{[t.regionCode]:{data:a&&a.data,meta:(0,D._3)(s)}})}});var te=s(97980),se=s(66698);const ae=(0,S.uI)("fetchProjecMarketCategories","market",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.LY)(t.projectId)]:{meta:d._V}})}),success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.LY)(t.projectId)]:{meta:d.rv,data:s.categories}})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.LY)(t.projectId)]:{meta:(0,d._3)(s)}})})}),re=(0,S.uI)("fetchProductOffersGroupedByOrg","market",{start:(e,{params:t})=>ne({state:e,searchId:t.searchId,page:t.page,meta:d._V}),success(e,{params:t,result:s}){if(!s.items.length)return ne({state:e,searchId:t.searchId,page:t.page,meta:(0,d.Sw)()});const{searchId:a,filtersId:r,page:n=1}=t,{filters:i,total:c,items:o,bss:u}=s,l=d.rv;return Object.assign(Object.assign({},e),{offersByOrgSearch:Object.assign(Object.assign({},e.offersByOrgSearch),{profile:Object.assign(Object.assign({},e.offersByOrgSearch.profile),{[a]:{data:{total:c,pages:(g=c,p=se.H0,Math.ceil(g/p)),bss:u},meta:l}}),pagination:Object.assign(Object.assign({},e.offersByOrgSearch.pagination),{[a]:Object.assign(Object.assign({},e.offersByOrgSearch.pagination[a]),{[n]:{data:o,meta:l}})})}),filters:Object.assign(Object.assign({},e.filters),r?{[r]:{data:{filters:i},meta:l}}:void 0)});var g,p},error:(e,{params:t,error:s})=>ne({state:e,searchId:t.searchId,page:t.page,meta:(0,d._3)(s)})});function ne({state:e,searchId:t,filtersId:s,page:a=1,meta:r}){return Object.assign(Object.assign({},e),{offersByOrgSearch:Object.assign(Object.assign({},e.offersByOrgSearch),{profile:Object.assign(Object.assign({},e.offersByOrgSearch.profile),{[t]:Object.assign(Object.assign({},e.offersByOrgSearch.profile[t]),{meta:r})}),pagination:Object.assign(Object.assign({},e.offersByOrgSearch.pagination),{[t]:Object.assign(Object.assign({},e.offersByOrgSearch.pagination[t]),{[a]:{data:[],meta:r}})})}),filters:Object.assign(Object.assign({},e.filters),s?{[s]:Object.assign(Object.assign({},e.filters[s]),{meta:r})}:void 0)})}const ie=(0,S.uI)("getAllPublicFavorites","favoritesPublic",{success:(e,{result:t})=>$(e,t)}),ce=[(0,S.uI)("clearPersonalData","favoritesPersonal",{success:()=>({sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}})}),(0,S.uI)("clearPersonalData","favoritesPlaces",{success:()=>({sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}})}),(0,S.uI)("clearPersonalData","user",{success:e=>Object.assign(Object.assign({},L.user),{info:e.info,anonymousUser:e.anonymousUser})}),(0,S.uI)("clearPersonalData","history",{success:()=>({data:{searches:[],suggestLastObjects:[],historyObjects:[],homeWorkObjects:[]}})})],oe=(0,S.uI)("fetchReviewComments","reviewComments",{start:(e,{params:t})=>(0,j.vL)(e,t.id),success:(e,{result:t,params:s})=>(0,j.h$)(e,s.id,t.comments),error:(e,{error:t,params:s})=>(0,j.i5)(e,s.id,t)}),de=(0,S.uI)("sendReviewCommentAnswer","reviewComments",{success(e,{params:t,result:s}){const a=e[t.id];return a?Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},a),{data:a.data?[...a.data,s.comment]:[s.comment]})}):e}}),ue=(0,S.uI)("removeReviewComment","reviewComments",{success(e,{params:t}){var s;const a=e[t.reviewId];return a?Object.assign(Object.assign({},e),{[t.reviewId]:Object.assign(Object.assign({},a),{data:null===(s=a.data)||void 0===s?void 0:s.filter((e=>e.id!==t.id))})}):e}}),le=(0,S.uI)("fetchDevices","user",{start:e=>Object.assign(Object.assign({},e),{devices:Object.assign(Object.assign({},e.devices),{meta:d._V})}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{devices:{data:t.items,meta:d.rv}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{devices:{meta:(0,d._3)(t)}})}),ge=(0,S.uI)("fetchReviewsFacts","factsFilters",{start:(e,{params:t})=>(0,j.vL)(e,t.id),success:(e,{result:t,params:s})=>(0,j.h$)(e,s.id,t.data||[]),error:(e,{error:t,params:s})=>(0,j.i5)(e,s.id,t)});var pe=s(68871);const be=(0,S.uI)("setReviewLike","review",{start(e,{params:t}){const{id:s,value:a}=t,r=e[s];if(!r)return e;const n=r.data;return(0,pe.N)(n)?Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},r),{data:Object.assign(Object.assign({},n),{likes_count:Oe(n.likes_count,a),additional_data:Object.assign(Object.assign({},n.additional_data),{is_liked:a})})})}):e}});function Oe(e,t){return t?e+1:e>0?e-1:0}var Ee=s(11484),he=s(18290),fe=s(53544),me=s(76603),je=s(17332),ve=s(35897),ye=s(78205),_e=s(78351),Se=s(27797);const Ie=[ve.jV,ye.v,_e.e,Se.v];var Te=s(47681),Ce=s(92533),Re=s(48648),Ae=s(7090),we=s(62205);const He=(0,a.HY)({entity:R,search:f,filters:function(e=A,t){switch(t.type){case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":return function(e,t){const{withFilters:s,filtersId:a}=t;return s&&a?Object.assign(Object.assign({},e),{[a]:{}}):e}(e,t.payload);case"SEARCH/FETCH_FILIALS_FILTERS":case"SEARCH/FETCH_FILTERS":return function(e,t){const{filtersId:s}=t;return s?Object.assign(Object.assign({},e),{[s]:{}}):e}(e,t.payload);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":return function(e,t,s){const a=s.filtersId;return a&&e[a]&&t&&200===t.code&&t.widgets&&t.filters?Object.assign(Object.assign({},e),{[a]:{widgets:t.widgets,filters:t.filters}}):e}(e,t.payload,t.meta);case"SEARCH/FETCH_FILTERS_SUCCESS":case"SEARCH/FETCH_FILIALS_FILTERS_SUCCESS":return function(e,t,s){const{filters:a,widgets:r}=t,n=s.filtersId;return e[n]&&r&&a?Object.assign(Object.assign({},e),{[n]:{widgets:r,filters:a}}):e}(e,t.payload,t.meta);default:return e}},region:w,searchContext:function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const a=s.searchId,r=U({items:t.items.concat(t.ads||[]),searchId:a});return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const a=s.offersSearchId,r=U({items:t.items.map((e=>e.branch)),searchId:a});return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){if(200!==t.code)return e;const a=t.items[0];if(!a)return e;const r=(0,H.t6)({searchId:s.searchId,id:a.id}),n=F({currentContext:e[r],profile:a,markerStat:s.markerStat});return Object.assign(Object.assign({},e),{[r]:n})}(e,t.payload,t.meta);case"ENTITY/FETCH_BY_POINT_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const a=s.searchId,r=U({items:t.items,searchId:a});return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);case"ENTITY/FETCH_MULTIPLE_SUCCESS":return function(e,t,s){if(0===t.items.length)return e;const a=t.items.reduce(((t,a)=>{const r=(0,H.t6)({searchId:s.searchId,id:a.id}),n=F({currentContext:e[r],profile:a});return Object.assign(Object.assign({},t),{[r]:n})}),{});return Object.assign(Object.assign({},e),a)}(e,t.payload,t.meta);default:return e}},suggestion:function(e={},t){switch(t.type){case"SEARCH/FETCH_SUGGESTIONS":return function(e,t){const{searchId:s,query:a}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:a},meta:d._V}})}(e,t.payload);case"SEARCH/FETCH_SUGGESTIONS_SUCCESS":return function(e,t,s){const{searchId:a}=s,r=e[a];return r?200===t.code&&t.items&&t.items.length?Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},r.data),{items:t.items}),meta:d.rv}}):Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{meta:(0,d.Sw)()})}):e}(e,t.payload,t.meta);case"SEARCH/FETCH_SUGGESTIONS_ERROR":return function(e,t,s){const{searchId:a}=s,r=e[s.searchId];return r?Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d._3)(t)}}):e}(e,t.payload,t.meta);case"SEARCH/CROP_SUGGESTION":return{};default:return e}},objectSuggestions:function(e={},t){switch(t.type){case"SEARCH/FETCH_OBJECT_SUGGESTIONS":return function(e,{payload:t}){const{searchId:s,query:a}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:a},meta:d._V}})}(e,t);case"SEARCH/FETCH_OBJECT_SUGGESTIONS_SUCCESS":return function(e,{payload:t,meta:s}){const{searchId:a}=s,r=e[a];return r?200===t.code&&t.items&&t.items.length?Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},r.data),{items:t.items.map(Y),searchAttributes:t.search_attributes}),meta:d.rv}}):Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{meta:(0,d.Sw)()})}):e}(e,t);case"SEARCH/FETCH_OBJECT_SUGGESTIONS_ERROR":return function(e,{payload:t,meta:s}){const{searchId:a}=s,r=e[s.searchId];return r?Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d._3)(t)}}):e}(e,t);case"SEARCH/CROP_SUGGESTION":return{};default:return e}},review:function(e={},t){switch(t.type){case"USER/FETCH_REVIEWS_SUCCESS":case"REVIEW/FETCH_REVIEWS_SUCCESS":return function(e,t){if(!t.items.length)return e;const s=t.items.reduce(((t,s)=>{var a;const r=null===(a=e[s.id])||void 0===a?void 0:a.data;return t[s.id]={data:Object.assign(Object.assign(Object.assign({},r),s),{object:Object.assign(Object.assign({},r&&"object"in r?null==r?void 0:r.object:void 0),s.object)}),meta:d.rv},t}),{});return Object.assign(Object.assign({},e),s)}(e,t.payload);case"USER/DELETE_REVIEW":return function(e,t){const s=e[t.id];return s?Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},s),{meta:Object.assign(Object.assign({},s.meta),{crud:"deleting"})})}):e}(e,t.payload);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t,s){if(!e[s.id])return e;const a=Object.assign({},e);return delete a[s.id],a}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_ERROR":return function(e,t,s){const a=e[s.id];return a?Object.assign(Object.assign({},e),{[s.id]:Object.assign(Object.assign({},a),{meta:Object.assign(Object.assign({},a.meta),{crud:void 0})})}):e}(e,t.payload,t.meta);default:return e}},photo:C.J,user:W,feedback:function(e={},t){return"FEEDBACK/FETCH_USER_FEEDBACKS_SUCCESS"===t.type?function(e,t){if(!t.items)return e;const s=t.items.reduce(((e,t)=>(e[t.id]={data:t,meta:d.rv},e)),{});return Object.assign(Object.assign({},e),s)}(e,t.payload):e},seoStore:function(e=L.seoStore,t){switch(t.type){case"SEO_STORE/FETCH":return function(e){return Object.assign(Object.assign({},e),{meta:d._V})}(e);case"SEO_STORE/FETCH_SUCCESS":return function(e,t){return Object.assign(Object.assign({},e),{data:t,meta:d.rv})}(e,t.payload);case"SEO_STORE/FETCH_ERROR":return function(e,t){return Object.assign(Object.assign({},e),{meta:(0,d._3)(t)})}(e,t.payload);case"SEO_STORE/CLEAR_MINI_TEXT":return function(e){return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{miniText:void 0})})}(e);default:return e}},reviewSearch:function(e={},t){switch(t.type){case"REVIEW/FETCH_REVIEWS":return function(e,t){const s=e[t.searchId];return Object.assign(Object.assign({},e),{[t.searchId]:{meta:d._V,data:s?s.data:void 0}})}(e,t.payload);case"REVIEW/FETCH_REVIEWS_SUCCESS":return function(e,t,s){const a=e[s.searchId],r=a&&a.data&&a.data.items||[],n=[...r,...t.items.map((e=>e.id))],i=n.length,c=t.items[0],o=!r.length&&c&&c.additional_data&&"pinned"===c.additional_data.pin_status?c.id:void 0,u=a&&a.data&&a.data.pinnedId?a.data.pinnedId:o;return Object.assign(Object.assign({},e),{[s.searchId]:{meta:d.rv,data:{rating:t.rating,orgRating:t.orgRating,total:t.total,totalForRequest:t.totalForRequest,offset:t.hasMore?i:void 0,items:n,pinnedId:u}}})}(e,t.payload,t.meta);case"REVIEW/FETCH_REVIEWS_ERROR":return function(e,t,s){const a=e[s.searchId];return Object.assign(Object.assign({},e),{[s.searchId]:Object.assign(Object.assign({},a),{meta:(0,d._3)(t)})})}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t){if(!t.searchId)return e;const s=e[t.searchId],a=s&&s.data;if(!s||!a)return e;const r=a.total-1,n=a.items.filter((e=>e!==t.id)),i=a.pinnedId===t.id?void 0:a.pinnedId;return Object.assign(Object.assign({},e),{[t.searchId]:{meta:s.meta,data:Object.assign(Object.assign({},a),{total:r,items:n,pinnedId:i})}})}(e,t.meta);default:return e}},gta:function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){var a,r;if(!t||200!==t.code)return e;const n=s.gtaId;return n?(null===(a=t.ad)||void 0===a?void 0:a.gta)===e[n]?e:Object.assign(Object.assign({},e),{[n]:null===(r=t.ad)||void 0===r?void 0:r.gta}):e}(e,t.payload,t.meta);default:return e}},history:z.Ay,market:M,factsInReview:function(e={},t){return"REVIEW/FETCH_REVIEWS_SUCCESS"===t.type?function(e,t){const{payload:s,meta:a}=t;if(!s.items.length)return e;const r=s.items.reduce(((e,t)=>{var s;const a=(null===(s=t.additional_data)||void 0===s?void 0:s.filtered_facts)||[];return a.length?Object.assign(Object.assign({},e),{[t.id]:a}):e}),{}),n=e[a.searchId]||{};return Object.assign(Object.assign({},e),{[a.searchId]:Object.assign(Object.assign({},n),r)})}(e,t):e},favoritesPublic:(0,o.o)([function(e,t){return"FAVORITES/CROP_PUBLIC_SET"===t.type?function(e,t){if(!t.ids)return e;const s=t.ids.reduce(((t,s)=>(e.objects[s]&&(t[s]=e.objects[s]),t)),{});return Object.assign(Object.assign({},e),{objects:s})}(e,t.payload):e}],L.favoritesPublic),directions:C.J,directionsPpnotTypes:C.J,traffic:C.J,factsFilters:C.J,order:C.J,deliveryOrder:C.J,reviewComments:C.J,ordersHistory:C.J,cart:C.J,contests:C.J,shortonizer:C.J,favoritesPersonal:(0,C.R)(L.favoritesPersonal),favoritesPlaces:(0,C.R)(L.favoritesPlaces),rubricator:(0,C.R)(L.rubricator),rubric:(0,C.R)(L.rubric),realty:(0,C.R)(L.realty),profile:(0,C.R)(L.profile),settlements:(0,C.R)(L.settlements),walkDistance:(0,C.R)(L.walkDistance),roadAccident:(0,C.R)(L.roadAccident)}),Ue=(0,o.o)([He,...ce,le,ee,ae,re,oe,de,ue,Q,ie,X,Z,q,J,ge,be,he.$,fe.R,Ae.A,we.p,me.q,je.n,Te.C,...Ee.B,...Ie,Ce.e,Re.l],L),Fe=(0,S.yG)("setFlag",{success:(e,{result:t})=>Object.assign(Object.assign({},e),{flags:t})}),ke=(0,o.o)([function(e,t){switch(t.type){case"USER/SET_PARAMS":case"USER/SET_SID_USER_PARAMS":return Object.assign(Object.assign({},e),t.payload);case"USER/SET_STAT_HASH":return Object.assign(Object.assign({},e),{statHash:t.payload.statHash});case"USER/ACTIVATE_MY_GEOLOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!0,following:!0,error:void 0})});case"USER/DEACTIVATE_MY_GEOLOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!1,following:!1,error:void 0})});case"USER/ALLOW_LOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:t.payload.allow,following:!1,error:void 0})});case"USER/FOLLOW_LOCATION":return t.payload.follow===e.geolocation.following?e:Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{following:t.payload.follow})});case"USER/SET_LOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{error:void 0,position:{lon:t.payload.lonLat.lon,lat:t.payload.lonLat.lat},accuracy:t.payload.accuracy})});case"USER/LOCATION_ERROR":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!1,error:!0})});case"USER/UPDATE_ONLINE_STATUS":return t.payload.isOffline===e.isOffline?e:Object.assign(Object.assign({},e),{isOffline:t.payload.isOffline});case"USER/SET_WINDOW_SIZE":return Object.assign(Object.assign({},e),{screen:t.payload});case"USER/SET_UTM":return Object.assign(Object.assign({},e),{utm:t.payload});case"TIME/SET_DELTA":return function(e,t){const s=e.time-t.time;return Math.abs(s)<6e4?e:Object.assign(Object.assign({},e),{timeDelta:s})}(e,t.payload);case"TIME/SET":return Object.assign(Object.assign({},e),{time:t.payload.time});case"TIME/SET_TIMEZONE":return function(e,t){const s=t.timezone/60+e.timeDelta/Ne;return Object.assign(Object.assign({},e),{timezone:s})}(e,t.payload);case"USER/SET_3D_MAP_ENABLED_STATUS":return Object.assign(Object.assign({},e),{is3dEnabled:t.payload.is3dEnabled});default:return e}},Fe],{userId:"",platform:"online",ip:"",hostname:"",userAgent:"void",startURL:"",isIE:!1,isWindows:!1,flags:{},geolocation:{allowed:!1,following:!1},screen:{width:1200,height:600},isOffline:!1,isSearchBot:!1,isMuseum:!1,browserLang:"ru",browserLocale:void 0,time:0,timeDelta:0,is3dEnabled:!0}),Ne=36e5;function Pe(e={},t){if("async"in t&&t.async){const s=t.payload&&t.payload.statusId;return s?Object.assign(Object.assign({},e),{[s]:Be(s,t.type)}):e}if("success"in t&&t.success){const s=t.meta&&t.meta.statusId;if(!s)return e;const a=e[s];return a?Object.assign(Object.assign({},e),{[s]:De(a,d.rv)}):e}if("error"in t&&t.error){const s=t.meta&&t.meta.statusId;if(!s)return e;const a=e[s];return a?Object.assign(Object.assign({},e),{[s]:De(a,(0,d._3)(t.payload))}):e}if("effect"in t&&t.effect){const s=t.payload.params.statusId||t.payload.uuid;if("start"===t.payload.phase)return Object.assign(Object.assign({},e),{[s]:Be(s,t.type)});const a=e[s];if(!a)return e;const r="success"===t.payload.phase?d.rv:(0,d._3)(t.payload.error);return Object.assign(Object.assign({},e),{[s]:De(a,r)})}return e}function Be(e,t){return{id:e,type:t,meta:d._V,__timing:{start:Date.now()}}}function De(e,t){return{id:e.id,type:e.type,meta:t,__timing:{start:e.__timing.start,end:Date.now()}}}const Le=e=>{const t=(0,a.HY)(Object.assign({bss:c,data:Ue,session:ke,status:Pe},e));return(e,s)=>(s.reducers&&s.reducers.length&&(e=s.reducers.reduce(((e,t)=>t(e,s)),e)),"HISTORY/REPLACE_STATE"===s.type?Object.assign(Object.assign({},e),s.payload):t(e,s))};var Me=s(61949),xe=s(12017);function Ye(e){return t=>s=>a=>{let r=t.dispatch;const n=a[xe.bh.NAME];switch(a.type){case"INTERNAL/SIGNAL":return r(Ge(a.payload.action,n));case"INTERNAL/ACTION_SEQUENCE":return function(e,t,s){return e.reduce(((e,a)=>e.then((()=>{if(a)return t(Ge(a,s))}))),Promise.resolve())}(a.payload,r,n);case"INTERNAL/ACTION_PARALLEL":return function(e,t,s){return Promise.all(e.map((e=>{if(e)return t(Ge(e,s))})))}(a.payload,r,n);case"INTERNAL/ACTION_WITH_STATE":return(0,Me.A)(t.getState,a.payload,(e=>e&&r(Ge(e,n))))();case"INTERNAL/ACTION_WITH_CONFIG":const i=(0,a.payload)(e);return i&&r(Ge(i,n));case"INTERNAL/NOOP":return;case"INTERNAL/DEFER":const c=a.payload.fn();return c?c instanceof Promise?c:r(Ge(c,n)):void 0;default:return s(a)}}}function Ge(e,t){return t?(e[xe.bh.NAME]=e[xe.bh.NAME]?`${t}.${e[xe.bh.NAME]}`:t,e):e}class Ve{constructor(e){this.webApi=e.webApi,this.photoApi=e.photoApi,this.reviewsApi=e.reviewsApi,this.storyComplaintApi=e.storyComplaintApi,this.shortonizerApi=e.shortonizerApi,this.profileApi=e.profileApi,this.videoApi=e.videoApi,this.marketApi=e.marketApi,this.feedbackApi=e.feedbackApi,this.cookieApi=e.cookieApi,this.authApi=e.authApi,this.windowApi=e.windowApi,this.aggregatorApi=e.aggregatorApi,this.dataFeedbackApi=e.dataFeedbackApi,this.feedbackStorageApi=e.feedbackStorageApi,this.seoStoreApi=e.seoStoreApi,this.credentialsApi=e.credentialsApi}}var Ke=s(19297),We=s(67809);function ze(e){if(e instanceof Ke.Dr)return{code:500};if(200!==e.code)return{code:(0,Ke.F6)(e.code)};const t=Math.ceil(e.total/se.Uq),s=e.request_type||"recovery",a=e.search_type?e.search_type:u[s];return{code:200,items:Qe(e.items),pages:t,total:e.total,widgets:e.widgets,filters:e.filters,search_attributes:e.search_attributes,context_rubrics:e.context_rubrics,ad:e.ad,searchType:a}}function $e(e){const{search:t,ads:s}=e,a=ze(t);return s&&200===s.code&&s.items.length&&200===a.code?Object.assign(Object.assign({},a),{ads:Qe(s.items)}):a}function Qe(e){return e.map((e=>(0,We._)(e)))}class qe extends Ve{constructor(e){super(e),this.debouncedSearchObjectSuggestions=(0,n.AK)(this.searchObjectSuggestions.bind(this),250)}searchByQuery(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchByQuery(Object.assign(Object.assign({},e),{accessToken:t})).then((t=>{if(!t||200!==t.code)return{search:t};if(t.ads&&t.ads.length>0&&1===e.page){const s=t.ads.map((e=>e.branch_id||""));return this.webApi.getProfiles({ids:s,viewpoint:e.viewpoint,locale:e.locale}).then((e=>({search:t,ads:e}))).catch((()=>({search:t})))}return{search:t}})).then($e)}))}searchByRubric(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFirmByRubric(Object.assign(Object.assign({},e),{accessToken:t})).then(ze)}))}searchByAttribute(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFirmByAttribute(Object.assign(Object.assign({},e),{accessToken:t})).then(ze)}))}getSearchFilters(e){return this.webApi.getSearchFilters(e)}getSearchFilialsFilters(e){return this.webApi.getSearchFilialsFilters(e)}searchByBuildingId(e){return this.webApi.searchByBuildingId(e).then(ze)}searchInBuildingByQuery(e){return this.webApi.searchInBuildingByQuery(e).then(ze)}searchMaintainers(e){return this.webApi.searchMaintainers(e).then(ze)}searchProviders(e){return this.webApi.searchProviders(e).then(ze)}searchFilials(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFilials(Object.assign(Object.assign({},e),{accessToken:t})).then(ze)}))}searchSuggestionsByQuery(e){return this.webApi.searchSuggestionsByQuery(e)}searchObjectSuggestions(e){return this.webApi.searchObjectSuggestions(e)}searchProfiles({query:e,page:t=1,viewpoint:s,locale:a}){const r=e.split(","),n=r.slice(se.Uq*(t-1),se.Uq*t);return this.webApi.getProfiles({ids:n,viewpoint:s,locale:a}).then((e=>(200===e.code&&(e.total=r.length),e))).then(ze)}searchParkingsAround(e){return this.webApi.searchParkingsAround(e).then(ze)}}var Je=s(59954);function Ze(e){const t={code:e.code};if(200!==e.code)return Object.assign(Object.assign({},t),{items:[]});const s=e.items[0],a=Object.assign(Object.assign({},t),{items:[(0,We._)(s)]});return"ad"in e&&(a.ad=e.ad),a}class Xe extends Ve{constructor(e){super(e),this.updateDeletedBranchInfo=(e,t)=>s=>{if(!s.items.length)return s;const a=s.items[0];return"branch"!==a.type?s:a.dates&&a.dates.deleted_at&&a.org&&e?this.webApi.searchFilials({viewpoint:e,orgId:a.org.id,locale:t}).then((e=>200===e.code&&e&&a.org?Object.assign(Object.assign({},s),{items:[Object.assign(Object.assign({},a),{org:Object.assign(Object.assign({},a.org),{branch_count:e.total})})]}):s)):s}}getEntityByIdNoType({id:e,hash:t,clickPoint:s,viewpoint:a,locale:r,contextRubrics:n,adsId:i,mapAdsId:c,searchCtx:o}){return this.webApi.getItem({id:t?`${e}_${t}`:e,clickPoint:s,viewpoint:a,locale:r,contextRubrics:n,adsId:i,mapAdsId:c,searchCtx:o}).then(Ze).then(this.updateDeletedBranchInfo(a,r))}getMultipleEntities({ids:e,hash:t,viewpoint:s,locale:a}){return this.webApi.getItems({ids:t?e.map((e=>`${e}_${t}`)):e,viewpoint:s,locale:a}).then((e=>200!==e.code?{code:e.code,items:[]}:{code:200,items:e.items.map(We._)}))}getEntityByPoint(e){return this.webApi.searchByPoint(e).then((t=>{var s;if(200!==t.code)return{code:200,items:[{id:Je.K0,region_id:e.regionId,locale:void 0,segment_id:"0",point:e.point,type:"point"}],fromPoi:!1};const a=t.items&&t.items[0],r="poi"!==a.type?null===(s=a.group)||void 0===s?void 0:s.find((e=>!!e.is_main_in_group)):void 0,n="poi"===a.type?a.reference.id:r&&r.id||a.id;return this.getEntityByIdNoType({id:n,clickPoint:e.point,viewpoint:e.viewpoint,locale:e.locale,contextRubrics:[]}).then((e=>Object.assign(Object.assign({},e),{fromPoi:"poi"===a.type})))}))}}class et extends Ve{constructor(e){super(e)}uploadPhoto(e){return(0,x.sH)(this,void 0,void 0,(function*(){const{objectId:t,objectType:s,temporaryId:a,file:r,locale:n,regionId:i,albumCode:c,isReplaced:o,isMenuPhoto:d}=e,u=yield this.credentialsApi.getToken();if(!u)throw new Error("User is not authorized");const l=(yield this.photoApi.addPhoto({uid:a,objectId:t,objectType:s,albumCode:c,locale:n,regionId:i,accessToken:u,isReplaced:o,isMenuPhoto:d})).items[0];if(!l.hash||!l.id||l.error)throw{name:l.error&&l.error.type,message:l.error&&l.error.message};return this.photoApi.uploadPhoto({id:l.id,hash:l.hash,file:r,accessToken:u,objectType:s})}))}}class tt extends Ve{constructor(e){super(e)}getEntityReviews(e){return(0,x.sH)(this,void 0,void 0,(function*(){const{id:t,type:s,isAdvertiser:a,offset:r,withAnswer:n,ratings:i,unconfirmed:c,facts:o,newtworkTimeout:d,locale:u}=e,l=yield this.credentialsApi.getToken();switch(s){case"branch":return this.reviewsApi.getBranchReviews({id:t,type:s,isAdvertiser:a,offset:r,withAnswer:n,ratings:i,accessToken:l,unconfirmed:c,facts:o,newtworkTimeout:d,locale:u||""});case"geo":if(c)throw new Error("no unconfirmed reviews on geo");return this.reviewsApi.getGeoReviews({id:t,type:s,offset:r,ratings:i,accessToken:l,newtworkTimeout:d,locale:u||""});case"org":return this.reviewsApi.getOrgReviews({id:t,type:s,offset:r,withAnswer:n,ratings:i,accessToken:l,unconfirmed:c,facts:o,newtworkTimeout:d,locale:u||""})}}))}getUserReviews(e){return(0,x.sH)(this,void 0,void 0,(function*(){const{userId:t,locale:s,offset:a}=e,r=yield this.credentialsApi.getToken();if(!r)throw new Error("User is not authorized");return this.reviewsApi.getUserReviews({userId:t,accessToken:r,locale:s,offset:a})}))}deleteReview(e){return(0,x.sH)(this,void 0,void 0,(function*(){const{id:t,locale:s}=e,a=yield this.credentialsApi.getToken();if(!a)throw new Error("User is not authorized");return this.reviewsApi.deleteReview({id:t,accessToken:a,locale:s||""})}))}}class st extends Ve{constructor(e){super(e)}getRegionById(e){return this.webApi.getRegionById(e)}getRegionsList(e){return this.webApi.getRegionsList(e)}detectRegion(e){return this.webApi.detectRegion(e)}}class at extends Ve{constructor(e){super(e)}clearSearchHistory(e){return this.profileApi.clearSearchHistory(e)}}class rt extends Ve{constructor(e){super(e)}getVideoData(e){return this.videoApi.getVideoData(e.videoUrl)}}class nt extends Ve{constructor(e){super(e)}confirmRegistration({email:e,clientId:t}){return(0,x.sH)(this,void 0,void 0,(function*(){const s=yield this.credentialsApi.getToken();if(!s)throw new Error("User is not authorized");return this.authApi.updateEmail({accessToken:s,email:e,authClientId:t}).then((()=>{}))}))}}class it extends Ve{constructor(e){super(e)}sendFeedback(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return yield this.feedbackApi.sendFeedback(Object.assign(Object.assign({},e),{accessToken:t}))}))}sendMediaComplaint(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return yield this.feedbackApi.sendMediaComplaint(Object.assign(Object.assign({},e),{accessToken:t}))}))}sendReviewFeedback(e){return(0,x.sH)(this,void 0,void 0,(function*(){const{reviewId:t,text:s,locale:a}=e,r=yield this.credentialsApi.getToken();if(!r)throw new Error("User is not authorized");return yield this.reviewsApi.sendReviewComplaint({id:t,text:s,accessToken:r,locale:a||""})}))}sendStoryComplaintFeedback(e){return(0,x.sH)(this,void 0,void 0,(function*(){const{segmentId:t,storyId:s,categoryCode:a,comment:r,userEmail:n}=e,i=yield this.credentialsApi.getToken();return yield this.storyComplaintApi.sendStoryComplaint({segmentId:t,storyId:s,categoryCode:a,comment:r,userEmail:n,accessToken:i})}))}getUserFeedbacks(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();if(!t)throw new Error("User is not authorized");return yield this.dataFeedbackApi.getUserFeedbacks(Object.assign(Object.assign({},e),{accessToken:t}))}))}getUserFeedbacksCount(){return(0,x.sH)(this,void 0,void 0,(function*(){const e=yield this.credentialsApi.getToken();if(!e)throw new Error("User is not authorized");return yield this.dataFeedbackApi.getUserFeedbacksCount({accessToken:e})}))}sendTypedFeedback(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.dataFeedbackApi.sendFeedback(Object.assign(Object.assign({},e),{userToken:t}))}))}getAnonymousFeedbacksCount(){return(0,x.sH)(this,void 0,void 0,(function*(){return this.feedbackStorageApi.get("count")}))}setAnonymousFeedbacksCount(e){return(0,x.sH)(this,void 0,void 0,(function*(){return this.feedbackStorageApi.set("count",e.toString())}))}}class ct extends Ve{constructor(e){super(e)}createShortLink(e){return this.shortonizerApi.createShortLink(e.url)}}class ot extends Ve{constructor(e){super(e)}updateEmail(e){return(0,x.sH)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();if(!t)throw new Error("No access token");return this.aggregatorApi.updateEmail(Object.assign(Object.assign({},e),{accessToken:t}))}))}}function dt(e){const t=Math.ceil(e.total/se.S0);return Object.assign(Object.assign({},e),{pages:t})}function ut(e){const t=Math.ceil(e.total/se.H0);return Object.assign(Object.assign({},e),{pages:t})}function lt(e){const t=Math.ceil(e.total/se.H0);return Object.assign(Object.assign({},e),{pages:t})}class gt extends Ve{constructor(e){super(e)}searchProductsById(e){return this.marketApi.searchProductsById(e).then(dt)}searchBranchProducts(e){return this.marketApi.searchBranchProducts(e).then(ut)}getBranchCategoriesAndProducts(e){return this.marketApi.getBranchCategoriesAndProducts(e).then(ut)}getOffers(e){return this.marketApi.getOffers(e).then(lt)}getSuggestions(e){return this.marketApi.getSuggestions(e)}}class pt extends Ve{constructor(e){super(e)}getSeoParams(e){return this.seoStoreApi?this.seoStoreApi.getSeoParams(e):Promise.resolve({})}}var bt=s(9481);class Ot extends Ve{constructor(e){super(e),this.localStorage=new bt.R("history","history")}saveSearchHistory(e){return this.localStorage.set(e.userId,e.history)}loadSearchHistory(e){return this.localStorage.get(e.userId)}clearSearchHistory(){return this.localStorage.clear()}}function Et(e){return{search:new qe(e),market:new gt(e),entity:new Xe(e),photos:new et(e),reviews:new tt(e),region:new st(e),profile:new at(e),video:new rt(e),auth:new nt(e),feedback:new it(e),shortonizer:new ct(e),aggregator:new ot(e),seoStore:new pt(e),history:new Ot(e)}}function ht({entity:e,reviews:t,video:s}){return a=>{switch(a.type){case"ENTITY/FETCH_PROFILE_NO_TYPE":return e.getEntityByIdNoType(a.payload);case"ENTITY/FETCH_MULTIPLE":return e.getMultipleEntities(a.payload);case"ENTITY/FETCH_BY_POINT":return e.getEntityByPoint(a.payload);case"USER/DELETE_REVIEW":return t.deleteReview(a.payload);case"ENTITY/FETCH_VIDEO_DATA":return s.getVideoData(a.payload);default:return}}}function ft({search:e}){return t=>{switch(t.type){case"SEARCH/FETCH_FILIALS":return e.searchFilials(t.payload);case"SEARCH/FETCH_FILIALS_FILTERS":return e.getSearchFilialsFilters(t.payload);default:return}}}function mt({search:e}){return t=>{switch(t.type){case"SEARCH/FETCH_QUERY":return e.searchByQuery(t.payload);case"SEARCH/FETCH_RUBRIC":return e.searchByRubric(t.payload);case"SEARCH/FETCH_ATTRIBUTE":return e.searchByAttribute(t.payload);case"SEARCH/FETCH_FILTERS":return e.getSearchFilters(t.payload);default:return}}}function jt({search:e}){return t=>{if("SEARCH/FETCH_SUGGESTIONS"===t.type)return e.searchSuggestionsByQuery(t.payload)}}function vt({search:e}){return t=>{if("SEARCH/FETCH_OBJECT_SUGGESTIONS"===t.type)return e.debouncedSearchObjectSuggestions(t.payload)}}function yt({search:e}){return t=>{switch(t.type){case"SEARCH/BY_BUILDING_ID":return e.searchByBuildingId(t.payload);case"SEARCH/IN_BUILDING_BY_QUERY":return e.searchInBuildingByQuery(t.payload);case"SEARCH/FETCH_MAINTAINERS":return e.searchMaintainers(t.payload);case"SEARCH/FETCH_PROVIDERS":return e.searchProviders(t.payload);default:return}}}function _t({search:e}){return t=>{if("SEARCH/FETCH_PARKINGS_AROUND"===t.type)return e.searchParkingsAround(t.payload)}}function St(e){const t=[ft,mt,yt,jt,vt,_t].map((t=>t(e)));return e=>{for(const s of t){const t=s(e);if(t)return t}}}function It({market:e}){return t=>{switch(t.type){case"MARKET/FETCH_PRODUCT_BY_ID":return e.searchProductsById(t.payload);case"MARKET/FETCH_CATEGORIES_BY_BRANCH":return e.getBranchCategoriesAndProducts(t.payload);case"MARKET/FETCH_BRANCH_PRODUCTS":return e.searchBranchProducts(t.payload);case"MARKET/FETCH_OFFERS":return e.getOffers(t.payload);case"MARKET/FETCH_SUGGESTIONS":return e.getSuggestions(t.payload);default:return}}}function Tt({region:e}){return t=>{switch(t.type){case"REGION/FETCH_LIST":return e.getRegionsList(t.payload);case"REGION/FETCH":return e.getRegionById(t.payload);case"REGION/DETECT":return e.detectRegion(t.payload);default:return}}}function Ct({profile:e}){return t=>{if("SEARCH_HISTORY/CLEAR_SEARCH_HISTORY"===t.type)return e.clearSearchHistory(t.payload)}}function Rt({auth:e,reviews:t,history:s}){return a=>{switch(a.type){case"USER/CONFIRM_REGISTRATION":return e.confirmRegistration(a.payload);case"USER/FETCH_REVIEWS":return t.getUserReviews(a.payload);case"USER/DELETE_REVIEW":return t.deleteReview(a.payload);case"USER/SAVE_HISTORY":return s.saveSearchHistory(a.payload);case"USER/LOAD_HISTORY":return s.loadSearchHistory(a.payload);case"USER/CLEAR_HISTORY":return s.clearSearchHistory();default:return}}}function At({feedback:e}){return t=>{switch(t.type){case"FEEDBACK/SEND":return e.sendFeedback(t.payload.data);case"FEEDBACK/PHOTO_COMPLAINT":return e.sendMediaComplaint(t.payload.data);case"FEEDBACK/REVIEW_COMPLAINT":return e.sendReviewFeedback(t.payload);case"FEEDBACK/STORY_COMPLAINT":return e.sendStoryComplaintFeedback(t.payload);case"FEEDBACK/SEND_TYPED":return e.sendTypedFeedback(t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS":return e.getUserFeedbacks(t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT":return e.getUserFeedbacksCount();case"FEEDBACK/GET_ANOMYMOUS_FEEDBACKS_COUNT":return e.getAnonymousFeedbacksCount();case"FEEDBACK/SET_ANOMYMOUS_FEEDBACKS_COUNT":return e.setAnonymousFeedbacksCount(t.payload.feedbacksCount);default:return}}}function wt({aggregator:e}){return t=>{if("USER/UPDATE_EMAIL"===t.type)return e.updateEmail(t.payload)}}function Ht({seoStore:e}){return t=>{if("SEO_STORE/FETCH"===t.type)return e.getSeoParams(t.payload)}}function Ut({reviews:e}){return t=>{if("REVIEW/FETCH_REVIEWS"===t.type)return e.getEntityReviews(t.payload)}}var Ft=s(50432);function kt(e){const t=[Rt,ht,St,It,Tt,Ct,At,wt,Ht,Ut].map((t=>t(e)));return e=>{for(const s of t){const t=s(e);if(t)return t}return(0,Ft.vV)({message:`service cannot be defined for action - ${e.type}`,id:"os136",level:"error",payload:{type:"debug",subtype:"NoAsyncActionHandler"}}),Promise.reject(new Error(`Handler for "${e.type}" is undefined`))}}var Nt=s(61120),Pt=s(11776);function Bt(e,t,s){const a=(0,Me.A)(Et,kt)(e);return e=>r=>i=>{if(!i.async)return r(i);let c="object"==typeof i.payload?Object.assign(Object.assign({},i),{payload:Dt(i.payload)}):i;s&&(c=function(e,t){if(!t||!(0,n.Gv)(t))return e;const s="payload"in e&&e.payload,a={};return(0,n.jJ)(t,((e,t)=>{s&&t in s||void 0===e||(a[t]=e)})),0===Object.keys(a).length?e:Object.assign(Object.assign({},e),{payload:Object.assign(Object.assign({},e.payload),a)})}(c,s(e.getState()))),r(c);const o=e.getState(),{payload:d,type:u}=c;return o.session.isOffline?e.dispatch({payload:{name:"OfflineError",message:"No network"},type:`${u}_ERROR`,meta:d,error:!0}):a(c).then((s=>{if(!Nt.S$&&t.captchaUrl&&(a=s,(0,n.Gv)(a)&&"code"in a&&307===a.code)){const s=`${t.captchaUrl}form?return_url=${window.location.href}`;return e.dispatch((0,Pt.v)({url:s,name:"_self"}))}var a;return e.dispatch({payload:s,meta:d,type:`${u}_SUCCESS`,success:!0})}),(t=>e.dispatch({payload:t,meta:d,type:`${u}_ERROR`,error:!0})))}}function Dt(e){return e.statusId?e:Object.assign({},e,{statusId:(0,n.W7)()})}var Lt=s(69985);function Mt({windowApi:e}){return()=>t=>s=>{switch(s.type){case"HISTORY/PUSH":return e.historyPush(s.payload.state,s.payload.url),t(s);case"HISTORY/REPLACE":return void e.historyReplace(s.payload.state,s.payload.url);case"HISTORY/BACK":return void e.historyBack();default:return t(s)}}}function xt({windowApi:e}){return()=>t=>s=>{switch(s.type){case"APP/OPEN_URL":if(e.location&&s.payload.name&&"_self"===s.payload.name){const t="/"===s.payload.url?e.location.host:s.payload.url;if(t.startsWith("/")&&-1===t.indexOf("//"))return void(window.location.href=t);e.location.href=t.startsWith("http")?t:`${e.location.protocol}//${t}`}else e.open(s.payload.url,s.payload.name,s.payload.specs);return;case"APP/RELOAD":return void e.reload(s.payload.forcedReload);default:return t(s)}}}var Yt,Gt=s(4340),Vt=s(76428);Yt||(Yt={});const{emitEvent:Kt}=(0,Vt.m)();function Wt(){let e;return t=>s=>a=>{switch(a.type){case"USER/ACTIVATE_MY_GEOLOCATION":return function({onUpdate:t,onError:s}){if(!e)"undefined"!=typeof window&&window.navigator&&window.navigator.geolocation?(Gt.IG.local.setItem("geolocationAllowed","true"),e=window.navigator.geolocation.watchPosition((e=>t(e)),(e=>s(function(e){switch(e.code){case e.PERMISSION_DENIED:return"PERMISSION_DENIED";case e.POSITION_UNAVAILABLE:return"POSITION_UNAVAILABLE";case e.TIMEOUT:return"TIMEOUT";default:return}}(e))),{enableHighAccuracy:!0})):s("API_UNAVAILABLE")}({onUpdate(e){t.dispatch(Kt({type:"myGeolocation:update",event:e}))},onError(e){t.dispatch(Kt({type:"myGeolocation:error",event:e}))}}),s(a);case"USER/DEACTIVATE_MY_GEOLOCATION":return e&&(window.navigator.geolocation.clearWatch(e),e=void 0),Gt.IG.local.removeItem("geolocationAllowed"),s(a);default:return s(a)}}}function zt({analyticsApi:e}){return()=>t=>s=>{switch(s.type){case"ANALYTICS/TRACK_GOOGLE":return void e.trackGoogleEvent(...s.payload);case"ANALYTICS/PAGEVIEW":return void e.trackPageview();case"ANALYTICS/SET_CONSENT_GRANTED":return void e.setGoogleConsentGranted();case"ANALYTICS/CHANGE_PROJECT_ID":return void e.changeGoogleProjectId(s.payload.projectId);default:return t(s)}}}new class{constructor(){this.actions=[],this.signals=[],this.allRawActions=[]}setAction(e){this.actions.push(e)}setSignal(e){this.signals.push(e)}getSignals(){return this.signals}getAll(){return this.actions}getAllRaw(){return this.allRawActions}findAction(e){return this.actions.find((t=>t.type===e))}findSignal(e){return this.signals.find((t=>t.payload.name===e))}findSignalIntree(e){return this.signals.find((t=>t[xe.bh.NAME]===e))}getTree(){return this.actions.reduce(((e,t)=>{let s=e;if(t[xe.bh.NAME]){const e=t[xe.bh.NAME],a=e.split(".");for(const t of a){let a=s.find((e=>e.type===t));if(!a){const r=this.findSignalIntree(e);a=r?{type:t,children:[],payload:r.payload}:{type:t,children:[]},s.push(a)}s=a.children}}return s.push({type:t.type,payload:t.payload}),e}),[])}reset(){this.actions=[],this.allRawActions=[],this.signals=[]}trackAction(e){this.allRawActions.push(e)}};var $t=s(15434);function Qt(e){const{extraReducers:t,enhancers:s,initialState:r,config:n,uiMiddlewares:i,mwWithServices:c,asyncExtraPayload:o,apiServices:d}=e;return function({initialState:e,beforeMiddlewares:t=[],extraMiddlewares:s,enhancers:r,extraReducers:n,apiServices:i,config:c,mwWithServices:o=[],asyncExtraPayload:d}){const u=[...t,(0,Lt.Z)(),Ye(c),(0,$t.o)({services:i,asyncExtraPayload:d}),Bt(i,c,d),Wt(),Mt(i),xt(i),zt(i),...s].concat(o.map((e=>e(i)))),l=(0,a.Tw)(...u);"godmode"in c&&c.godmode&&"object"==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&r.push(window.__REDUX_DEVTOOLS_EXTENSION__());const g=(0,a.Zz)(l,...r),p=Le(n);return e?(0,a.y$)(p,e,g):(0,a.y$)(p,g)}({extraMiddlewares:[...i],extraReducers:t,enhancers:s,initialState:r,apiServices:d,config:n,mwWithServices:c,asyncExtraPayload:o})}},21132:(e,t,s)=>{s.d(t,{Im:()=>r,gP:()=>a});const a={read_only:"boolean",system_is_deleted:"boolean",is_owned:"boolean",is_deleted:"boolean",is_shared:"boolean",is_visible_on_map:"boolean",is_default:"boolean",order:"number",project_id:"array",collections:"array",point:"lonlat",source_point:"lonlat",user_info:"object"},r=["adm_div","parking","gate","street","road","point"]},85512:(e,t,s)=>{function a(e){return e&&"number"==typeof e.lon&&"number"==typeof e.lat}s.d(t,{F:()=>a})},47:(e,t,s)=>{s.d(t,{d:()=>a});const a=["camera","camera-20","camera-30","camera-40","camera-50","camera-60","camera-70","camera-80","camera-90","camera-100","camera-110","camera-120","camera-130","camera-140","camera-tl","camera-bus","camera-line","camera-parking"]},5512:(e,t,s)=>{s.d(t,{u:()=>r});var a=s(66003);const r=(e,t,s)=>function(e,t){return(s,a)=>{const r=s[e],n=t(r,a);return r===n?s:Object.assign(Object.assign({},s),{[e]:n})}}(t,(0,a.yG)(e,s))},35277:(e,t,s)=>{function a(e){return t=>Object.assign(Object.assign({},e),t)}s.d(t,{R:()=>a})},66089:(e,t,s)=>{s.d(t,{l:()=>a});const a=e=>{const t=null==e?void 0:e.reduce(((e,t)=>"rubric"===t.table_name?[...e,t.record_id]:t.dgis_rubrics.length?[...e,...t.dgis_rubrics]:e),[]);return(null==t?void 0:t.length)?[...new Set(t)]:void 0}},73766:(e,t,s)=>{s.d(t,{$w:()=>n,Tw:()=>r,si:()=>i});var a=s(50432);const r=["#E2658B","#198700","#4F92F8","#E7750B","#738AB3","#7435D2","#DBAF00","#00B305","#00A989","#9E578A","#BA6612","#1D66EE","#F83A3A"],n="#E7750B";function i(e,t){try{if(!e)throw new Error;if(t&&r.includes(t))return t;const s=e.replace(/-/g,"").split("").reduce(((e,t,s,a)=>(s%2!=0&&e.push(`${a[s-1]}${t}`),e)),[]).reverse(),a=Number((BigInt("0x"+s.slice(0,8).join(""))^BigInt("0x"+s.slice(8).join("")))%BigInt(r.length));return r[a]}catch(e){return(0,a.vV)({message:"Пришел неизвестный цвет или нет uuid!",level:"warn",id:"v3gh3",payload:{type:"exception",subtype:"getFavoriteColorError",stack:e instanceof Error?e.stack:void 0}}),n}}},13608:(e,t,s)=>{s.d(t,{E:()=>a});const a=e=>{const t=[];return null==e||e.forEach((({table_name:e,group:s,record_id:a,dgis_rubrics:r})=>{"rubric"!==e||void 0!==s&&0!==s||t.push(a),!r.length||void 0!==s&&0!==s||r.forEach((e=>{t.push(e)}))})),(null==t?void 0:t.length)?t:void 0}},19899:(e,t,s)=>{function a(e){return!(!e||!e.options||!e.options.fmcg_owner)}s.d(t,{R:()=>a})},96077:(e,t,s)=>{s.d(t,{J:()=>a,R:()=>r});const a=(e={})=>e,r=e=>(t=e)=>t}}]);